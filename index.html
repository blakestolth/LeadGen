<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vancouver Island Credit | Auto Approvals Online — Work with Blake</title>

  <meta name="description" content="Fast, confidential auto approvals across Vancouver Island & BC. New & used options. Delivery to your door. Work 1 on 1 with Blake Stolth — no call centres." />
  <link rel="canonical" href="[https://vancouverislandcredit.ca/](https://vancouverislandcredit.ca/)"/>
  <meta property="og:title" content="Vancouver Island Credit — Auto Approvals Online"/>
  <meta property="og:description" content="Get approved online. New & used inventory across Vancouver Island & BC. Delivery to your door. Work directly with Blake."/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="[https://vancouverislandcredit.ca/](https://vancouverislandcredit.ca/)"/>
  <meta property="og:image" content="[https://vancouverislandcredit.ca/0041B99D-D49A-4024-AA7A-2786A4605342.jpg](https://vancouverislandcredit.ca/0041B99D-D49A-4024-AA7A-2786A4605342.jpg)"/>
  <meta name="theme-color" content="#2A5D9F"/>

  <script src="[https://cdn.tailwindcss.com](https://cdn.tailwindcss.com)"></script>
  <link rel="preconnect" href="[https://fonts.googleapis.com](https://fonts.googleapis.com)"/>
  <link rel="preconnect" href="[https://fonts.gstatic.com](https://fonts.gstatic.com)" crossorigin/>
  <link href="[https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Roboto:wght@400;500;700&display=swap](https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Roboto:wght@400;500;700&display=swap)" rel="stylesheet"/>

  <style>
    /* ==========================================================================
       NEW DESIGN SYSTEM (Based on UI/UX Research)
       ========================================================================== */
    :root {
      /* BRAND COLORS (PRESERVED) */
      --brand-blue: #2A5D9F;
      --brand-red: #A8202A;

      /* NEW COLOR PALETTE */
      --bg-primary: #F8F9FA;      /* Light Gray - Main background */
      --bg-card: #FFFFFF;         /* White - Card backgrounds */
      --text-primary: #212529;    /* Near Black - Headings & body text */
      --text-secondary: #6C757D;  /* Gray - Muted text, labels */
      --border-color: #DEE2E6;    /* Light Gray - Borders, dividers */
      --form-bg: #F1F3F5;         /* Lighter Gray - Form input background */

      /* TYPOGRAPHY */
      --font-heading: 'Merriweather', serif;
      --font-body: 'Roboto', sans-serif;

      /* Font Sizes (Responsive Scale) */
      --fs-h1: 2.25rem;  /* 36px */
      --fs-h2: 1.75rem;  /* 28px */
      --fs-h3: 1.25rem;  /* 20px */
      --fs-body: 1.125rem; /* 18px */
      --fs-small: 0.875rem;/* 14px */
      --fs-label: 0.875rem;/* 14px */

      /* SPACING & LAYOUT */
      --space-xs: 0.5rem;   /* 8px */
      --space-sm: 1rem;     /* 16px */
      --space-md: 1.5rem;   /* 24px */
      --space-lg: 2rem;     /* 32px */
      --section-max: 860px;
      --border-radius: 12px;
    }

    @media (max-width: 640px) {
      :root {
        --fs-h1: 1.875rem; /* 30px */
        --fs-h2: 1.5rem;   /* 24px */
        --fs-h3: 1.125rem; /* 18px */
        --fs-body: 1rem;   /* 16px */
      }
    }

    /* ==========================================================================
       BASE & GLOBAL STYLES
       ========================================================================== */
    body {
      font-family: var(--font-body);
      background: var(--bg-primary);
      color: var(--text-primary);
      font-size: var(--fs-body);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

   .card {
      background: var(--bg-card);
      border-radius: var(--border-radius);
      border: 1px solid var(--border-color);
      box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.07), 0 2px 4px -2px rgb(0 0 0 / 0.07);
      overflow: hidden;
    }

    /* ==========================================================================
       TYPOGRAPHY STYLES
       ========================================================================== */
   .h1,.h2,.h3 {
      font-family: var(--font-heading);
      font-weight: 700;
      line-height: 1.3;
      margin-bottom: var(--space-xs);
    }
   .h1 { font-size: var(--fs-h1); }
   .h2 { font-size: var(--fs-h2); }
   .h3 { font-size: var(--fs-h3); }

    p { margin-bottom: var(--space-sm); }
    a { color: var(--brand-blue); text-decoration: none; transition: color 0.2s ease; }
    a:hover { text-decoration: underline; }
   .muted { font-size: var(--fs-small); color: var(--text-secondary); }

    /* ==========================================================================
       FORM & INTERACTIVE ELEMENT STYLES
       ========================================================================== */
   .label {
      font-size: var(--fs-label);
      color: var(--text-primary);
      font-weight: 500;
      display: block;
      margin-bottom: var(--space-xs);
    }

   .form-input,.form-select,.form-textarea {
      background: var(--form-bg);
      color: var(--text-primary);
      border: 2px solid var(--border-color);
      font-size: var(--fs-body);
      width: 100%;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      transition: all.2s ease;
      min-height: 50px;
      line-height: 1.4;
    }
   .form-input::placeholder { color: var(--text-secondary); }
   .form-input:focus,.form-select:focus,.form-textarea:focus {
      background: var(--bg-card);
      border-color: var(--brand-blue);
      box-shadow: 0 0 0 3px rgba(42, 93, 159,.2);
      outline: none;
    }

   .cta-button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background: var(--brand-red);
      color: #fff;
      font-weight: 700;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      font-size: var(--fs-body);
      min-height: 50px;
      border: none;
      cursor: pointer;
      transition: all.2s ease;
    }
   .cta-button:hover {
      background: #8c1b24; /* Darker red */
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

   .choice-rect {
      width: 100%;
      text-align: left;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      background: var(--bg-card);
      padding: 1rem;
      font-weight: 500;
      color: var(--text-primary);
      transition: all.2s ease;
      display: block;
      cursor: pointer;
    }
   .choice-rect:hover {
      border-color: var(--brand-blue);
      background: #f0f6ff;
    }
   .choice-rect.selected {
      border-color: var(--brand-blue);
      background: #eaf1fb;
      box-shadow: 0 0 0 2px var(--brand-blue);
    }

    /* Form Progress Bar */
   .track { height: 8px; background: #e9ecef; border-radius: 9999px; overflow: hidden; }
   .fill { height: 8px; background: var(--brand-blue); border-radius: 9999px; width: 0%; transition: width.3s ease; }

    /* Error States */
   .err { border-color: var(--brand-red)!important; }
   .err-label { color: var(--brand-red)!important; }

    /* ==========================================================================
       LAYOUT & COMPONENT-SPECIFIC STYLES
       ========================================================================== */

    /* Header & Navigation */
   .brand-left { display: flex; align-items: center; gap: 16px; }
   .site-logo { height: 50px; width: auto; }
   .brand-title {
      font-family: var(--font-heading);
      color: var(--text-primary);
      font-weight: 700;
      font-size: 1.25rem;
      text-decoration: none;
    }
   .powered-by-inline {
      font-size: 0.8rem;
      color: var(--text-secondary);
      font-weight: 500;
    }
   .powered-by-inline img { height: 1em; width: auto; margin-left: 4px; }

    /* Main Form Structure */
    #lead-form {
      --fs-h3: 1.2rem;
      --fs-body: 1rem;
      --fs-label: 0.8rem;
    }
   .form-shell { position: relative; overflow: hidden; display: flex; flex-direction: column; height: 100%; }
   .form-shell.sticky { position: sticky; top: 0; z-index: 10; background: var(--bg-card); }
   .step-viewport { flex: 1; overflow: auto; }
   .step-inner {
      max-width: var(--section-max);
      margin: 0 auto;
      padding: var(--space-sm) 0;
      display: flex;
      flex-direction: column;
      min-height: 100%;
    }
   .step-title { text-align: center; margin-bottom: var(--space-md); }
   .step-body {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: var(--content-min, 0px);
    }
   .step-body >.content { width: 100%; max-width: 560px; margin: 0 auto; }
   .vstack > * + * { margin-top: var(--space-sm); }

   .form-footer {
      position: sticky;
      bottom: 0;
      background: var(--bg-card);
      border-top: 1px solid var(--border-color);
      padding: var(--space-sm);
    }
    #btnBack {
      background: transparent;
      border: none;
      color: var(--text-secondary);
      font-weight: 700;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      transition: background.2s ease, color.2s ease;
    }
    #btnBack:hover { background: #e9ecef; color: var(--text-primary); }
    #btnBack:disabled { opacity: 0.5; cursor: not-allowed; }

    /* Grid Layouts for Form Fields */
   .grid-inline-2 { display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-sm); }
   .grid-inline-3 { display: grid; grid-template-columns: 1fr 1.3fr 1fr; gap: var(--space-sm); }
   .grid-inline-dob { display: grid; grid-template-columns: 1.2fr.9fr.9fr 1.6fr; gap: var(--space-sm); }
   .grid-inline-addr1 { display: grid; grid-template-columns: 3fr 1fr; gap: var(--space-sm); }
   .grid-inline-addr2 { display: grid; grid-template-columns: 1.6fr 1fr 1fr; gap: var(--space-sm); }

    /* Inventory Section */
   .bodytype-card {
      overflow: hidden;
      border-radius: var(--border-radius);
      border: 1px solid var(--border-color);
      background: var(--bg-card);
      transition: transform.2s, box-shadow.2s, border-color.2s;
      display: block;
      text-decoration: none;
    }
   .bodytype-card:hover {
      transform: translateY(-4px);
      border-color: var(--brand-blue);
      box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.08), 0 4px 6px -4px rgb(0 0 0 / 0.08);
    }
   .bodytype-img { background: #e9ecef center/cover no-repeat; height: 120px; }
   .inv-badge { color: var(--brand-blue); font-weight: 700; }

    /* Progress Overlay */
   .progress-overlay { position: fixed; inset: 0; background: rgba(33, 37, 41,.6); backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: center; z-index: 50; }
   .progress-card { background: var(--bg-card); border-radius: var(--border-radius); box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.25); width: min(520px, 92vw); padding: var(--space-lg); }
   .progress-title { font-family: var(--font-heading); font-size: 1.5rem; font-weight: 700; color: var(--text-primary); }
   .progress-track { height: 10px; background: #e9ecef; border-radius: 9999px; overflow: hidden; margin-top: var(--space-sm); }
   .progress-bar { height: 10px; width: 0%; background: var(--brand-blue); transition: width.6s ease; }
   .progress-steps { list-style: none; padding: 0; margin: var(--space-md) 0 0; font-size: var(--fs-body); color: var(--text-secondary); }
   .progress-steps li { display: flex; align-items: center; gap: var(--space-xs); opacity:.7; transition: opacity.3s, font-weight.3s; }
   .progress-steps li + li { margin-top: var(--space-xs); }
   .progress-steps li.active { opacity: 1; font-weight: 700; color: var(--text-primary); }
   .progress-note { margin-top: var(--space-sm); font-size: var(--fs-small); color: var(--text-secondary); }

   .hidden { display: none!important; }

    /* Custom Select Arrow */
   .form-select {
      -webkit-appearance: none; -moz-appearance: none; appearance: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236c757d' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
      background-position: right 0.75rem center;
      background-repeat: no-repeat;
      background-size: 1.5em 1.5em;
      padding-right: 2.5rem;
    }
  </style>

  <script type="application/ld+json">
  {
    "@context":"[https://schema.org](https://schema.org)",
    "@type":"AutoDealer",
    "name":"Vancouver Island Credit",
    "telephone":"+1-236-969-2424",
    "address":{"@type":"PostalAddress","streetAddress":"525 Gorge Rd E","addressLocality":"Victoria","addressRegion":"BC","postalCode":"V8T 4T2","addressCountry":"CA"},
    "areaServed":"British Columbia, Canada",
    "image":"[https://vancouverislandcredit.ca/0041B99D-D49A-4024-AA7A-2786A4605342.jpg](https://vancouverislandcredit.ca/0041B99D-D49A-4024-AA7A-2786A4605342.jpg)",
    "url":"[https://vancouverislandcredit.ca](https://vancouverislandcredit.ca)",
    "slogan":"Get approved online. Delivery across BC. Work directly with Blake.",
    "founder":{"@type":"Person","name":"Blake Stolth"},
    "makesOffer":
  }
  </script>
</head>
<body class="text-lg">
  <header class="w-full max-w-7xl mx-auto py-4 px-4 sm:px-6">
    <nav class="bg-white/80 backdrop-blur-sm card px-4 sm:px-6 py-3 flex items-center justify-between">
      <div class="brand-left">
        <img src="Logo.png" alt="Vancouver Island Credit logo" class="site-logo"/>
        <div class="flex flex-col">
          <a href="#" class="brand-title" aria-label="Vancouver Island Credit — Home">Vancouver Island Credit</a>
          <div class="powered-by-inline">Powered by<img src="Equifax.png" alt="Credit reports powered by Equifax"/></div>
        </div>
      </div>

      <div class="hidden sm:flex items-center gap-8 font-medium text-zinc-800 text-base">
        <a href="#inventory" class="hover:text-[var(--brand-blue)]">Inventory</a>
        <a href="#about" class="hover:text-[var(--brand-blue)]">About</a>
        <a href="#contact" class="hover:text-[var(--brand-blue)]">Contact</a>
        <a href="#lead-form" class="cta-button!py-2.5!px-6!text-base">Apply Now</a>
      </div>
      <button id="menuBtn" class="sm:hidden inline-flex items-center justify-center h-10 w-10 rounded-lg border border-zinc-300 bg-white hover:bg-zinc-50" aria-label="Open menu">
        <svg xmlns="[http://www.w3.org/2000/svg](http://www.w3.org/2000/svg)" class="h-6 w-6 text-zinc-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
      </button>
    </nav>
    <div id="mobileMenu" class="hidden sm:hidden mt-2 card p-4">
      <div class="flex flex-col gap-2 font-medium text-zinc-800">
        <a href="#inventory" class="py-2 px-3 rounded-md hover:bg-blue-50">Inventory</a>
        <a href="#about" class="py-2 px-3 rounded-md hover:bg-blue-50">About</a>
        <a href="#contact" class="py-2 px-3 rounded-md hover:bg-blue-50">Contact</a>
        <a href="#lead-form" class="mt-2 cta-button text-center">Apply Now</a>
      </div>
    </div>
  </header>

  <main class="w-full max-w-7xl mx-auto px-4 sm:px-6 py-6 space-y-8">
    <section id="about" class="card p-6 md:p-8">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div>
          <h1 class="h2">Get Driving in 3 Easy Steps</h1>
          <p class="text-zinc-600">A simple, pressure-free process to get you on the road faster.</p>
          <ol class="mt-6 space-y-4 text-base">
            <li class="flex items-start gap-4">
              <span class="flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-[var(--brand-blue)] text-white font-bold text-sm">1</span>
              <div>
                <h3 class="font-bold text-zinc-900">Enter Your Info</h3>
                <p class="text-zinc-600 text-sm">Takes 2–3 minutes, completely confidential.</p>
              </div>
            </li>
            <li class="flex items-start gap-4">
              <span class="flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-[var(--brand-blue)] text-white font-bold text-sm">2</span>
              <div>
                <h3 class="font-bold text-zinc-900">See Your Options</h3>
                <p class="text-zinc-600 text-sm">View vehicles you qualify for from across BC.</p>
              </div>
            </li>
            <li class="flex items-start gap-4">
              <span class="flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-[var(--brand-blue)] text-white font-bold text-sm">3</span>
              <div>
                <h3 class="font-bold text-zinc-900">We Deliver to You</h3>
                <p class="text-zinc-600 text-sm">Fast, stress-free delivery right to your door.</p>
              </div>
            </li>
          </ol>
        </div>
        <div>
          <h2 class="h2">Why People Choose Us</h2>
          <p class="text-zinc-600">A better, more personal way to get your next vehicle.</p>
          <ul class="mt-6 space-y-4 text-base">
            <li class="flex items-start gap-3"><svg class="h-6 w-6 text-green-600 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg><span><b>All credit welcome:</b> We specialize in high approval rates.</span></li>
            <li class="flex items-start gap-3"><svg class="h-6 w-6 text-green-600 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg><span><b>Bigger selection:</b> Access to new & used vehicles across BC.</span></li>
            <li class="flex items-start gap-3"><svg class="h-6 w-6 text-green-600 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg><span><b>Direct contact:</b> Your information is never sold to dealerships.</span></li>
            <li class="flex items-start gap-3"><svg class="h-6 w-6 text-green-600 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg><span><b>Province-wide delivery:</b> We bring your new car to you.</span></li>
          </ul>
        </div>
      </div>
    </section>

    <section class="grid md:grid-cols-2 gap-8">
      <div class="card" id="lead-form">
        <div class="form-shell" id="form-shell">
          <div class="sticky px-6 py-4 border-b border-[var(--border-color)]">
            <div class="flex items-center justify-between">
              <div id="progress-label" class="text-sm font-semibold text-zinc-700">Step 1</div>
              <div id="progress-endcap" class="text-sm text-[var(--brand-blue)] font-semibold">Let’s get you approved</div>
            </div>
            <div class="track mt-2"><div id="progress-fill" class="fill"></div></div>
          </div>

          <div id="step-viewport" class="step-viewport px-6">
            <div class="step-viewport-inner">
              <form id="the-form" name="lead-form" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" action="/thank-you.html" novalidate>
                <input type="hidden" name="form-name" value="lead-form"/>
                <input type="hidden" name="app_type" id="app_type" value="Full Application" />
                <input type="hidden" name="appCode" id="appCode" value="" />
                <input type="hidden" name="intent" id="intent" value="finance" />
                <p class="hidden" aria-hidden="true"><label>Don’t fill this out: <input name="bot-field"/></label></p>

                <section class="form-step" data-id="step-intent">
                  <div class="step-inner">
                    <div class="step-title"><h3 class="h3">1. What are you looking to do?</h3></div>
                    <div class="step-body"><div class="content vstack"><button type="button" class="choice-rect" data-intent="finance">Finance a vehicle</button><button type="button" class="choice-rect" data-intent="refinance">Refinance current vehicle</button></div></div>
                  </div>
                </section>
                <section class="form-step hidden" data-id="step-cond">
                  <div class="step-inner">
                    <div class="step-title"><h3 class="h3">2. Vehicle condition</h3></div>
                    <div class="step-body"><div class="content vstack"><button type="button" class="choice-rect" data-cond="New">New</button><button type="button" class="choice-rect" data-cond="Used">Used</button><button type="button" class="choice-rect" data-cond="Both">Both</button><input type="hidden" name="vehicleCondition" id="vehicleCondition"></div></div>
                  </div>
                </section>
                <section class="form-step hidden" data-id="step-budget">
                  <div class="step-inner">
                    <div class="step-title"><h3 class="h3">3. Bi-weekly budget <span class="muted">(starts at $120)</span></h3></div>
                    <div class="step-body"><div class="content"><input id="biWeeklyRange" type="range" min="120" max="600" step="10" value="250" class="w-full" style="accent-color: var(--brand-blue);"><div class="text-sm text-zinc-700 mt-2 text-center">Selected: <b>$<span id="biWeeklyOut">250</span></b> / bi-weekly</div><input type="hidden" name="budgetRange" id="budgetRange" value="$250 bi-weekly"></div></div>
                  </div>
                </section>
                <section class="form-step hidden" data-id="step-purchase">
                  <div class="step-inner">
                    <div class="step-title"><h3 class="h3">4. Purchase details</h3></div>
                    <div class="step-body"><div class="content vstack"><div><label for="downPayment" class="label">Down payment</label><select id="downPayment" name="downPayment" class="form-select"><option value="">Select…</option><option>$3,000+</option><option>$1,000–$3,000</option><option>$0–$1,000</option></select></div><div><label class="label">Trade-in</label><div class="grid-inline-2"><button type="button" class="choice-rect" data-trade="No">No</button><button type="button" class="choice-rect" data-trade="Yes">Yes</button></div><input type="hidden" id="hasTradeIn" name="hasTradeIn" value="No"></div></div></div>
                  </div>
                </section>
                <section class="form-step hidden" data-id="step-refi-details">
                  <div class="step-inner">
                    <div class="step-title"><h3 class="h3">4. Refinance details</h3></div>
                    <div class="step-body"><div class="content vstack"><div class="grid grid-cols-3 gap-4"><select name="refiYear" id="refiYear" class="form-select" required><option value="">Year</option></select><input type="text" name="refiMake" id="refiMake" placeholder="Make" class="form-input col-span-2" maxlength="40" required/></div><div class="grid-inline-2"><input type="text" name="refiModel" id="refiModel" placeholder="Model" class="form-input" maxlength="50" required/><select id="refiRemainYears" name="refiRemainYears" class="form-select" required><option value="">Years left</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option></select></div><input type="text" id="refiCurrentRate" name="refiCurrentRate" class="form-input" placeholder="Current interest % (e.g., 9.49)" inputmode="decimal" maxlength="6" required/></div></div>
                  </div>
                </section>
                <section class="form-step hidden" data-id="step-tradein">
                  <div class="step-inner">
                    <div class="step-title"><h3 class="h3">5. Trade-in details</h3></div>
                    <div class="step-body"><div class="content vstack"><div class="grid grid-cols-3 gap-4"><select name="tradeInYear" id="tradeInYear" class="form-select"><option value="">Year</option></select><input type="text" name="tradeInMake" id="tradeInMake" placeholder="Make" class="form-input" maxlength="40"/><input type="text" name="tradeInModel" id="tradeInModel" placeholder="Model" class="form-input" maxlength="50"/></div><div class="grid-inline-2"><input type="number" name="tradeInKms" id="tradeInKms" placeholder="Km" class="form-input" inputmode="numeric" min="0" max="1000000"/><input type="text" name="tradeInOwed" id="tradeInOwed" placeholder="Money owed e.g. $5,000 or None" class="form-input" maxlength="20"/></div></div></div>
                  </div>
                </section>
                <section class="form-step hidden" data-id="step-income">
                  <div class="step-inner">
                    <div class="step-title"><h3 class="h3">6. Employment & Income</h3></div>
                    <div class="step-body"><div class="content vstack"><div><label for="incomeSourceFull" class="label">Employment type <span class="text-red-600">*</span></label><select id="incomeSourceFull" name="incomeSourceFull" class="form-select" required><option value="">Select…</option><option value="Full-Time">Full-Time</option><option value="Part-Time">Part-Time</option><option value="Self-Employed">Self-Employed</option><option value="Disability">Disability</option><option value="Other">Other</option></select></div><div><label for="avgMonthlyIncome" class="label">Monthly income (pre-tax) <span class="text-red-600">*</span></label><input type="text" id="avgMonthlyIncome" name="avgMonthlyIncome" class="form-input" placeholder="$4,000" inputmode="numeric" maxlength="16" required/></div></div></div>
                  </div>
                </section>
                <section class="form-step hidden" data-id="step-yourinfo">
                  <div class="step-inner">
                    <div class="step-title"><h3 class="h3">7. Your information</h3></div>
                    <div class="step-body"><div class="content vstack"><div class="grid-inline-2"><div><label for="email" class="label">Email <span class="text-red-600">*</span></label><input type="email" id="email" name="email" class="form-input" autocomplete="email" maxlength="100" required/></div><div><label for="phone" class="label">Phone number <span class="text-red-600">*</span></label><input type="tel" id="phone" name="phone" class="form-input" autocomplete="tel" inputmode="tel" maxlength="14" required/></div></div><div class="grid-inline-3"><div><label for="firstName" class="label">First name <span class="text-red-600">*</span></label><input type="text" id="firstName" name="firstName" class="form-input" autocomplete="given-name" maxlength="50" required/></div><div><label for="middleName" class="label">Middle name(s)</label><input type="text" id="middleName" name="middleName" class="form-input" autocomplete="additional-name" maxlength="100"/></div><div><label for="lastName" class="label">Last name <span class="text-red-600">*</span></label><input type="text" id="lastName" name="lastName" class="form-input" autocomplete="family-name" maxlength="50" required/></div></div><div class="grid-inline-dob"><div><label class="label">DOB Year <span class="text-red-600">*</span></label><select id="dobYear" name="dobYear" class="form-select" required></select></div><div><label class="label">Month <span class="text-red-600">*</span></label><select id="dobMonth" name="dobMonth" class="form-select" required><option value="">MM</option></select></div><div><label class="label">Day <span class="text-red-600">*</span></label><select id="dobDay" name="dobDay" class="form-select" required><option value="">DD</option></select></div><div><label for="maritalStatus" class="label">Marital</label><select id="maritalStatus" name="maritalStatus" class="form-select"><option value="">Select</option><option>Single</option><option>Married</option><option>Common-Law</option><option>Divorced</option><option>Separated</option><option>Widowed</option></select></div></div></div></div>
                  </div>
                </section>
                <section class="form-step hidden" data-id="step-address">
                  <div class="step-inner">
                    <div class="step-title"><h3 class="h3">8. Current address</h3></div>
                    <div class="step-body"><div class="content vstack"><div class="grid-inline-addr1"><input type="text" id="currentStreetAddress" name="currentStreetAddress" class="form-input" placeholder="Street address" autocomplete="street-address" maxlength="120" required/><input type="text" id="currentUnit" name="currentUnit" class="form-input" placeholder="Unit #" maxlength="10"/></div><div class="grid-inline-addr2"><input type="text" id="currentCity" name="currentCity" class="form-input" placeholder="City" autocomplete="address-level2" maxlength="60" required/><select id="currentProvince" name="currentProvince" class="form-select" required><option value="">Prov</option></select><input type="text" id="currentPostalCode" name="currentPostalCode" class="form-input" placeholder="Postal code" autocomplete="postal-code" maxlength="7" required/></div><div class="grid grid-cols-2 md:grid-cols-4 gap-4 items-end"><div><label for="housingPayment" class="label">Monthly payments</label><input type="text" id="housingPayment" name="housingPayment" class="form-input" placeholder="$1800" inputmode="numeric" maxlength="5" required/></div><div><label class="label">Years at address</label><select id="timeAtAddressYears" name="timeAtAddressYears" class="form-select"><option value="">Years</option></select></div><div><label class="label">Months</label><select id="timeAtAddressMonths" name="timeAtAddressMonths" class="form-select"><option value="">Months</option></select></div><div><label class="label">Rent or Own?</label><div class="flex items-center gap-2"><button type="button" class="choice-rect!text-center!py-2.5" id="btnRent" aria-pressed="true">Rent</button><button type="button" class="choice-rect!text-center!py-2.5" id="btnOwn" aria-pressed="false">Own</button></div><input type="hidden" id="housingType" name="housingType" value="Rent" /></div></div></div></div>
                  </div>
                </section>
                <section class="form-step hidden" data-id="step-employer">
                  <div class="step-inner">
                    <div class="step-title"><h3 class="h3">9. Employment details</h3></div>
                    <div class="step-body"><div class="content vstack"><div class="grid-inline-2"><input type="text" id="currentEmployer" name="currentEmployer" class="form-input" placeholder="Employer"/><input type="text" id="jobTitle" name="jobTitle" class="form-input" placeholder="Position"/></div><div class="grid-inline-2"><select id="timeWithEmployerYears" name="timeWithEmployerYears" class="form-select"><option value="">Years</option></select><select id="timeWithEmployerMonths" name="timeWithEmployerMonths" class="form-select"><option value="">Months</option></select></div><div><p class="label">Optional additional income</p><div class="grid-inline-2"><input id="otherIncomeSource" name="otherIncomeSource" class="form-input" placeholder="Type (e.g., child benefit, side work)"/><input id="otherIncomeAmount" name="otherIncomeAmount" class="form-input" placeholder="How much per month" inputmode="numeric" maxlength="16"/></div></div><p class="muted mt-3 text-center">By selecting Next, you give Vancouver Island Credit permission to review your credit to find exact matches.</p></div></div>
                  </div>
                </section>
                <section class="form-step hidden" data-id="step-consent">
                  <div class="step-inner"><input id="creditConsent" name="creditConsent" type="checkbox" class="hidden" checked /></div>
                </section>
              </form>
            </div>
          </div>

          <div class="form-footer flex items-center justify-between" id="form-footer">
            <button type="button" id="btnBack">Back</button>
            <button type="button" id="btnNext" class="cta-button">Next</button>
          </div>
        </div>
      </div>

      <aside class="card p-6 md:p-8 flex flex-col">
        <h2 class="h2">Rate Reduction Calculator</h2>
        <p class="text-zinc-600 mb-6">See if you're entitled to a rate reduction. Enter your current loan details to estimate your savings.</p>
        <div class="space-y-4">
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div><label class="label" for="refLoanInput">Loan amount</label><input id="refLoanInput" class="form-input" placeholder="$15,000" inputmode="numeric" maxlength="14" /></div>
            <div><label class="label" for="refRateInput">Current %</label><input id="refRateInput" class="form-input" placeholder="8.99" inputmode="decimal" maxlength="5" /></div>
          </div>
          <div><label class="label" for="refTermInput">Years remaining</label><select id="refTermInput" class="form-select"><option value="">—</option><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option><option>7</option><option>8</option></select></div>
          <div>
            <label class="label" for="refNewRateSlider">Try a new rate: <b><span id="refNewRateOut">7.99</span>%</b></label>
            <input id="refNewRateSlider" type="range" min="0.00" max="8.99" step="0.05" value="7.99" class="w-full" style="accent-color: var(--brand-blue);">
          </div>
        </div>
        <div class="mt-6 p-4 bg-blue-50 rounded-lg text-center">
          <div id="refResults" class="text-zinc-600">Enter your numbers to see savings.</div>
        </div>
      </aside>
    </section>

    <section id="inventory" class="card p-6 md:p-8">
      <div class="flex flex-wrap items-center justify-between gap-4 mb-4">
        <h2 class="h2">Browse by Vehicle Type</h2>
        <a href="#lead-form" class="font-semibold text-[var(--brand-blue)] hover:underline js-view-inventory">
          All Vehicles <span id="inv-total" class="inv-badge">(769)</span>
        </a>
      </div>
      <p class="text-zinc-600 max-w-3xl">We have access to a wide range of new and used vehicles. Fill out the quick form to see your personalized options. Inventory numbers are updated regularly.</p>

      <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 mt-6">
        <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="bodytype-img" style="background-image:url('Coupe.jpg');"></div><div class="p-3"><p class="font-semibold text-base">Coupe <span class="inv-badge">(0)</span></p></div></a>
        <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="bodytype-img" style="background-image:url('Hatchback.jpg');"></div><div class="p-3"><p class="font-semibold text-base">Hatchback <span class="inv-badge">(40)</span></p></div></a>
        <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="bodytype-img" style="background-image:url('Electric.jpg');"></div><div class="p-3"><p class="font-semibold text-base">Electric/Hybrid <span class="inv-badge">(118)</span></p></div></a>
        <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="bodytype-img" style="background-image:url('Sedan.jpg');"></div><div class="p-3"><p class="font-semibold text-base">Sedan <span class="inv-badge">(163)</span></p></div></a>
        <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="bodytype-img" style="background-image:url('Crossover.jpg');"></div><div class="p-3"><p class="font-semibold text-base">Crossover <span class="inv-badge">(0)</span></p></div></a>
        <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="bodytype-img" style="background-image:url('Suv.jpg');"></div><div class="p-3"><p class="font-semibold text-base">SUV <span class="inv-badge">(486)</span></p></div></a>
        <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="bodytype-img" style="background-image:url('Van.jpg');"></div><div class="p-3"><p class="font-semibold text-base">Van <span class="inv-badge">(0)</span></p></div></a>
        <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="bodytype-img" style="background-image:url('Truck.jpg');"></div><div class="p-3"><p class="font-semibold text-base">Truck <span class="inv-badge">(86)</span></p></div></a>
      </div>
    </section>

    <footer id="contact" class="text-center text-sm text-zinc-600 pt-8 space-y-2">
      <p class="font-bold text-zinc-800">Vancouver Island Credit</p>
      <p>525 Gorge Rd E, Victoria, BC V8T 4T2</p>
      <p><a href="tel:+1-236-969-2424" class="hover:text-[var(--brand-blue)] transition-colors">Customer service: (236) 969-2424</a></p>
      <p class="pt-2">Serving Vancouver Island & British Columbia • Delivery available province-wide</p>
      <p class="mt-4 text-xs text-zinc-500">© <span id="year"></span> Vancouver Island Credit • All rights reserved</p>
    </footer>
  </main>

  <div id="progress-overlay" class="progress-overlay hidden" aria-hidden="true">
    <div class="progress-card">
      <div class="progress-title">Working on it…</div>
      <div class="progress-track"><div id="progress-bar" class="progress-bar"></div></div>
      <ul id="progress-steps" class="progress-steps">
        <li class="active">Submitting your application…</li>
        <li>Verifying your information…</li>
        <li>Finding the best options…</li>
      </ul>
      <p class="progress-note">Secure & encrypted. We never share or sell your info.</p>
    </div>
  </div>

  <script>
  // NOTE: The original JavaScript has been preserved to maintain all form functionality.
  // The new CSS and HTML structure is designed to be compatible with this script.
  const $ = (id) => document.getElementById(id);
  const bySel = (s, root=document) => root.querySelector(s);
  const bySelAll = (s, root=document) => Array.from(root.querySelectorAll(s));

  function fmtMoney(x){ x = isFinite(x)? x : 0; return "$" + x.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ","); }
  function parseMoneyInput(v){ if (!v) return 0; return parseFloat(String(v).replace(/[^0-9.]/g,'')) |

| 0; }
  function formatMoneyField(input){ const num = parseMoneyInput(input.value); input.value = num? num.toLocaleString('en-CA', {style:'currency', currency:'CAD', maximumFractionDigits:0}) : ''; }
  function calcPayment(P, annualRate, years){ const r=(annualRate/100)/12, n=years*12; if(!n||n<=0) return 0; if(r===0) return P/n; return P*r/(1-Math.pow(1+r,-n)); }

  document.addEventListener('DOMContentLoaded', function () {
    $('menuBtn')?.addEventListener('click', ()=> $('mobileMenu')?.classList.toggle('hidden'));

    const stepsMap = {};
    bySelAll('.form-step').forEach(sec => stepsMap[sec.getAttribute('data-id')] = sec);

    function currentFlow(){
      const intent = $('intent')?.value |

| 'finance';
      const hasTrade = ($('hasTradeIn')?.value |

| 'No').toLowerCase()==='yes';
      if (intent==='refinance'){
        return ['step-intent','step-refi-details','step-income','step-yourinfo','step-address','step-employer','step-consent'];
      }
      let flow = ['step-intent','step-cond','step-budget','step-purchase'];
      if (hasTrade) flow.push('step-tradein');
      flow = flow.concat(['step-income','step-yourinfo','step-address','step-employer','step-consent']);
      return flow;
    }

    function showOnly(id){
      Object.values(stepsMap).forEach(sec=> sec.classList.add('hidden'));
      stepsMap[id]?.classList.remove('hidden');
    }
    function updateProgress(curId){
      const flow = currentFlow();
      const i = Math.max(0, flow.indexOf(curId));
      const visible = flow.filter(x=>x!=='step-consent');
      const total = visible.length;
      const stepNumber = Math.min(i+1, total);
      const pct = Math.round((i)/(Math.max(1,total-1))*100);

      $('btnBack').disabled = (i===0);
      $('btnNext').textContent = (i >= total-1)? 'Submit Application' : 'Next';
      bySel('#progress-label').textContent = 'Step ' + stepNumber + ' of ' + total;
      bySel('#progress-fill').style.width = (total>1? pct : 0) + '%';
      bySel('#progress-endcap').textContent = (i >= total-1)? 'Final Step' : 'Let’s get you approved';
    }

    let curStepId = 'step-intent';
    function goTo(id){ curStepId=id; showOnly(id); updateProgress(id); ensureConsistentHeights(); }

    function validateCurrent(stepId){
      const stepEl = stepsMap[stepId];
      if (!stepEl) return true;

      if (stepId==='step-intent'){
        const v = $('intent').value;
        const ok = (v==='finance' |

| v==='refinance');
        bySelAll('[data-intent]').forEach(x=>x.classList.toggle('err',!ok));
        return ok;
      }
      if (stepId==='step-cond'){
        const ok =!!$('vehicleCondition').value;
        bySelAll('[data-cond]').forEach(x => x.classList.toggle('err',!ok));
        return ok;
      }
      if (stepId==='step-budget'){ return!!$('budgetRange').value; }

      let ok = true;
      const fields = Array.from(stepEl.querySelectorAll('[required]'));
      fields.forEach(el=>{
        if (window.getComputedStyle(el).display==='none') return;
        let pass = (el.type==='checkbox')? el.checked : (el.value && el.value.trim()!=='');
        if (el.id==='phone') pass = el.value.replace(/\D/g,'').length>=10;
        if (el.type==='email' |

| el.id==='email'){
          const v=el.value.trim();
          pass = pass && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
        }
        el.classList.toggle('err',!pass);
        const lab = document.querySelector('label[for="'+el.id+'"]'); lab?.classList.toggle('err-label',!pass);
        if (!pass) ok=false;
      });
      return ok;
    }

    function next(delta){
      const flow = currentFlow();
      let i = flow.indexOf(curStepId);
      if (i<0) i=0;
      if (delta>0 &&!validateCurrent(curStepId)) return;
      i += delta;

      const visible = flow.filter(x=>x!=='step-consent');
      const lastIdx = visible.length-1;

      if (i > lastIdx){ submitForm(); return; }
      if (i < 0) i = 0;
      goTo(visible[i]);
    }

    $('btnNext')?.addEventListener('click', ()=> next(1));
    $('btnBack')?.addEventListener('click', ()=> next(-1));

    bySelAll('[data-intent]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        bySelAll('[data-intent]').forEach(x=>x.classList.remove('selected','err'));
        btn.classList.add('selected');
        $('intent').value = btn.dataset.intent;
        if (btn.dataset.intent === 'refinance'){ goTo(currentFlow()[1]); } else { goTo('step-cond'); }
      });
    });

    bySelAll('[data-cond]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        bySelAll('[data-cond]').forEach(x=>x.classList.remove('selected','err'));
        btn.classList.add('selected');
        $('vehicleCondition').value = btn.dataset.cond |

| '';
        goTo('step-budget');
      });
    });

    bySelAll('[data-trade]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        bySelAll('[data-trade]').forEach(x=>x.classList.remove('selected'));
        btn.classList.add('selected');
        $('hasTradeIn').value = btn.dataset.trade |

| 'No';
      });
    });

    const biw = $('biWeeklyRange'); const out = $('biWeeklyOut'); const br = $('budgetRange');
    if (biw && out && br){
      const updateBudget = ()=>{ out.textContent = biw.value; br.value = '$' + biw.value + ' bi-weekly'; };
      biw.addEventListener('input', updateBudget);
      updateBudget();
    }

    function setHousing(type){
      $('housingType').value = type;
      bySelAll('#btnRent, #btnOwn').forEach(b => b.classList.remove('selected'));
      if (type === 'Rent') $('btnRent')?.classList.add('selected');
      if (type === 'Own') $('btnOwn')?.classList.add('selected');
    }
    $('btnRent')?.addEventListener('click', ()=> setHousing('Rent'));
    $('btnOwn')?.addEventListener('click', ()=> setHousing('Own'));

    $('phone')?.addEventListener('input', (e)=>{
      const d=e.target.value.replace(/\D/g,'').slice(0,10);
      if(d.length>6)e.target.value=`(${d.slice(0,3)}) ${d.slice(3,6)}-${d.slice(6)}`;
      else if(d.length>3)e.target.value=`(${d.slice(0,3)}) ${d.slice(3)}`;
      else if(d.length>0)e.target.value=`(${d}`;
    });

    const hp = $('housingPayment');
    if (hp){
      hp.addEventListener('input', (e)=>{ e.target.value = e.target.value.replace(/\D/g,'').slice(0,5); });
      hp.addEventListener('blur', ()=>{ const v = hp.value.replace(/\D/g,''); if (!v){ hp.value=''; return; } hp.value = '$' + Number(v).toLocaleString('en-CA'); });
      hp.addEventListener('focus', ()=>{ hp.value = hp.value.replace(/[^0-9]/g,''); });
    }

    function generateAppCode(){ const n=Math.floor(Math.random()*1_000_000); return 'ABC-' + String(n).padStart(6,'0'); }
    async function runProgressOverlay(minMs=4200){
      const overlay = $('progress-overlay'); const bar = $('progress-bar'); const stepsEl = bySelAll('#progress-steps li');
      if (!overlay ||!bar) return;
      overlay.classList.remove('hidden');
      const stages = [{width:35,index:0,ms:900},{width:70,index:1,ms:1200},{width:100,index:2,ms:1400}];
      const t0=Date.now();
      for (const st of stages){
        stepsEl.forEach((li,i)=> li.classList.toggle('active', i===st.index));
        requestAnimationFrame(()=> bar.style.width = st.width + '%');
        await new Promise(r=>setTimeout(r, st.ms));
      }
      const elapsed=Date.now()-t0; if (elapsed<minMs) await new Promise(r=>setTimeout(r, minMs-elapsed));
      overlay.classList.add('hidden');
    }
    function submitForm(){
      const flow = currentFlow().filter(id=>id!=='step-consent');
      for (const id of flow){ if(!validateCurrent(id)){ goTo(id); return; } }
      bySel('#the-form').requestSubmit();
    }
    bySel('#the-form')?.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const code = generateAppCode();
      try { sessionStorage.setItem('vic_app_code', code); } catch(_){}
      const codeInput = $('appCode'); if (codeInput) codeInput.value = code;
      await runProgressOverlay(4200);
      e.target.submit();
    });

    bySelAll('.js-view-inventory').forEach(el=>{
      el.addEventListener('click', (e)=>{
        e.preventDefault();
        $('lead-form')?.scrollIntoView({behavior:'smooth', block:'center'});
      });
    });

    function populateDOBYears(sel){ if(!sel) return; const start=new Date().getFullYear() - 18; sel.innerHTML=''; for(let y=start;y>=1940;y--){ const o=document.createElement('option');o.value=y;o.textContent=y;sel.appendChild(o);} sel.insertAdjacentHTML('afterbegin','<option value="" selected>YYYY</option>');}
    function populateMonths(sel){ if(!sel) return; const months =; sel.innerHTML = '<option value="">MM</option>'; months.forEach((name, i)=>{ const num = String(i+1).padStart(2,'0'); const o = document.createElement('option'); o.value = (i+1); o.dataset.num = num; o.dataset.long = name; o.textContent = num; sel.appendChild(o); }); }
    function updateDays(){ const y=parseInt($('dobYear')?.value||'',10); const m=parseInt($('dobMonth')?.value||'',10); const selV=parseInt($('dobDay')?.value||'',10); const days=(y&&m)?new Date(y,m,0).getDate():31; const daySel=$('dobDay'); if(!daySel) return; daySel.innerHTML='<option value="">DD</option>'; for(let i=1;i<=days;i++){ const o=document.createElement('option'); o.value=i; o.textContent=(i<10?('0'+i):String(i)); daySel.appendChild(o); } if(selV&&selV<=days) daySel.value=selV; }
    function populateDropdown(sel,start,end,label,singular){ if(!sel) return; sel.innerHTML='<option value="">'+(singular||label)+'</option>'; for(let i=start;i<=end;i++){ const o=document.createElement('option'); o.value=i; o.textContent=i; sel.appendChild(o); } }
    function populateProvinces(sel){ if(!sel) return; const prov=; sel.innerHTML='<option value="">Prov</option>'; prov.forEach(p=>{ const o=document.createElement('option'); o.value=p; o.textContent=p; sel.appendChild(o); }); }
    function populateYears(sel, start, end){ if(!sel) return; sel.innerHTML='<option value="">Year</option>'; for(let y=start; y>=end; y--){ const o=document.createElement('option'); o.value=y; o.textContent=y; sel.appendChild(o);} }

    function setupRefiCalcInputs(){
      const loanEl = $('refLoanInput'), rateEl = $('refRateInput'), termEl = $('refTermInput');
      const newRateSlider = $('refNewRateSlider'), newRateOut = $('refNewRateOut'), results = $('refResults');
      if (!loanEl ||!rateEl ||!termEl ||!newRateSlider ||!newRateOut) return;

      loanEl.addEventListener('blur', ()=>{ formatMoneyField(loanEl); update(); });
      [loanEl, rateEl, termEl].forEach(el=> el.addEventListener('input', update));
      newRateSlider.addEventListener('input', ()=>{ newRateOut.textContent = Number(newRateSlider.value).toFixed(2); update(); });

      function update(){
        const loan = parseMoneyInput(loanEl.value), rate = parseFloat(rateEl.value)||0, years = parseFloat(termEl.value)||0;
        if (!loan ||!rate ||!years){ results.innerHTML = "<div class='text-zinc-600'>Enter your numbers to see savings.</div>"; return; }
        const newRate = Math.min(parseFloat(newRateSlider.value)||0, Math.max(0, rate - 0.99));
        if (newRate.toFixed(2)!== newRateSlider.value) { newRateSlider.value = newRate.toFixed(2); newRateOut.textContent = newRate.toFixed(2); }
        const curPmt = calcPayment(loan, rate, years), newPmt = calcPayment(loan, newRate, years);
        const pmtSaved = Math.max(0, curPmt - newPmt), totalSaved = pmtSaved * years * 12;
        results.innerHTML = `<div class='font-bold text-lg text-zinc-800'>New Payment: <span class='text-green-600'>${fmtMoney(newPmt)}</span></div><div class='text-sm text-zinc-600 mt-1'>Total savings: ~${fmtMoney(totalSaved)}</div>`;
      }
      newRateOut.textContent = Number(newRateSlider.value).toFixed(2);
      update();
    }

    function ensureConsistentHeights(){
      const footer = $('form-footer'); if (!footer) return;
      const footerH = footer.offsetHeight |

| 0;
      bySelAll('.step-inner').forEach(inner => inner.style.setProperty('--footer-space', (footerH + 12) + 'px'));
      let maxContent = 0;
      const hidden =;
      bySelAll('.form-step').forEach(sec => { if (sec.classList.contains('hidden')) { hidden.push(sec); sec.classList.remove('hidden'); } });
      bySelAll('.form-step.step-body >.content').forEach(c => { maxContent = Math.max(maxContent, c.offsetHeight); });
      hidden.forEach(sec => sec.classList.add('hidden'));
      bySelAll('.form-step.step-body').forEach(b => b.style.setProperty('--content-min', maxContent + 'px'));
    }

    (function init(){
      bySel('#year').textContent = new Date().getFullYear();
      $('intent').value = 'finance';
      $('vehicleCondition') && ( $('vehicleCondition').value = 'Both' );
      bySel('')?.classList.add('selected');
      $('housingType') && ( $('housingType').value = 'Rent' );
      setHousing('Rent');
      populateDOBYears($('dobYear')); populateMonths($('dobMonth')); updateDays();
      $('dobMonth')?.addEventListener('change', updateDays); $('dobYear')?.addEventListener('change', updateDays);
      populateDropdown($('timeWithEmployerYears'),0,30,'Years','Year'); populateDropdown($('timeWithEmployerMonths'),0,11,'Months','Month');
      populateDropdown($('timeAtAddressYears'),0,30,'Years','Year'); populateDropdown($('timeAtAddressMonths'),0,11,'Months','Month');
      populateProvinces($('currentProvince'));
      populateYears($('tradeInYear'), new Date().getFullYear(), 1995); populateYears($('refiYear'), new Date().getFullYear(), 1995);
      goTo('step-intent');
      setupRefiCalcInputs();
      ensureConsistentHeights();
      window.addEventListener('resize', ensureConsistentHeights);
      $('btnNext')?.addEventListener('click', ()=> setTimeout(ensureConsistentHeights, 0));
      $('btnBack')?.addEventListener('click', ()=> setTimeout(ensureConsistentHeights, 0));
    })();
  });
  </script>
</body>
</html>
