<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Blake Stolth | Vancouver Island & BC Automotive Advisor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            background-color: #E5E7EB; /* A light gray fallback */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            position: relative;
        }
        /* Desaturated and clearer map background */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image: url('https://i.imgur.com/k3OKj1C.png');
            background-size: cover;
            background-position: center center;
            filter: grayscale(90%) brightness(1.2); /* Desaturates and lightens the map */
            opacity: 0.45; /* Increased opacity for more pop */
            z-index: -1;
        }
        .card {
            /* Enhanced frosted glass effect */
            background-color: rgba(255, 255, 255, 0.6); /* More transparent */
            backdrop-filter: blur(32px); /* Strong blur for readability */
            -webkit-backdrop-filter: blur(32px);
            border-radius: 24px;
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }
        .form-input, .form-select {
            background-color: rgba(239, 242, 245, 0.9);
            border: 2px solid transparent;
            transition: background-color 0.2s ease, border-color 0.2s ease;
            font-size: 16px;
            width: 100%;
            padding: 0.85rem 1rem;
            border-radius: 0.75rem;
        }
        .form-input:focus, .form-select:focus {
            background-color: #ffffff;
            border-color: #007AFF;
            outline: none;
        }
        .cta-button {
            background-color: #007AFF;
            transition: transform 0.2s ease, background-color 0.2s ease;
        }
        .cta-button:hover {
            transform: scale(1.02);
            background-color: #0056b3;
        }
        .cta-button:active {
            transform: scale(0.98);
        }
        .progress-bar-track {
            background-color: rgba(229, 231, 235, 0.7);
        }
        .progress-bar-fill {
            background: linear-gradient(90deg, #3B82F6 0%, #007AFF 100%);
            transition: width 0.5s cubic-bezier(0.25, 1, 0.5, 1);
        }
        .trade-in-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, margin-top 0.5s ease-in-out;
        }
        .success-screen {
            position: fixed;
            inset: 0;
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            z-index: 50;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            animation: fadeInScale 0.5s ease-out forwards;
        }
        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        .benefit-list li {
            padding-left: 1.75rem;
            position: relative;
        }
        .benefit-list li::before {
            content: '';
            position: absolute;
            left: 0;
            top: 5px;
            width: 1rem;
            height: 1rem;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%2322c55e'%3E%3Cpath fill-rule='evenodd' d='M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z' clip-rule='evenodd' /%3E%3C/svg%3E");
            background-size: contain;
            background-repeat: no-repeat;
        }
    </style>
</head>
<body class="p-4">

    <main class="w-full max-w-md space-y-5">

        <!-- Profile Header Card -->
        <div class="card p-4 text-center">
            <div class="flex flex-col items-center">
                <div class="w-24 h-24 rounded-full overflow-hidden border-4 border-white/80 shadow-lg flex-shrink-0 mb-3">
                    <img src="https://i.imgur.com/p1NKGMp.png" alt="Blake Stolth" class="w-full h-full object-cover">
                </div>
                <div>
                    <h1 class="font-extrabold text-2xl text-gray-900">Blake Stolth</h1>
                    <p class="text-sm font-semibold text-blue-600 flex items-center justify-center mt-1">
                        <svg class="w-4 h-4 mr-1.5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path></svg>
                        Your Vancouver Island & BC Automotive Advisor
                    </p>
                </div>
            </div>
            <div class="mt-4 pt-4 border-t border-gray-900/10">
                <p class="text-sm text-gray-800"><span class="font-bold text-green-600">Direct Help, No Hassle:</span> Skip the call centers and AI bots. You'll work directly with me from start to finish.</p>
            </div>
        </div>

        <!-- Value Proposition Card -->
        <div class="card p-5">
             <div class="flex items-center space-x-3 mb-4">
                <div class="bg-blue-100 p-2 rounded-full">
                    <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                </div>
                <h2 class="text-xl font-extrabold text-gray-900">Lower Your Payments</h2>
            </div>
            <p class="text-gray-700 text-[15px] leading-relaxed mb-4">
                If you’re dealing with high payments or juggling bills, now’s the perfect time to make a change.
            </p>
            <ul class="space-y-2 text-gray-800 text-[15px] benefit-list">
                <li><span class="font-bold">Consolidate your debt</span> into ONE low payment.</li>
                <li>Get the <span class="font-bold">lowest rates available</span> O.A.C.</li>
                <li>Lower your monthly costs & <span class="font-bold">upgrade your ride.</span></li>
                <li>Choose from over <span class="font-bold">400 new & used vehicles</span> in stock.</li>
            </ul>
             <div class="mt-4 pt-4 border-t border-gray-900/10 text-center">
                <p class="text-sm text-yellow-700 bg-yellow-50 p-3 rounded-lg"><span class="font-bold">Market Rate Alert:</span> Current rates are at a historic low. Lock in your financing now to maximize your savings before they change.</p>
            </div>
        </div>
        
        <!-- Action & Form Card -->
        <div id="form-section" class="card p-5">
            <div id="form-wrapper">
                <h3 class="font-bold text-center text-gray-900 text-lg mb-4">Instant Pre-Approval Assessment</h3>
                
                <!-- Realistic Approval Gauge -->
                <div class="mb-5">
                    <div class="flex justify-between items-center mb-1">
                        <span class="text-xs font-semibold text-gray-600">Approval Profile Strength</span>
                        <span id="meter-text" class="text-xs font-bold"></span>
                    </div>
                    <div class="w-full progress-bar-track rounded-full h-2.5">
                        <div id="progress-bar" class="progress-bar-fill h-2.5 rounded-full" style="width: 5%;"></div>
                    </div>
                </div>

                <!-- Netlify-enabled form -->
                <form id="lead-form" name="lead-form" method="POST" action="/thank-you.html" data-netlify="true" data-netlify-honeypot="bot-field" class="space-y-4">
                    <!-- Required hidden fields for Netlify -->
                    <input type="hidden" name="form-name" value="lead-form">
                    <p class="hidden">
                        <label>Don’t fill this out: <input name="bot-field" /></label>
                    </p>

                    <!-- Situation Section -->
                    <div>
                        <label for="incomeSource" class="block text-sm font-medium text-gray-800 mb-1">Primary source of income?</label>
                        <select id="incomeSource" name="incomeSource" class="form-select">
                            <option value="0">Please select...</option>
                            <option value="20">Full-Time Employment</option>
                            <option value="15">Self-Employed / Business Owner</option>
                            <option value="10">Part-Time Employment</option>
                            <option value="5">Other</option>
                        </select>
                    </div>
                    <div>
                        <label for="monthlyIncome" class="block text-sm font-medium text-gray-800 mb-1">Estimated Monthly Income (before tax)</label>
                        <input type="text" id="monthlyIncome" name="monthlyIncome" placeholder="e.g., $3,500" class="form-input">
                    </div>
                    <div>
                        <label for="downPayment" class="block text-sm font-medium text-gray-800 mb-1">Estimated down payment?</label>
                        <select id="downPayment" name="downPayment" class="form-select">
                            <option value="0">Please select...</option>
                            <option value="20">$3,000+</option>
                            <option value="10">$1,000 - $3,000</option>
                            <option value="5">$0 - $1,000</option>
                        </select>
                    </div>

                    <!-- Trade-In Section -->
                    <div>
                        <label for="hasTradeIn" class="block text-sm font-medium text-gray-800 mb-1">Do you have a vehicle to trade in?</label>
                        <select id="hasTradeIn" name="hasTradeIn" class="form-select">
                            <option value="0">No</option>
                            <option value="5">Yes</option>
                        </select>
                    </div>
                    <div id="tradeInDetails" class="trade-in-details space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Vehicle Details (Year, Make, Model, KM)</label>
                            <div class="grid grid-cols-1 sm:grid-cols-4 gap-2">
                                <input type="number" id="tradeInYear" name="tradeInYear" placeholder="Year" class="form-input">
                                <input type="text" id="tradeInMake" name="tradeInMake" placeholder="Make" class="form-input">
                                <input type="text" id="tradeInModel" name="tradeInModel" placeholder="Model" class="form-input">
                                <input type="number" id="tradeInKms" name="tradeInKms" placeholder="KM" class="form-input">
                            </div>
                        </div>
                        <div>
                            <label for="tradeInOwed" class="block text-sm font-medium text-gray-700 mb-1">Money owed on trade-in?</label>
                            <input type="text" id="tradeInOwed" name="tradeInOwed" placeholder="e.g., $5,000 or 'None'" class="form-input">
                        </div>
                    </div>

                    <!-- Contact Section -->
                    <div class="border-t border-gray-900/10 my-4"></div>
                    <div>
                        <label for="fullName" class="block text-sm font-medium text-gray-800 mb-1">Full Name <span class="text-red-500">*</span></label>
                        <input type="text" id="fullName" name="fullName" required placeholder="Your Full Name" class="form-input">
                    </div>
                    <div>
                        <label for="phone" class="block text-sm font-medium text-gray-800 mb-1">Phone Number <span class="text-red-500">*</span></label>
                        <input type="tel" id="phone" name="phone" required placeholder="(555) 123-4567" class="form-input">
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-800 mb-1">Email Address <span class="text-red-500">*</span></label>
                        <input type="email" id="email" name="email" required placeholder="you@example.com" class="form-input">
                    </div>

                    <div class="pt-2">
                        <button type="submit" class="w-full cta-button animate-pulse hover:animate-none py-3.5 px-4 rounded-xl text-lg font-bold text-white">
                            See My Options Now
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <!-- Floating Action Button -->
    <a href="#form-section" id="floating-cta" class="fixed bottom-5 right-5 bg-blue-600 text-white font-bold px-5 py-3 rounded-full shadow-2xl z-40 flex items-center space-x-2 animate-bounce hover:animate-none transition-transform hover:scale-105">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
        <span>Apply Now</span>
    </a>

    <!-- Full-Screen Success Message -->
    <div id="success-message" class="hidden success-screen p-8 text-center">
        <div class="mx-auto bg-green-100 w-24 h-24 rounded-full flex items-center justify-center">
           <svg class="w-16 h-16 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
       </div>
       <h2 class="mt-6 text-3xl font-extrabold text-gray-900">Congratulations!</h2>
       <h3 class="mt-2 text-2xl font-bold text-gray-800">You have been pre-approved.</h3>
       <p class="mt-4 text-lg text-gray-600">I will be in touch shortly to discuss your excellent options.</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mainContent = document.querySelector('main');
            const successMessage = document.getElementById('success-message');
            const leadForm = document.getElementById('lead-form');
            const floatingCta = document.getElementById('floating-cta');
            
            const progressBar = document.getElementById('progress-bar');
            const meterText = document.getElementById('meter-text');
            const hasTradeInSelect = document.getElementById('hasTradeIn');
            const tradeInDetailsDiv = document.getElementById('tradeInDetails');

            const scoreInputs = [
                document.getElementById('incomeSource'),
                document.getElementById('monthlyIncome'),
                document.getElementById('downPayment'),
                document.getElementById('hasTradeIn'),
                document.getElementById('fullName'),
                document.getElementById('phone'),
                document.getElementById('email')
            ];

            function updateApprovalScore() {
                let score = 5;
                
                score += parseInt(document.getElementById('incomeSource').value, 10);
                score += parseInt(document.getElementById('downPayment').value, 10);
                score += parseInt(document.getElementById('hasTradeIn').value, 10);

                const monthlyIncome = parseFloat(document.getElementById('monthlyIncome').value.replace(/[^0-9.]/g, ''));
                if (!isNaN(monthlyIncome) && monthlyIncome > 1000) {
                    score += 15;
                }

                if (document.getElementById('fullName').value.trim().length > 1) score += 10;
                if (document.getElementById('phone').value.replace(/\D/g, '').length >= 10) score += 10;
                if (/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(document.getElementById('email').value.trim())) score += 10;
                
                const percentage = Math.min(score, 100);
                progressBar.style.width = `${percentage}%`;

                if (percentage < 35) {
                    meterText.innerHTML = '<span class="text-gray-500">Assessing Profile...</span>';
                } else if (percentage < 65) {
                    meterText.innerHTML = '<span class="text-yellow-600">Building Strength...</span>';
                } else if (percentage < 85) {
                    meterText.innerHTML = '<span class="text-blue-500">Strong Candidate</span>';
                } else {
                    meterText.innerHTML = '<span class="text-green-500">Excellent Profile!</span>';
                }
            }
            
            scoreInputs.forEach(input => {
                input.addEventListener('input', updateApprovalScore);
                input.addEventListener('change', updateApprovalScore);
            });

            hasTradeInSelect.addEventListener('change', (e) => {
                if (e.target.value !== '0') {
                    tradeInDetailsDiv.style.maxHeight = tradeInDetailsDiv.scrollHeight + 'px';
                    tradeInDetailsDiv.style.marginTop = '1rem';
                } else {
                    tradeInDetailsDiv.style.maxHeight = '0';
                    tradeInDetailsDiv.style.marginTop = '0';
                }
            });

            // Helper to URL-encode form data like a normal POST
            function encodeFormData(data) {
                return Object.keys(data)
                    .map(key => encodeURIComponent(key) + '=' + encodeURIComponent(data[key]))
                    .join('&');
            }

            leadForm.addEventListener('submit', async (e) => {
                // Progressive enhancement: submit via fetch for overlay UX,
                // but keep action/method for <noscript> or if JS fails.
                e.preventDefault();
                const fullName = document.getElementById('fullName').value.trim();
                const phone = document.getElementById('phone').value.trim();
                const email = document.getElementById('email').value.trim();

                if (fullName === '' || phone === '' || email === '') {
                    alert('Please fill out your name, phone, and email information.');
                    return;
                }
                
                const formData = new FormData(leadForm);
                // Netlify must see form-name
                if (!formData.get('form-name')) formData.append('form-name', 'lead-form');

                try {
                    await fetch('/', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                        body: new URLSearchParams(formData).toString()
                    });
                    // On success, show overlay
                    mainContent.style.display = 'none';
                    floatingCta.style.display = 'none';
                    successMessage.classList.remove('hidden');
                } catch (err) {
                    console.error(err);
                    alert('Something went wrong submitting the form. Please try again.');
                }
            });

            updateApprovalScore();
        });
    </script>
    <noscript>
        <style>
            #success-message { display: none !important; }
        </style>
        <div class="mt-6 text-center text-sm text-gray-700">
            JavaScript is disabled. The form will submit to the thank-you page.
        </div>
    </noscript>
</body>
</html>
