<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Vancouver Island Credit | Auto Approvals Online — Work with Blake</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --blue-600:#2A5D9F;
      --blue-700:#214B80;
    }
    body{ font-family:'Inter',sans-serif; background:#f6f7fb; }
    .card{ background:#fff; border:1px solid #e5e7eb; border-radius:16px; box-shadow:0 8px 24px -14px rgba(16,24,40,.25); }
    .cta{ background:var(--blue-600); color:#fff; font-weight:800; padding:.85rem 1rem; border-radius:.8rem; }
    .cta:hover{ background:var(--blue-700); transform:translateY(-1px); }

    /* Inputs: compact, consistent */
    .fi, .fs, .ta{
      width:100%; background:#f3f4f6; border:2px solid transparent; color:#0f172a;
      font-size:15px; padding:.62rem .72rem; border-radius:.7rem; transition:.2s;
    }
    .fi:focus, .fs:focus, .ta:focus{ background:#fff; border-color:var(--blue-600); box-shadow:0 0 0 3px rgba(42,93,159,.18); outline:none; }
    label.small{ font-size:.8rem; color:#374151; font-weight:600; margin-bottom:.28rem; display:block; }

    /* Tiles: small & aligned */
    .tile, .choice{
      display:flex; align-items:center; justify-content:center; text-align:center;
      background:#fff; border:2px solid #e5e7eb; border-radius:.66rem;
      padding:.42rem .56rem; font-weight:800; font-size:14.5px;
      width:100%; max-width:124px; height:44px;
      transition:.15s; cursor:pointer; user-select:none;
    }
    .tile:hover, .choice:hover{ border-color:var(--blue-600); background:#f5f8ff; }
    .tile.selected, .choice.selected{ border-color:var(--blue-600); background:#eef4ff; box-shadow:inset 0 0 0 2px var(--blue-600); }
    .tile--budget{ height:40px; font-size:16px; letter-spacing:.15px; }

    /* Fixed shell height = measured from "Your information" step at boot */
    .form-shell{ position:relative; height:540px; overflow:hidden; }
    .form-inner{ height:100%; display:flex; flex-direction:column; }
    .step-wrap{ flex:1 1 auto; overflow:hidden; }
    .step{ height:100%; display:flex; flex-direction:column; }
    .step-body{ flex:1 1 auto; overflow:auto; padding-top:.12rem; padding-bottom:0; }
    .step-footer{ padding-top:.3rem; }

    /* Headings tight & consistent */
    .step h3{ margin-bottom:.5rem !important; }

    /* Progress */
    .track{ height:8px; background:#e5e7eb; border-radius:9999px; overflow:hidden; }
    .fill{ height:8px; background:linear-gradient(90deg, var(--blue-600), var(--blue-700)); width:0%; border-radius:9999px; transition:width .25s ease; }

    /* Segmented switch */
    .seg{ display:inline-flex; gap:.25rem; background:#f3f4f6; padding:.25rem; border-radius:.65rem; }
    .seg-btn{ padding:.38rem .62rem; border-radius:.5rem; font-weight:700; color:#374151; border:2px solid transparent; }
    .seg-btn[aria-pressed="true"]{ background:#e0ecff; color:#214B80; border-color:#bfdbfe; }

    /* Inventory cards */
    .bodytype-card{ border:1px solid #e5e7eb; border-radius:14px; overflow:hidden; background:#fff; transition:.15s; }
    .bodytype-card:hover{ transform:translateY(-2px); border-color:var(--blue-600); box-shadow:0 10px 18px -10px rgba(42,93,159,.35); }
    .bodytype-img{ height:120px; background:#e5e7eb center/cover no-repeat; }

    @media (max-width:380px){
      .tile, .choice{ max-width:116px; height:40px; font-size:14px; }
      .tile--budget{ height:38px; font-size:15.5px; }
    }
  </style>
</head>
<body class="min-h-screen">
  <!-- HEADER / NAV -->
  <header class="container mx-auto max-w-5xl px-4 sm:px-6 pt-4">
    <nav class="card px-4 sm:px-6 py-3 flex items-center justify-between">
      <a href="#" class="flex items-center gap-3">
        <img src="Untitled_Artwork.PNG" alt="Vancouver Island Credit" class="h-10 w-auto object-contain rounded-md" onerror="this.style.display='none'"/>
        <span class="hidden sm:inline font-extrabold tracking-tight text-zinc-900">Vancouver Island Credit</span>
      </a>
      <!-- Right side desktop menu + CTA -->
      <div class="hidden sm:flex items-center gap-6 text-sm font-semibold text-zinc-700">
        <a href="#inventory" class="hover:text-[var(--blue-600)]">Inventory</a>
        <a href="#about" class="hover:text-[var(--blue-600)]">About</a>
        <a href="#contact" class="hover:text-[var(--blue-600)]">Contact</a>
        <a href="#lead-form" class="cta !py-2">Apply Now</a>
      </div>
      <!-- Mobile -->
      <button id="menuBtn" class="sm:hidden inline-flex items-center justify-center h-10 w-10 rounded-md border border-zinc-200">
        <svg class="h-5 w-5 text-zinc-700" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
      </button>
    </nav>
    <div id="mobileMenu" class="hidden sm:hidden mt-2 card px-4 py-3">
      <div class="flex flex-col gap-2 text-sm font-semibold text-zinc-700">
        <a href="#inventory" class="py-2 px-2 rounded hover:bg-zinc-100">Inventory</a>
        <a href="#about" class="py-2 px-2 rounded hover:bg-zinc-100">About</a>
        <a href="#contact" class="py-2 px-2 rounded hover:bg-zinc-100">Contact</a>
        <a href="#lead-form" class="mt-1 cta text-center">Apply Now</a>
      </div>
    </div>
  </header>

  <main class="container mx-auto max-w-5xl px-4 sm:px-6 py-6 space-y-8">
    <!-- HERO / ABOUT -->
    <section id="about" class="card p-5 sm:p-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <h1 class="font-black text-2xl sm:text-3xl tracking-tight text-zinc-900">Get driving in 3 simple steps</h1>
          <ol class="mt-4 space-y-2 text-sm text-zinc-800">
            <li class="flex gap-3"><span class="h-6 w-6 flex items-center justify-center rounded-full bg-zinc-100 text-[var(--blue-600)] font-extrabold">1</span> Enter your info (2–3 min).</li>
            <li class="flex gap-3"><span class="h-6 w-6 flex items-center justify-center rounded-full bg-zinc-100 text-[var(--blue-600)] font-extrabold">2</span> See options you actually qualify for.</li>
            <li class="flex gap-3"><span class="h-6 w-6 flex items-center justify-center rounded-full bg-zinc-100 text-[var(--blue-600)] font-extrabold">3</span> We deliver to your door—easy.</li>
          </ol>
        </div>
        <div class="flex flex-col justify-center">
          <div class="flex items-center space-x-3 mb-3">
            <div class="bg-blue-100 p-3 rounded-xl">
              <svg class="w-6 h-6 text-[var(--blue-600)]" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
              </svg>
            </div>
            <h2 class="text-xl sm:text-2xl font-extrabold text-zinc-900">Fastest Online Approval</h2>
          </div>
          <ul class="space-y-2 text-[14.5px] text-zinc-700">
            <li><strong class="text-zinc-900">Avoid the runaround:</strong> Deal with one real person.</li>
            <li><strong class="text-zinc-900">All credit welcome:</strong> High approval rates.</li>
            <li><strong class="text-zinc-900">Huge selection:</strong> New & used vehicles across BC.</li>
            <li><strong class="text-zinc-900">Delivery:</strong> To your door—anywhere in BC.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- FORM -->
    <section class="card p-0 overflow-hidden" id="lead-form">
      <div class="form-shell" id="form-shell">
        <form id="appForm" name="lead-form" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" action="/thank-you.html" class="form-inner" novalidate>
          <input type="hidden" name="form-name" value="lead-form"/>
          <input type="hidden" name="vehicleType" id="vehicleType"/>
          <input type="hidden" name="vehicleCondition" id="vehicleCondition"/>
          <input type="hidden" name="app_type" id="app_type"/>

          <!-- progress -->
          <div id="progressHdr" class="sticky top-0 z-10 bg-white px-4 sm:px-6 pt-4 pb-3 border-b">
            <div class="flex items-center justify-between mb-2">
              <div id="progress-label" class="text-xs font-semibold text-zinc-700">Step 1 of 6</div>
              <div id="progress-cap" class="text-xs font-semibold text-[var(--blue-700)]">Let’s get you approved</div>
            </div>
            <div class="track"><div id="progress-fill" class="fill"></div></div>
          </div>

          <!-- steps container -->
          <div id="steps" class="step-wrap px-4 sm:px-6 pt-3 pb-3">
            <!-- 1 Vehicle Type -->
            <section class="step" data-stepid="vehicle">
              <div class="step-body">
                <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">What type of vehicle?</h3>
                <div class="grid grid-cols-2 gap-2 justify-items-center mt-2">
                  <button type="button" class="tile" data-type="Car">Car</button>
                  <button type="button" class="tile" data-type="SUV">SUV</button>
                  <button type="button" class="tile" data-type="Truck">Truck</button>
                  <button type="button" class="tile" data-type="Van">Van</button>
                </div>
              </div>
              <div class="step-footer"></div>
            </section>

            <!-- 2 Condition -->
            <section class="step hidden" data-stepid="condition">
              <div class="step-body">
                <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">Used or New?</h3>
                <div class="grid grid-cols-2 gap-2 justify-items-center mt-2">
                  <button type="button" class="choice" data-cond="Used">Used</button>
                  <button type="button" class="choice" data-cond="New">New</button>
                </div>
              </div>
              <div class="step-footer"></div>
            </section>

            <!-- 3 Budget -->
            <section class="step hidden" data-stepid="budget">
              <div class="step-body">
                <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">Monthly budget?</h3>
                <div class="grid grid-cols-2 gap-2 justify-items-center mt-2">
                  <label class="tile tile--budget cursor-pointer"><input class="sr-only" type="radio" name="budgetRange" value="$250–$375" required><span>$250–$375</span></label>
                  <label class="tile tile--budget cursor-pointer"><input class="sr-only" type="radio" name="budgetRange" value="$376–$499" required><span>$376–$499</span></label>
                  <label class="tile tile--budget cursor-pointer"><input class="sr-only" type="radio" name="budgetRange" value="$500–$750" required><span>$500–$750</span></label>
                  <label class="tile tile--budget cursor-pointer"><input class="sr-only" type="radio" name="budgetRange" value="$750+" required><span>$750+</span></label>
                </div>
              </div>
              <div class="step-footer"></div>
            </section>

            <!-- 4 App Type -->
            <section class="step hidden" data-stepid="apptype">
              <div class="step-body">
                <h3 class="text-xl font-extrabold text-zinc-900">Choose your path</h3>
                <p class="text-[13px] text-zinc-600 mt-1 mb-2">Credit Inquiry = quick look at where you stand. Full Application = exact options (if Blake sent you here).</p>
                <div class="grid grid-cols-2 gap-2 justify-items-center">
                  <button type="button" class="choice" data-app="Credit Inquiry">Credit Inquiry</button>
                  <button type="button" class="choice" data-app="Full Application">Full Application</button>
                </div>
              </div>
              <div class="step-footer"></div>
            </section>

            <!-- 5 Your Information (merged) -->
            <section class="step" data-stepid="info" id="infoStep">
              <div class="step-body">
                <h3 class="text-xl font-extrabold text-zinc-900">Your information</h3>

                <div class="grid grid-cols-3 gap-2 mt-2">
                  <div>
                    <label class="small" for="firstName">First name <span class="text-red-500">*</span></label>
                    <input id="firstName" name="firstName" class="fi" required>
                  </div>
                  <div>
                    <label class="small" for="middleName">Middle name <span class="text-red-500">*</span></label>
                    <input id="middleName" name="middleName" class="fi" required>
                  </div>
                  <div>
                    <label class="small" for="lastName">Last name <span class="text-red-500">*</span></label>
                    <input id="lastName" name="lastName" class="fi" required>
                  </div>
                </div>

                <div class="grid grid-cols-2 gap-2 mt-2">
                  <div>
                    <label class="small" for="phone">Phone <span class="text-red-500">*</span></label>
                    <input id="phone" name="phone" class="fi" inputmode="tel" required>
                  </div>
                  <div>
                    <label class="small" for="email">Email <span class="text-red-500">*</span></label>
                    <input id="email" name="email" type="email" class="fi" required>
                  </div>
                </div>

                <div class="grid grid-cols-4 gap-2 mt-2">
                  <div>
                    <label class="small" for="dobMonth">DOB</label>
                    <select id="dobMonth" name="dobMonth" class="fs" required><option value="">Month</option></select>
                  </div>
                  <div class="self-end">
                    <select id="dobDay" name="dobDay" class="fs" required><option value="">Day</option></select>
                  </div>
                  <div class="self-end">
                    <input id="dobYear" name="dobYear" class="fi" placeholder="Year" inputmode="numeric" required>
                  </div>
                  <div>
                    <label class="small" for="maritalStatus">Marital status</label>
                    <select id="maritalStatus" name="maritalStatus" class="fs" required>
                      <option value="">Select…</option>
                      <option>Single</option><option>Married</option><option>Common-Law</option>
                      <option>Divorced</option><option>Separated</option><option>Widowed</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="step-footer"></div>
            </section>

            <!-- 6 Address + Housing -->
            <section class="step hidden" data-stepid="address">
              <div class="step-body">
                <h3 class="text-xl font-extrabold text-zinc-900">Current address</h3>

                <div class="grid grid-cols-6 gap-2 mt-2">
                  <input id="currentStreetAddress" name="currentStreetAddress" class="fi col-span-6 sm:col-span-4" placeholder="Street Address" autocomplete="street-address" required>
                  <input id="currentUnit" name="currentUnit" class="fi col-span-6 sm:col-span-2" placeholder="Unit #">
                  <input id="currentCity" name="currentCity" class="fi col-span-6 sm:col-span-3" placeholder="City" autocomplete="address-level2" required>
                  <select id="currentProvince" name="currentProvince" class="fs col-span-6 sm:col-span-2" required><option value="">Province</option></select>
                  <input id="currentPostalCode" name="currentPostalCode" class="fi col-span-6 sm:col-span-1" placeholder="Postal" autocomplete="postal-code" required>
                </div>

                <div class="grid grid-cols-2 gap-2 mt-2 items-end">
                  <div>
                    <label class="small" for="housingPayment">Monthly Payment <span class="text-red-500">*</span></label>
                    <input id="housingPayment" name="housingPayment" class="fi" placeholder="$1,500" inputmode="numeric" required>
                  </div>
                  <div>
                    <label class="small">Rent or Own? <span class="text-red-500">*</span></label>
                    <div class="seg">
                      <button type="button" class="seg-btn" id="btnRent" aria-pressed="true">Rent</button>
                      <button type="button" class="seg-btn" id="btnOwn" aria-pressed="false">Own</button>
                    </div>
                    <input type="hidden" id="housingType" name="housingType" value="Rent" />
                  </div>
                </div>

                <div class="grid grid-cols-2 gap-2 mt-2">
                  <div>
                    <label class="small" for="timeAtAddressYears">Time at address <span class="text-red-500">*</span></label>
                    <select id="timeAtAddressYears" name="timeAtAddressYears" class="fs" required><option value="">Years</option></select>
                  </div>
                  <div class="self-end">
                    <select id="timeAtAddressMonths" name="timeAtAddressMonths" class="fs" required><option value="">Months</option></select>
                  </div>
                </div>
              </div>
              <div class="step-footer"></div>
            </section>

            <!-- (Dynamic) Previous Address – inserted after Address if <24mo -->
            <template id="tplPrevAddr">
              <section class="step" data-stepid="prev-address">
                <div class="step-body">
                  <h3 class="text-xl font-extrabold text-zinc-900">Previous address</h3>
                  <p class="text-[12.5px] text-zinc-600 mb-1">Required because time at current address is under 2 years.</p>
                  <div class="grid grid-cols-6 gap-2 mt-2">
                    <input id="prevStreetAddress" name="prevStreetAddress" class="fi col-span-6 sm:col-span-4" placeholder="Street Address" required>
                    <input id="prevUnit" name="prevUnit" class="fi col-span-6 sm:col-span-2" placeholder="Unit #">
                    <input id="prevCity" name="prevCity" class="fi col-span-6 sm:col-span-3" placeholder="City" required>
                    <select id="prevProvince" name="prevProvince" class="fs col-span-6 sm:col-span-2" required><option value="">Province</option></select>
                    <input id="prevPostalCode" name="prevPostalCode" class="fi col-span-6 sm:col-span-1" placeholder="Postal" required>
                  </div>
                  <div class="grid grid-cols-2 gap-2 mt-2">
                    <div>
                      <label class="small" for="prevTimeAtAddressYears">Time at previous <span class="text-red-500">*</span></label>
                      <select id="prevTimeAtAddressYears" name="prevTimeAtAddressYears" class="fs" required><option value="">Years</option></select>
                    </div>
                    <div class="self-end">
                      <select id="prevTimeAtAddressMonths" name="prevTimeAtAddressMonths" class="fs" required><option value="">Months</option></select>
                    </div>
                  </div>
                </div>
                <div class="step-footer"></div>
              </section>
            </template>

            <!-- 7 Employment (Credit: simple / Full: detailed) -->
            <section class="step hidden" data-stepid="employment">
              <div class="step-body">
                <h3 class="text-xl font-extrabold text-zinc-900">Employment</h3>

                <!-- Credit Inquiry: simple -->
                <div id="employment-simple" class="space-y-2">
                  <div>
                    <label class="small" for="incomeSource">Primary income source</label>
                    <select id="incomeSource" name="incomeSource" class="fs">
                      <option value="">Please select…</option>
                      <option value="Full-Time">Full-Time Employment</option>
                      <option value="Part-Time">Part-Time Employment</option>
                      <option value="Self-Employed">Self-Employed / Business Owner</option>
                      <option value="Disability">Disability</option>
                      <option value="Other">Other</option>
                    </select>
                  </div>
                  <div>
                    <label class="small" for="monthlyIncome">Monthly income (before tax) <span class="text-red-500">*</span></label>
                    <input id="monthlyIncome" name="monthlyIncome" class="fi" placeholder="$3,500" inputmode="numeric">
                  </div>
                </div>

                <!-- Full Application: detailed -->
                <div id="employment-full" class="hidden space-y-2">
                  <div>
                    <label class="small" for="incomeSourceFull">Primary income source <span class="text-red-500">*</span></label>
                    <select id="incomeSourceFull" name="incomeSourceFull" class="fs">
                      <option value="">Please select…</option>
                      <option value="Full-Time">Full-Time Employment</option>
                      <option value="Part-Time">Part-Time Employment</option>
                      <option value="Self-Employed">Self-Employed / Business Owner</option>
                      <option value="Disability">Disability</option>
                      <option value="Other">Other</option>
                    </select>
                  </div>

                  <div id="full-employment" class="hidden">
                    <div class="grid grid-cols-2 gap-2">
                      <div>
                        <label class="small" for="currentEmployer">Employer <span class="text-red-500">*</span></label>
                        <input id="currentEmployer" name="currentEmployer" class="fi" placeholder="Company name">
                      </div>
                      <div>
                        <label class="small" for="jobTitle">Position / Job Title <span class="text-red-500">*</span></label>
                        <input id="jobTitle" name="jobTitle" class="fi" placeholder="Your role">
                      </div>
                    </div>
                    <div class="grid grid-cols-2 gap-2 mt-2">
                      <div>
                        <label class="small" for="timeWithEmployerYears">Time with employer <span class="text-red-500">*</span></label>
                        <select id="timeWithEmployerYears" name="timeWithEmployerYears" class="fs"><option value="">Years</option></select>
                      </div>
                      <div class="self-end">
                        <select id="timeWithEmployerMonths" name="timeWithEmployerMonths" class="fs"><option value="">Months</option></select>
                      </div>
                    </div>
                  </div>

                  <div id="full-self" class="hidden">
                    <div class="grid grid-cols-2 gap-2">
                      <div>
                        <label class="small" for="businessName">Business name <span class="text-red-500">*</span></label>
                        <input id="businessName" name="businessName" class="fi" placeholder="Your business">
                      </div>
                      <div>
                        <label class="small" for="avgMonthlyIncome">Average monthly income (before tax) <span class="text-red-500">*</span></label>
                        <input id="avgMonthlyIncome" name="avgMonthlyIncome" class="fi" placeholder="$4,000" inputmode="numeric">
                      </div>
                    </div>
                  </div>

                  <div id="full-other" class="hidden">
                    <div class="grid grid-cols-2 gap-2">
                      <div>
                        <label class="small" for="otherIncomeAmount">Monthly income amount (before tax) <span class="text-red-500">*</span></label>
                        <input id="otherIncomeAmount" name="otherIncomeAmount" class="fi" placeholder="$2,000" inputmode="numeric">
                      </div>
                      <div>
                        <label class="small" for="otherIncomeSource">Source description <span class="text-red-500">*</span></label>
                        <input id="otherIncomeSource" name="otherIncomeSource" class="fi" placeholder="Describe the source">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="step-footer"></div>
            </section>

            <!-- (Dynamic) Previous Employment – inserted after Employment if <24mo -->
            <template id="tplPrevEmp">
              <section class="step" data-stepid="prev-employment">
                <div class="step-body">
                  <h3 class="text-xl font-extrabold text-zinc-900">Previous employment</h3>
                  <p class="text-[12.5px] text-zinc-600 mb-1">Required because time with current employer is under 2 years.</p>
                  <div class="grid grid-cols-2 gap-2 mt-2">
                    <div>
                      <label class="small" for="previousEmployer">Previous employer <span class="text-red-500">*</span></label>
                      <input id="previousEmployer" name="previousEmployer" class="fi" placeholder="Company">
                    </div>
                    <div>
                      <label class="small" for="prevTimeWithEmployerYears">Time at previous <span class="text-red-500">*</span></label>
                      <select id="prevTimeWithEmployerYears" name="prevTimeWithEmployerYears" class="fs"><option value="">Years</option></select>
                    </div>
                  </div>
                  <div class="grid grid-cols-2 gap-2 mt-2">
                    <div class="self-end">
                      <select id="prevTimeWithEmployerMonths" name="prevTimeWithEmployerMonths" class="fs"><option value="">Months</option></select>
                    </div>
                  </div>
                </div>
                <div class="step-footer"></div>
              </section>
            </template>

            <!-- 8 Consent & Submit -->
            <section class="step hidden" data-stepid="consent">
              <div class="step-body">
                <h3 class="text-xl font-extrabold text-zinc-900">Finish</h3>
                <div id="consent-inline" class="text-[12.5px] leading-5 text-zinc-600 bg-zinc-50 border border-zinc-200 rounded-md p-3">
                  By submitting, you consent to Vancouver Island Credit collecting and using the information you provide to assess financing options and to contact you about your application.
                </div>
                <div id="consent-checkbox" class="hidden mt-2">
                  <div class="flex items-start gap-3 bg-gray-100 p-3 rounded-lg">
                    <input id="creditConsent" name="creditConsent" type="checkbox" class="h-5 w-5 rounded border-gray-300 mt-0.5"/>
                    <label for="creditConsent" id="consentLabel" class="text-xs text-zinc-700">
                      I consent to a credit inquiry by Blake Stolth / Vancouver Island Credit to assess financing options and confirm the information provided is accurate. <span class="text-red-500 font-bold">*</span>
                    </label>
                  </div>
                </div>
              </div>
              <div class="step-footer"></div>
            </section>
          </div>

          <!-- NAV -->
          <div class="px-4 sm:px-6 pb-4 pt-2 flex items-center justify-between">
            <button type="button" id="btnBack" class="text-sm font-semibold text-zinc-500 hover:text-zinc-800 px-2 py-2 disabled:opacity-30">Back</button>
            <div class="flex items-center gap-2">
              <button type="button" id="btnNext" class="cta">Next</button>
              <button type="submit" id="btnSubmit" class="cta hidden">Submit</button>
            </div>
          </div>
        </form>
      </div>
    </section>

    <!-- INVENTORY (8 boxes) -->
    <section id="inventory" class="card p-5 sm:p-6">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-xl sm:text-2xl font-extrabold text-zinc-900">Browse by Type of Vehicle</h3>
        <a href="#lead-form" class="text-sm font-semibold text-[var(--blue-600)] hover:underline js-view-inventory">View all</a>
      </div>
      <p class="text-sm text-zinc-600 mb-4">Pick a category to see matching options after a quick approval.</p>

      <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('/img/browse-suv.jpg');"></div>
          <div class="p-3"><p class="font-semibold text-sm">SUV / Crossover</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('/img/browse-truck.jpg');"></div>
          <div class="p-3"><p class="font-semibold text-sm">Truck</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('/img/browse-sedan.jpg');"></div>
          <div class="p-3"><p class="font-semibold text-sm">Sedan</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('/img/browse-coupe.jpg');"></div>
          <div class="p-3"><p class="font-semibold text-sm">Coupe</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('/img/browse-minivan.jpg');"></div>
          <div class="p-3"><p class="font-semibold text-sm">Minivan</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('/img/browse-hatchback.jpg');"></div>
          <div class="p-3"><p class="font-semibold text-sm">Hatchback</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('/img/browse-convertible.jpg');"></div>
          <div class="p-3"><p class="font-semibold text-sm">Convertible</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('/img/browse-wagon.jpg');"></div>
          <div class="p-3"><p class="font-semibold text-sm">Wagon</p></div>
        </a>
      </div>
    </section>

    <footer id="contact" class="text-center text-xs text-zinc-500 pt-2 space-y-2">
      <p class="font-semibold text-zinc-600">Vancouver Island Credit</p>
      <p>525 Gorge Rd E, Victoria, BC V8T 4T2</p>
      <p><a href="tel:2369692424" class="hover:text-[var(--blue-600)] transition-colors">(236) 969-2424</a></p>
      <p class="pt-2">Serving Vancouver Island & British Columbia • Delivery available province-wide</p>
      <p class="mt-1">© <span id="year"></span> Vancouver Island Credit • All rights reserved</p>
    </footer>
  </main>

  <script>
    // Helpers
    const $ = (s,root=document)=>root.querySelector(s);
    const $$ = (s,root=document)=>Array.from(root.querySelectorAll(s));

    // Mobile menu
    $('#menuBtn')?.addEventListener('click', ()=> $('#mobileMenu')?.classList.toggle('hidden'));

    // Click inventory -> scroll to form
    $$('.js-view-inventory').forEach(el=>{
      el.addEventListener('click', (e)=>{
        e.preventDefault();
        document.getElementById('lead-form')?.scrollIntoView({behavior:'smooth', block:'start'});
      });
    });

    // Form state
    const form = $('#appForm');
    const stepsWrap = $('#steps');

    // Build step order dynamically (we’ll inject prev address / prev employment when needed)
    const getSteps = () => $$('.step', stepsWrap).filter(s => !s.classList.contains('hidden'));

    function showStepByIndex(idx){
      const steps = getSteps();
      steps.forEach((s,i)=> s.classList.toggle('hidden', i!==idx));
      window.__cur = idx;
      updateProgress();
      // ensure step body starts at top within fixed shell
      const body = $('.step:not(.hidden) .step-body');
      body?.scrollTo({top:0, behavior:'instant'});
      updateNavButtons();
    }

    function updateNavButtons(){
      const steps = getSteps();
      const last = steps.length - 1;
      const i = window.__cur || 0;
      $('#btnBack').disabled = (i===0);
      $('#btnNext').classList.toggle('hidden', i===last);
      $('#btnSubmit').classList.toggle('hidden', i!==last);
      $('#progress-cap').textContent = (i===last) ? 'See options you’re actually qualified for' : 'Let’s get you approved';
    }

    function updateProgress(){
      const steps = getSteps();
      const total = steps.length;
      const i = (window.__cur || 0) + 1;
      $('#progress-label').textContent = `Step ${i} of ${total}`;
      const pct = Math.round((i-1)/(total-1)*100);
      $('#progress-fill').style.width = pct + '%';
    }

    // Selection handlers
    $$('.tile[data-type]').forEach(b=>{
      b.addEventListener('click',()=>{
        $('#vehicleType').value = b.dataset.type;
        $$('.tile[data-type]').forEach(x=>x.classList.remove('selected'));
        b.classList.add('selected');
        next(1);
      });
    });
    $$('.choice[data-cond]').forEach(b=>{
      b.addEventListener('click',()=>{
        $('#vehicleCondition').value = b.dataset.cond;
        $$('.choice[data-cond]').forEach(x=>x.classList.remove('selected'));
        b.classList.add('selected');
        next(1);
      });
    });
    $$('label.tile input[name="budgetRange"]').forEach(r=>{
      const parent = r.closest('label');
      parent.addEventListener('click',()=>{ r.checked = true; next(1); });
    });
    $$('.choice[data-app]').forEach(b=>{
      b.addEventListener('click',()=>{
        setAppMode(b.dataset.app);
        $$('.choice[data-app]').forEach(x=>x.classList.remove('selected'));
        b.classList.add('selected');
        next(1);
      });
    });

    // Rent/Own segmented switch
    function setHousing(type){
      $('#housingType').value = type;
      $('#btnRent').setAttribute('aria-pressed', type==='Rent');
      $('#btnOwn').setAttribute('aria-pressed', type==='Own');
    }
    $('#btnRent')?.addEventListener('click', ()=> setHousing('Rent'));
    $('#btnOwn')?.addEventListener('click', ()=> setHousing('Own'));

    // Mode (Credit vs Full) affects visibility + consent style
    const mode = ()=> $('#app_type').value;
    function setAppMode(nextMode){
      $('#app_type').value = nextMode || '';

      const isCredit = nextMode === 'Credit Inquiry';
      const isFull   = nextMode === 'Full Application';

      // Employment blocks
      $('#employment-simple').classList.toggle('hidden', !isCredit);
      $('#employment-full').classList.toggle('hidden', !isFull);

      // Required flags
      $('#monthlyIncome')?.toggleAttribute('required', isCredit);
      $('#incomeSourceFull')?.toggleAttribute('required', isFull);

      // Consent
      $('#consent-inline').classList.toggle('hidden', !isCredit);
      $('#consent-checkbox').classList.toggle('hidden', !isFull);

      // Recompute tallest if needed (but shell is pegged to info step height; no jump)
      renumberSteps();
    }

    // Prev Address logic: insert step after Address when <24mo
    function ensurePrevAddressStep(need){
      const exists = $('[data-stepid="prev-address"]', stepsWrap);
      if (need && !exists){
        const tpl = $('#tplPrevAddr').content.cloneNode(true);
        // insert right after Address step
        const addr = $('[data-stepid="address"]', stepsWrap);
        addr.after(tpl);
        populateProvinces($('#prevProvince'));
        populateDropdown($('#prevTimeAtAddressYears'), 0, 30, 'Years', 'Year');
        populateDropdown($('#prevTimeAtAddressMonths'), 0, 11, 'Months', 'Month');
        renumberSteps();
      } else if (!need && exists){
        exists.remove();
        renumberSteps();
      }
    }

    // Prev Employment logic: insert step after Employment when <24mo
    function ensurePrevEmploymentStep(need){
      const exists = $('[data-stepid="prev-employment"]', stepsWrap);
      if (need && !exists){
        const tpl = $('#tplPrevEmp').content.cloneNode(true);
        const emp = $('[data-stepid="employment"]', stepsWrap);
        emp.after(tpl);
        populateDropdown($('#prevTimeWithEmployerYears'), 0, 30, 'Years', 'Year');
        populateDropdown($('#prevTimeWithEmployerMonths'), 0, 11, 'Months', 'Month');
        renumberSteps();
      } else if (!need && exists){
        exists.remove();
        renumberSteps();
      }
    }

    // Address duration watcher
    function onAddressDurationChange(){
      const y = parseInt($('#timeAtAddressYears').value||'0',10);
      const m = parseInt($('#timeAtAddressMonths').value||'0',10);
      const months = (y*12)+m;
      const need = (y!==0 || m!==0) && months < 24;
      ensurePrevAddressStep(need);
    }
    $('#timeAtAddressYears')?.addEventListener('change', onAddressDurationChange);
    $('#timeAtAddressMonths')?.addEventListener('change', onAddressDurationChange);

    // Employment detail branching for Full
    function onIncomeSourceFullChange(){
      const v = $('#incomeSourceFull').value;
      const employed = (v === 'Full-Time' || v === 'Part-Time');
      const selfEmp = (v === 'Self-Employed');
      const other = (v === 'Disability' || v === 'Other');

      $('#full-employment').classList.toggle('hidden', !employed);
      $('#full-self').classList.toggle('hidden', !selfEmp);
      $('#full-other').classList.toggle('hidden', !other);

      // Required flags
      ['currentEmployer','jobTitle','timeWithEmployerYears','timeWithEmployerMonths'].forEach(id=> $('#'+id)?.toggleAttribute('required', employed));
      ['businessName','avgMonthlyIncome'].forEach(id=> $('#'+id)?.toggleAttribute('required', selfEmp));
      ['otherIncomeAmount','otherIncomeSource'].forEach(id=> $('#'+id)?.toggleAttribute('required', other));

      // Check prev employment need if employed
      if (employed){
        const y = parseInt($('#timeWithEmployerYears').value||'0',10);
        const m = parseInt($('#timeWithEmployerMonths').value||'0',10);
        const months = (y*12)+m;
        ensurePrevEmploymentStep((y!==0 || m!==0) && months < 24);
      } else {
        ensurePrevEmploymentStep(false);
      }
    }
    $('#incomeSourceFull')?.addEventListener('change', onIncomeSourceFullChange);
    $('#timeWithEmployerYears')?.addEventListener('change', ()=>{
      const y = parseInt($('#timeWithEmployerYears').value||'0',10);
      const m = parseInt($('#timeWithEmployerMonths').value||'0',10);
      const months = (y*12)+m;
      ensurePrevEmploymentStep((y!==0 || m!==0) && months < 24);
    });
    $('#timeWithEmployerMonths')?.addEventListener('change', ()=>{
      const y = parseInt($('#timeWithEmployerYears').value||'0',10);
      const m = parseInt($('#timeWithEmployerMonths').value||'0',10);
      const months = (y*12)+m;
      ensurePrevEmploymentStep((y!==0 || m!==0) && months < 24);
    });

    // Validation helpers
    function visibleRequiredInStep(stepEl){
      return $$('[required]', stepEl).filter(el => el.offsetParent !== null);
    }
    function validateCurrentStep(){
      const steps = getSteps();
      const el = steps[window.__cur||0];
      let ok = true;
      visibleRequiredInStep(el).forEach(i=>{
        let pass = (i.type==='checkbox') ? i.checked : (i.value && i.value.trim()!=='');
        if (i.id==='phone') pass = i.value.replace(/\D/g,'').length>=10;
        if (i.type==='email' || i.id==='email'){ const v=i.value.trim(); pass = pass && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v); }
        i.classList.toggle('ring-2', !pass);
        i.classList.toggle('ring-red-400', !pass);
        if (!pass) ok = false;
      });
      return ok;
    }

    // Navigation
    function next(delta){
      const steps = getSteps();
      let i = window.__cur || 0;
      if (delta>0 && !validateCurrentStep()) return;
      i += delta;
      if (i < 0) i = 0;
      if (i >= steps.length){ return; }
      showStepByIndex(i);
    }
    $('#btnNext').addEventListener('click', ()=> next(1));
    $('#btnBack').addEventListener('click', ()=> next(-1));

    // Submit
    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      if (!validateCurrentStep()) return;
      try{
        const fd = new FormData(form);
        await fetch('/', { method:'POST', headers:{'Content-Type':'application/x-www-form-urlencoded'}, body:new URLSearchParams(fd).toString() });
        window.location.href = '/thank-you.html';
      }catch(err){
        form.submit(); // Netlify fallback
      }
    });

    // Populate selects
    function populateMonths(sel){
      if(!sel) return;
      const m=["January","February","March","April","May","June","July","August","September","October","November","December"];
      m.forEach((mm,i)=>{ const o=document.createElement('option'); o.value=i+1; o.textContent=mm; sel.appendChild(o);});
    }
    function updateDays(){
      const y=parseInt($('#dobYear').value||'',10);
      const m=parseInt($('#dobMonth').value||'',10);
      const sel=parseInt($('#dobDay').value||'',10);
      const days=(y&&m)?new Date(y,m,0).getDate():31;
      $('#dobDay').innerHTML='<option value="">Day</option>';
      for(let i=1;i<=days;i++){ const o=document.createElement('option'); o.value=i; o.textContent=i; $('#dobDay').appendChild(o); }
      if(sel&&sel<=days) $('#dobDay').value=sel;
    }
    function populateDropdown(sel,start,end,label,singular){
      if(!sel) return;
      sel.innerHTML='<option value="">'+(singular||label)+'</option>';
      for(let i=start;i<=end;i++){
        const o=document.createElement('option'); o.value=i; o.textContent=i+' '+(i!==1?label:(singular||label)); sel.appendChild(o);
      }
    }
    function populateProvinces(sel){
      if(!sel) return;
      const prov=["AB","BC","MB","NB","NL","NS","NT","NU","ON","PE","QC","SK","YT"];
      sel.innerHTML = '<option value="">Province</option>';
      prov.forEach(p=>{ const o=document.createElement('option'); o.value=p; o.textContent=p; sel.appendChild(o); });
    }

    // Renumber steps after inserts/removals
    function renumberSteps(){
      const steps = getSteps();
      steps.forEach((s,idx)=> s.dataset.stepIndex = idx);
      updateProgress();
      updateNavButtons();
    }

    // Measure "Your information" and set fixed shell height
    function pegShellHeightToInfo(){
      const shell = $('#form-shell');
      const info = $('#infoStep');
      const wasHidden = info.classList.contains('hidden');
      if (wasHidden) info.classList.remove('hidden');
      // Temporarily show inside wrapper to measure natural height (body + footer + header height already fixed)
      const body = $('.step-body', info);
      const footer = $('.step-footer', info);
      const hdrH = $('#progressHdr').offsetHeight;
      const innerPad =  (parseFloat(getComputedStyle($('#steps')).paddingTop)||0) + (parseFloat(getComputedStyle($('#steps')).paddingBottom)||0);
      const target = Math.ceil(body.scrollHeight + footer.offsetHeight + innerPad + hdrH + 10); // small buffer
      // Lock height (no jumping)
      shell.style.height = Math.min(560, Math.max(480, target)) + 'px';
      if (wasHidden) info.classList.add('hidden');
    }

    // Init
    (function init(){
      // footer year
      const y = new Date().getFullYear(); $('#year') && ($('#year').textContent = y);

      // DOB
      populateMonths($('#dobMonth')); updateDays();
      $('#dobMonth').addEventListener('change', updateDays);
      $('#dobYear').addEventListener('input', updateDays);

      // Dropdowns
      populateDropdown($('#timeAtAddressYears'), 0, 30, 'Years', 'Year');
      populateDropdown($('#timeAtAddressMonths'), 0, 11, 'Months', 'Month');
      populateDropdown($('#timeWithEmployerYears'), 0, 30, 'Years', 'Year');
      populateDropdown($('#timeWithEmployerMonths'), 0, 11, 'Months', 'Month');

      populateProvinces($('#currentProvince'));

      // Default housing
      setHousing('Rent');

      // Fix clickability by ensuring no overlays on top of form
      $('#progressHdr').style.pointerEvents = 'auto';

      // Peg fixed height to "Your information"
      pegShellHeightToInfo();

      // Start at first step
      // Show step 0 (vehicle)
      // Keep others hidden
      showStepByIndex(0);

      // Re-peg on resize (debounced)
      let t; window.addEventListener('resize', ()=>{ clearTimeout(t); t=setTimeout(pegShellHeightToInfo, 120); });

      renumberSteps();
    })();
  </script>
</body>
</html>
