<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    
  <title>Vancouver Island Credit | Auto Approvals Online</title>

  <meta name="description" content="Fast, confidential auto approvals across Vancouver Island & BC. New & used options. Delivery to your door. Work 1 on 1 with Blake Stolth." />
  <link rel="canonical" href="https://vancouverislandcredit.ca/"/>
  <meta property="og:title" content="Vancouver Island Credit — Auto Approvals Online"/>
  <meta property="og:description" content="Get approved online. New & used inventory across Vancouver Island & BC. Delivery to your door."/>
  <meta property="og:type" content="website"/>
  <meta property="og:image" content="https://vancouverislandcredit.ca/0041B99D-D49A-4024-AA7A-2786A4605342.jpg"/>
  <meta name="theme-color" content="#2A5D9F"/>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700;800;900&display=swap" rel="stylesheet"/>

  <style>
    :root{
      /* COLORS */
      --blue-600:#2A5D9F; 
      --blue-700:#214B80; 
      --blue-100:#EAF1FB; 
      --red-equifax: #A8202A; 
      --theme-green: #15803d; /* Dark, Financial Green */
      --slate-50: #f8fafc;
      --slate-100: #f1f5f9;
      --slate-200: #e2e8f0;
      --slate-300: #cbd5e1;
      --slate-400: #94a3b8;
      --slate-500: #64748b;
      --slate-600: #475569;
      --slate-700: #334155;
      --slate-800: #1e293b;

      /* Typography & Spacing */
      --fs-h1: 26px; --fs-h2: 18px; --fs-body: 13px; --fs-label: 11px; 
      --radius: 8px;
      --control-h: 44px;
      --field-gap: 8px; 
    }

    body{
      font-family:'Work Sans',sans-serif;
      background: var(--slate-100);
      color: var(--slate-700);
      overflow-x: hidden;
    }
    
    body.modal-open { overflow: hidden !important; }

    .h1{ font-size:var(--fs-h1); font-weight:800; color:var(--slate-800); line-height: 1.1; letter-spacing: -0.5px; }
    .h2{ font-size:var(--fs-h2); font-weight:800; color:var(--slate-800); margin-bottom:4px; white-space: nowrap; letter-spacing: -0.02em; }
    @media(max-width: 640px) { .h2 { white-space: normal; } }
    .label{ font-size:var(--fs-label); color:var(--slate-700); font-weight:700; display:block; margin-bottom:4px; text-transform: uppercase; letter-spacing: 0.02em; text-align: left; }
    
    .card{ background:#fff; border-radius:12px; border:1px solid var(--slate-200); box-shadow:0 10px 15px -3px rgb(0 0 0 / 0.05); }
    .card-accent{ border: 1px solid var(--slate-300); box-shadow: 0 10px 25px -5px rgba(30, 41, 59, 0.05); background: #fff; }

    /* Form Styles */
    .form-input,.form-select{
      background: var(--slate-50); color:var(--slate-800); border:1px solid var(--slate-300);
      font-size:var(--fs-body); width:100%; padding: 0 12px; border-radius: var(--radius); 
      height: var(--control-h) !important; line-height: var(--control-h); font-weight: 500; display: block; box-sizing: border-box;
    }
    .form-input:focus,.form-select:focus{ background:#fff; border-color:var(--blue-600); box-shadow:0 0 0 3px rgba(42,93,159,.15); outline:none; }

    .form-select {
      -webkit-appearance: none; appearance: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
      background-position: right 0.8rem center; background-size: 1.2em 1.2em; background-repeat: no-repeat; padding-right: 2.5rem;
      display: flex; align-items: center;
    }

    .cta-button{ background:var(--blue-600); color:#fff; font-weight:700; padding:.5rem 1.2rem; border-radius: var(--radius); font-size:var(--fs-cta); min-height:42px; transition: all .2s ease; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); display: inline-flex; align-items: center; justify-content: center; cursor: pointer; border: none;}
    .cta-button:hover{ background:var(--blue-700); transform: translateY(-1px); }
    .cta-button:active{ transform: scale(0.98); }

    .track{ height:5px; background:var(--slate-200); border-radius:9999px; overflow:hidden; }
    .fill{ height:5px; background:var(--blue-600); border-radius:9999px; width:0%; transition:width .3s ease; }
    .err{ border-color:var(--red-equifax) !important; background-color: #fff5f5; animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; } 
    .err-label{ color:var(--red-equifax) !important; }
    @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }

    /* --- PREMIUM SLIDER STYLING --- */
    input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
    input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 18px; width: 18px; border-radius: 50%; background: #fff; border: 4px solid var(--blue-600); margin-top: -7px; box-shadow: 0 1px 3px rgba(0,0,0,0.3); cursor: pointer; transition: transform 0.1s; }
    input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.1); }
    input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; cursor: pointer; background: #e2e8f0; border-radius: 99px; }
    input[type=range]::-moz-range-thumb { height: 18px; width: 18px; border: 4px solid var(--blue-600); border-radius: 50%; background: #fff; cursor: pointer; }
    input[type=range]::-moz-range-track { width: 100%; height: 4px; cursor: pointer; background: #e2e8f0; border-radius: 99px; }

    /* --- BOLD CALCULATOR STYLES --- */
    .calc-box {
        background: #ffffff;
        border: 1px solid #cbd5e1;
        border-radius: 12px;
        box-shadow: 0 20px 40px -10px rgba(30, 41, 59, 0.12);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        height: 452px !important; /* MATCHING FORM HEIGHT */
    }

    .calc-header {
        background: var(--blue-600); /* THEME BLUE */
        padding: 16px 20px;
        border-bottom: 4px solid var(--blue-700);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-shrink: 0;
    }
    .calc-header h4 { color: #fff; font-size: 16px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.05em; margin: 0; }
    .calc-header p { color: rgba(255,255,255,0.8); font-size: 10px; font-weight: 600; margin: 0; }

    .calc-display-hero {
        background: #f8fafc;
        padding: 16px;
        text-align: center;
        border-bottom: 1px solid #e2e8f0;
        flex-shrink: 0;
    }
    .save-label { font-size: 10px; font-weight: 800; color: #64748b; text-transform: uppercase; letter-spacing: 0.05em; }
    .save-amount { font-size: 38px; font-weight: 900; color: var(--theme-green); line-height: 1; letter-spacing: -1px; margin: 4px 0; }
    .save-sub { font-size: 9px; color: #64748b; font-weight: 600; background: #dcfce7; color: #166534; padding: 2px 8px; border-radius: 4px; display: inline-block;}

    .calc-inputs { 
        padding: 16px 20px; 
        background: #fff; 
        flex: 1; 
        display: flex; 
        flex-direction: column; 
        justify-content: space-between; 
    }

    .bold-input-group {
        position: relative;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        transition: all 0.2s;
    }
    .bold-input-group:focus-within { border-color: var(--blue-600); box-shadow: 0 4px 12px rgba(42, 93, 159, 0.15); }

    .bold-label {
        position: absolute;
        top: -8px;
        left: 10px;
        background: #fff;
        padding: 0 4px;
        font-size: 9px;
        font-weight: 800;
        color: var(--blue-700);
        text-transform: uppercase;
    }

    .bold-input {
        width: 100%;
        border: none;
        padding: 10px 12px;
        font-size: 16px;
        font-weight: 700;
        color: #334155;
        outline: none;
        background: transparent;
        border-radius: 8px;
    }
    
    /* Layout Engine */
    #lead-form-card { min-height: 382px; position: relative; }
    .form-shell { position: relative; overflow: hidden; height: 380px; background: #fff; transition: height 0.3s ease; z-index: 1; }
    .form-clipper { position: relative; width: 100%; height: 100%; display: flex; flex-direction: column; background: #fff; border-radius: 12px; overflow: hidden; }
    .form-header { position: absolute; top: 0; left: 0; right: 0; z-index: 10; background: rgba(255,255,255,0.98); padding: 10px 20px; border-bottom: 1px solid var(--slate-200); height: 50px; }
    .step-viewport { position: absolute; top: 50px; bottom: 70px; left: 0; right: 0; overflow-y: auto; overflow-x: hidden; display: flex; flex-direction: column; }
    .step-viewport-inner, #the-form, .form-step { height: 100%; width: 100%; }
    .step-inner { width: 100%; max-width: 720px; margin: 0 auto; height: 100%; display: flex; flex-direction: column; padding: 0 20px; }
    .step-title { text-align: center; margin-top: 12px; flex-shrink: 0; padding-bottom: 4px; }
    .step-body { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; padding-bottom: 5px; }
    .step-body > .content { width: 95%; max-width: 500px; margin: 0 auto; text-align: center; }
    .form-footer { position: absolute; bottom: 0; left: 0; right: 0; background: rgba(255,255,255,0.98); border-top: 1px solid var(--slate-200); padding: 0 20px; height: 70px; z-index: 20; display: flex; align-items: center; justify-content: space-between; }
    
    .form-backdrop { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.4); backdrop-filter: blur(6px); opacity: 0; pointer-events: none; transition: opacity 0.3s ease; z-index: 9990; }
    .form-backdrop.active { opacity: 1; pointer-events: auto; }
    .form-focused { position: fixed !important; top: 50% !important; left: 50% !important; width: 95vw !important; max-width: 800px !important; height: 600px !important; max-height: 90vh !important; z-index: 9999 !important; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); border-radius: 12px; margin: 0 !important; overflow: visible !important; animation: modalPop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
    .form-focused.form-closing { animation: modalPopReverse 0.3s ease-in forwards !important; }
    @keyframes modalPop { 0% { transform: translate(-50%, -45%) scale(0.8); } 100% { transform: translate(-50%, -50%) scale(1); } }
    @keyframes modalPopReverse { 0% { transform: translate(-50%, -50%) scale(1); } 100% { transform: translate(-50%, -45%) scale(0.8); } }
    .form-close-btn { position: absolute; top: -12px; right: -12px; width: 26px; height: 26px; background: #e2e8f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; color: #64748b; transition: all 0.2s; z-index: 10000; border: 2px solid #fff; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
    .form-trigger-overlay { position: absolute; inset: 0; z-index: 30; cursor: pointer; }

    /* Utility */
    .choice-rect { width:100%; text-align:left; border:1.5px solid var(--slate-300); border-radius:var(--radius); background:#fff; font-weight:600; color: var(--slate-700); transition:all .15s ease; display:flex; align-items:center; cursor:pointer; padding: 0 16px; min-height: 50px; font-size: 15px; justify-content: center; }
    .choice-rect:hover{ border-color:var(--blue-600); background: #f8fafc; transform: translateY(-1px); }
    .choice-rect.selected{ border-color:var(--blue-600); background:var(--blue-100); color: var(--blue-700); box-shadow: 0 0 0 1px var(--blue-600); }
    .seg{ display:inline-flex; align-items:center; gap:4px; background:var(--slate-100); border:1.5px solid var(--slate-200); border-radius:8px; padding:4px; width: 100%; }
    .seg-btn{ flex: 1; appearance:none; border:0; background:transparent; cursor:pointer; padding:6px 10px; border-radius:6px; font-weight:700; font-size:13px; color:var(--slate-500); transition:all .15s ease; }
    .seg-btn[aria-pressed="true"]{ background:#fff; color:var(--blue-600); box-shadow:0 1px 3px rgba(0,0,0,.1); }
    .grid-inline-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    .brand-left{ display:flex; align-items:center; gap:12px; }
    .site-logo{ height:45px; width:auto; object-fit:contain; display:block; transform:translateY(-1px); }
    @media (min-width:640px){ .site-logo{ height:60px; } }
    .brand-stack{ display:flex; flex-direction:column; justify-content: center; gap:2px; }
    .brand-title{ color:var(--slate-800); font-weight:800; letter-spacing:-0.02em; font-size:var(--nav-font); white-space:nowrap; text-decoration:none; line-height:1; margin-left:-2px; }
    .powered-by-inline{ display:flex; align-items:center; gap:6px; font-size: 11px; color:var(--slate-500); font-weight:600; line-height:1; margin-top:2px; }
    .powered-by-inline img{ height: 11px; width:auto; object-fit:contain; position:relative; top:1px; opacity: 0.8; }
    .abc-badge{ display:inline-flex; align-items:center; justify-content:center; width:20px; height:20px; border-radius:9999px; background:var(--blue-600); color:#fff; border:none; font-weight:800; font-size:11px; line-height:1; flex-shrink:0; }
    .bodytype-card{ position: relative; overflow:hidden; border-radius:12px; border:1px solid var(--slate-200); background:#fff; transition:transform .2s,box-shadow .2s,border-color .2s; }
    .bodytype-card:hover{ transform:translateY(-3px); border-color:var(--blue-600); box-shadow:0 12px 20px -5px rgba(42,93,159,.2); }
    .bodytype-img{ background:#e5e7eb center/cover no-repeat; height:90px; }
    @media (min-width:640px){ .bodytype-img{ height:100px; } }
    .inv-overlay { position: absolute; inset: 0; background: rgba(42,93,159,0.9); display: flex; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.2s ease; color: white; font-weight: 700; font-size: 14px; z-index: 5; border-radius: 11px;}
    .bodytype-card:hover .inv-overlay { opacity: 1; }
    .map-embed{ width:100%; height:200px; border:0; border-radius: inherit; }
    @media (min-width:640px){ .map-embed{ height:150px; } }
    .progress-overlay{position:fixed;inset:0;background:rgba(15,23,42,.6);backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:center;z-index:50}
    .progress-card{background:#fff;border-radius:16px;box-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);width:min(520px,92vw);padding:24px 20px}
    .progress-title{font-weight:800;font-size:18px;color:var(--slate-800)}
    .progress-track{height:8px;background:var(--slate-200);border-radius:9999px;overflow:hidden;margin-top:12px}
    .progress-bar{height:8px;width:0%;background:linear-gradient(90deg,var(--blue-600),var(--blue-grad));transition:width .6s ease}
    .progress-steps{list-style:none;padding:0;margin:16px 0 0;font-size:14px;color:var(--slate-600); space-y-2}
    .progress-steps li{display:flex;align-items:center;gap:10px;opacity:.7; transition: all .3s ease;}
    .progress-steps li.active{opacity:1;font-weight:700; color: var(--slate-800);}
    .progress-note{margin-top:12px;font-size:12px;color:var(--slate-500)}
    .js-hidden { display:none !important; }

    /* --- PROFESSIONAL COMPACT TREE STYLES (RESTORED FROM YOUR REFERENCE) --- */
    .wide-section-container {
        width: 100%; 
        max-width: 100%; 
        overflow-x: auto; 
        padding: 20px 0;
        text-align: center;
    }
    .tree-wrapper { display: inline-flex; flex-direction: column; align-items: center; margin: 0 auto; padding: 0 10px; }
    .tree-row { display: flex; justify-content: center; width: 100%; position: relative; gap: 20px; }
    .tree-col { display: flex; flex-direction: column; align-items: center; position: relative; padding: 20px 5px 0 5px; flex: 1; }
    .tree-col::before { content: ''; position: absolute; top: 0; left: 50%; border-left: 2px solid #cbd5e1; width: 0; height: 20px; }
    .tree-col::after { content: ''; position: absolute; top: 0; border-top: 2px solid #cbd5e1; height: 20px; width: 50%; }
    .tree-col:first-child::after { left: 50%; border-left: 0; }
    .tree-col:last-child::after { right: 50%; border-right: 0; }
    .tree-col.only-child::after, .tree-col.only-child::before { display: none; }
    .tree-col.only-child { padding-top: 0; }
    .connector-down { width: 2px; height: 15px; background: #cbd5e1; margin: 0 auto; }
    .node-box { background: #fff; color: var(--slate-700); border: 1px solid #cbd5e1; border-radius: 6px; padding: 8px 16px; text-align: center; position: relative; z-index: 10; box-shadow: 0 2px 4px rgba(0,0,0,0.05); min-width: 120px; font-size: 12px; font-weight: 700; letter-spacing: -0.01em; }
    .node-box.root { background: var(--slate-800); color: #fff; border-color: var(--slate-800); font-weight: 800; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
    .node-step { background: #f1f5f9; color: var(--slate-600); border: 1px solid #e2e8f0; font-weight: 700; font-size: 10px; padding: 4px 10px; border-radius: 99px; z-index: 10; white-space: nowrap; text-align: center; text-transform: uppercase; letter-spacing: 0.05em; }
    .node-card { background: #fff; border: 1px solid #e2e8f0; border-top: 3px solid var(--blue-600); border-radius: 8px; text-align: left; width: 160px; padding: 12px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); z-index: 10; position: relative; display: flex; flex-direction: column; }
    .node-card:hover { transform: translateY(-2px); transition: transform 0.2s; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); border-color: var(--blue-600); }
    .node-card h5 { font-weight: 800; font-size: 12px; color: var(--slate-800); line-height: 1.2; margin-bottom: 2px; }
    .node-card .sub { font-size: 9px; font-weight: 700; text-transform: uppercase; color: var(--slate-400); letter-spacing: 0.05em; display:block; margin-bottom:8px; }
    .t-list { list-style: none; padding: 0; margin: 0 0 8px 0; border-bottom: 1px solid #f1f5f9; padding-bottom: 8px; }
    .t-item { display: flex; align-items: start; gap: 6px; font-size: 10px; color: var(--slate-600); margin-bottom: 4px; line-height: 1.3; font-weight: 600; }
    .t-icon { width: 10px; height: 10px; flex-shrink: 0; position: relative; top: 2px; }
    .t-icon.check { color: var(--theme-green); }
    .summary-box { background: #f8fafc; padding: 6px 8px; border-radius: 4px; margin-top: auto; }
    .summary-text { font-size: 9px; line-height: 1.35; color: var(--slate-500); font-weight: 500; }
    .summary-link { font-size: 9px; font-weight: 800; color: var(--blue-600); text-decoration: none; text-transform: uppercase; margin-top: 6px; display: block; }
    .summary-link:hover { text-decoration: underline; }
    .node-connector-text { font-size: 9px; font-weight: 700; color: var(--slate-500); background: #fff; padding: 2px 8px; border: 1px solid #cbd5e1; border-radius: 4px; z-index: 15; position: relative; margin: -10px 0; }
    
    /* --- NEW PROFESSIONAL TIMELINE --- */
    .milestone-track { display: flex; justify-content: space-between; align-items: flex-start; position: relative; width: 100%; padding-top: 10px; margin-top: 10px;}
    .milestone-line { position: absolute; top: 22px; left: 20px; right: 20px; height: 2px; background: #e2e8f0; z-index: 0; }
    .milestone { display: flex; flex-direction: column; align-items: center; text-align: center; position: relative; z-index: 1; width: 16%; cursor: pointer; }
    .milestone-circle { width: 26px; height: 26px; background: #fff; border: 2px solid #94a3b8; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #64748b; margin-bottom: 8px; transition: all 0.3s ease; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    .milestone:hover .milestone-circle { border-color: var(--blue-600); color: var(--blue-600); transform: scale(1.1); box-shadow: 0 4px 10px rgba(42,93,159,0.2); }
    .milestone-icon { width: 14px; height: 14px; }
    .milestone-label { font-size: 9px; font-weight: 800; color: var(--slate-700); line-height: 1.2; text-transform: uppercase; letter-spacing: 0.02em; margin-bottom: 2px; }
    .milestone-q { font-size: 8px; color: var(--slate-500); font-weight: 500; max-width: 90%; line-height: 1.1; }

    /* Mobile Stack */
    @media (max-width: 1024px) {
        .tree-row { flex-direction: column; gap: 10px; position: static; }
        .tree-col, .tree-col::before, .tree-col::after, .connector-down { display: none; }
        .tree-wrapper { display: none; }
        .mobile-tree { display: flex; flex-direction: column; gap: 20px;}
    }
    @media (min-width: 1025px) { .mobile-tree { display: none; } }

  </style>
</head>
<body>

  <div id="main-content" class="transition-all duration-300">
    <header class="w-full max-w-5xl mx-auto mt-4 px-4 relative z-50">
      <nav class="bg-white/90 backdrop-blur-lg card card-accent px-6 py-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-4 flex-shrink-0">
            <div class="brand-left">
              <img src="Logo.png" alt="Vancouver Island Credit logo" class="site-logo"/>
              <div class="brand-stack">
                <a href="#" class="brand-title" aria-label="Home">Vancouver Island Credit</a>
                <div class="powered-by-inline"><span>Powered by</span><img src="Equifax.png" alt="Equifax"/></div>
              </div>
            </div>
          </div>
          
          <div class="hidden md:flex items-center gap-6 font-bold text-slate-600 text-xs mt-1">
              <div class="relative group h-full flex items-center">
                <button class="hover:text-[var(--blue-600)] transition-colors flex items-center gap-1 cursor-pointer py-2">
                    Tools
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
                </button>
                <div class="absolute top-full -left-4 w-48 pt-2 hidden group-hover:block hover:block z-50">
                    <div class="bg-white border border-slate-200 rounded-lg shadow-xl overflow-hidden flex flex-col">
                        <a href="#finance-guide" class="px-4 py-3 hover:bg-slate-50 text-left text-xs border-b border-slate-100 text-slate-700 hover:text-[var(--blue-600)]">Financing Guide</a>
                        <a href="#personalized-search" class="px-4 py-3 hover:bg-slate-50 text-left text-xs text-slate-700 hover:text-[var(--blue-600)]">Personalized Search</a>
                    </div>
                </div>
            </div>
            <a href="#lead-form-card" class="hover:text-[var(--blue-600)] transition-colors">Financing</a>
            <a href="#lead-form-card" class="hover:text-[var(--blue-600)] transition-colors">Refinancing</a>
            <a href="#inventory" class="hover:text-[var(--blue-600)] transition-colors">Inventory</a>
          </div>

          <div class="hidden md:flex items-center gap-5 flex-shrink-0">
            <a href="tel:+12369692424" class="font-bold text-slate-800 text-[13px] hover:text-[var(--blue-600)] transition-colors">(236) 969-2424</a>
            <button type="button" id="navApplyBtn" class="cta-button text-xs shadow-md">Get Started</button>
          </div>
          <button id="menuBtn" class="md:hidden text-slate-700 p-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg>
          </button>
        </div>
        <div id="mobileMenu" class="hidden md:hidden border-t border-slate-200 mt-4 pt-4 space-y-4">
            <div class="grid grid-cols-1 gap-3 text-sm font-bold text-slate-600">
              <a href="#finance-guide" class="block py-2">Financing Guide</a>
              <a href="#personalized-search" class="block py-2">Personalized Search</a>
              <a href="tel:+12369692424" class="block py-2 text-[var(--blue-600)]">(236) 969-2424</a>
            </div>
            <button type="button" id="mobileApplyBtn" class="cta-button w-full justify-center">Get Started</button>
        </div>
      </nav>
    </header>

    <main class="w-full max-w-5xl mx-auto px-4 py-4 space-y-4">
      
      <section id="about" class="px-5 py-6 mb-2">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8 items-center">
          <div>
            <div class="flex items-center gap-4 mb-4">
               <img src="Untitled Project.jpg" alt="Blake Stolth" class="w-14 h-14 rounded-full border-2 border-[var(--blue-600)] object-cover shadow-sm"/>
               <div><h1 class="h1 text-2xl mb-1">See options in 3 Steps</h1><p class="text-[12px] text-slate-500 font-bold uppercase tracking-wide">Personally reviewed by Blake</p></div>
            </div>
            <ol class="space-y-4 mt-2">
              <li class="flex items-start gap-3"><span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-[var(--blue-600)] text-white font-bold text-xs shadow-sm">1</span><span class="text-slate-700 text-sm font-medium pt-0.5"><b>Enter info</b> — Takes 2 minutes</span></li>
              <li class="flex items-start gap-3"><span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-[var(--blue-600)] text-white font-bold text-xs shadow-sm">2</span><span class="text-slate-700 text-sm font-medium pt-0.5"><b>See options</b> you qualify for</span></li>
              <li class="flex items-start gap-3"><span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-[var(--blue-600)] text-white font-bold text-xs shadow-sm">3</span><span class="text-slate-700 text-sm font-medium pt-0.5"><b>Doorstep delivery</b> anywhere in BC</span></li>
            </ol>
          </div>
          <div>
            <h2 class="text-lg font-extrabold text-slate-800 mb-4">Why people pick us</h2>
            <ul class="space-y-3">
              <li class="flex items-start gap-3"><span class="abc-badge shadow-sm">A</span><span class="text-sm text-slate-600 pt-0.5"><b>All credit welcome</b> — Current rates low as 0%</span></li>
              <li class="flex items-start gap-3"><span class="abc-badge shadow-sm">B</span><span class="text-sm text-slate-600 pt-0.5"><b>Biggest Selection</b> — New & Used across BC</span></li>
              <li class="flex items-start gap-3"><span class="abc-badge shadow-sm">C</span><span class="text-sm text-slate-600 pt-0.5"><b>Confidential</b> — No data sold to dealerships</span></li>
              <li class="flex items-start gap-3"><span class="abc-badge shadow-sm">D</span><span class="text-sm text-slate-600 pt-0.5"><b>Delivery</b> — Right to your driveway</span></li>
            </ul>
          </div>
        </div>
      </section>

      <section class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
        <div class="card card-accent p-0 overflow-hidden relative shadow-lg" id="lead-form-card" style="height: 452px;"> 
          <div id="form-spacer" class="js-hidden h-[380px]"></div>
          <div class="form-shell" id="form-shell" style="height: 100%;">
            <div class="form-clipper">
                <div id="form-trigger" class="form-trigger-overlay"></div>
                <div class="form-header">
                  <div class="flex items-center justify-between mb-1.5"><div id="progress-label" class="text-[10px] uppercase tracking-wider font-bold text-slate-500">Step 1</div><div id="progress-endcap" class="text-[10px] font-bold text-[var(--blue-700)]">Start</div></div>
                  <div class="track mt-1.5"><div id="progress-fill" class="fill"></div></div>
                </div>
                <div id="step-viewport" class="step-viewport px-4"><div class="step-viewport-inner">
                    <form id="the-form" name="lead-form" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" action="/thank-you.html" novalidate>
                      <input type="hidden" name="form-name" value="lead-form"/><input type="hidden" name="app_type" id="app_type" value="Full Application" /><input type="hidden" name="appCode" id="appCode" value="" /><input type="hidden" name="intent" id="intent" value="finance" />
                      
                      <section class="form-step" data-id="step-intent"><div class="step-inner"><div class="step-title"><h3 class="h2">Select Goal</h3></div><div class="step-body"><div class="content grid grid-cols-2 gap-3"><button type="button" class="choice-rect" data-intent="finance">Finance</button><button type="button" class="choice-rect" data-intent="refinance">Refinance</button></div></div></div></section>
                      <section class="form-step js-hidden" data-id="step-refi-details"><div class="step-inner"><div class="step-title"><h3 class="h2">Current Loan</h3></div><div class="step-body"><div class="content space-y-3"><div class="grid grid-cols-3 gap-2"><div class="col-span-1"><label class="label">Year</label><select name="refiYear" id="refiYear" class="form-select" required></select></div><div class="col-span-2"><label class="label">Make</label><select name="refiMake" id="refiMake" class="form-select" required></select></div></div><div class="grid grid-cols-1 gap-2"><label class="label">Model</label><select name="refiModel" id="refiModel" class="form-select" required><option value="">Select</option></select></div><div class="grid grid-cols-2 gap-3"><div><label class="label">Years Left</label><select id="refiRemainYears" name="refiRemainYears" class="form-select" required></select></div><div><label class="label">Current Rate %</label><input type="text" id="refiCurrentRate" name="refiCurrentRate" class="form-input" placeholder="e.g., 9.49" inputmode="decimal" maxlength="6" required/></div></div></div></div></div></section>
                      <section class="form-step js-hidden" data-id="step-vehicle-type"><div class="step-inner"><div class="step-title"><h3 class="h2">Vehicle Type</h3></div><div class="step-body"><div class="content grid grid-cols-2 gap-3"><button type="button" class="choice-rect" data-type="Car">Car</button><button type="button" class="choice-rect" data-type="SUV">SUV</button><button type="button" class="choice-rect" data-type="Truck">Truck</button><button type="button" class="choice-rect" data-type="Van">Van</button><input type="hidden" name="vehicleType" id="vehicleType"></div></div></div></section>
                      <section class="form-step js-hidden" data-id="step-budget"><div class="step-inner"><div class="step-title"><h3 class="h2">Target Budget</h3></div><div class="step-body"><div class="content"><div class="bg-slate-50 p-4 rounded-lg border border-slate-200 mb-4 text-center"><p class="label mb-2">Estimated Bi-Weekly Payment</p><div class="text-3xl font-extrabold text-[var(--blue-600)]">$<span id="biWeeklyOut">250</span></div></div><input type="range" id="biWeeklyRange" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-[var(--blue-600)] mb-2" min="100" max="600" step="10" value="250"><div class="flex justify-between text-[10px] text-slate-500 font-bold uppercase"><span>Economy</span><span>Premium</span></div><input type="hidden" name="budgetRange" id="budgetRange"></div></div></div></section>
                      <section class="form-step js-hidden" data-id="step-purchase"><div class="step-inner"><div class="step-title"><h3 class="h2">Purchase Details</h3></div><div class="step-body"><div class="content space-y-4"><div><label class="label">Down Payment</label><select id="downPayment" name="downPayment" class="form-select"><option value="">Select amount…</option><option value="$3,000+">$3,000+</option><option value="$1,000–$3,000">$1,000–$3,000</option><option value="$0–$1,000">$0–$1,000</option></select></div><div><label class="label">Do you have a trade-in?</label><div class="grid-inline-2"><button type="button" class="choice-rect" data-trade="No">No</button><button type="button" class="choice-rect" data-trade="Yes">Yes</button></div><input type="hidden" name="hasTradeIn" id="hasTradeIn" value="No"></div></div></div></div></section>
                      <section class="form-step js-hidden" data-id="step-tradein"><div class="step-inner"><div class="step-title"><h3 class="h2">Trade-in Vehicle</h3></div><div class="step-body"><div class="content space-y-3"><div class="grid grid-cols-3 gap-2"><div class="col-span-1"><label class="label">Year</label><select name="tradeInYear" id="tradeInYear" class="form-select"></select></div><div class="col-span-2"><label class="label">Make</label><select name="tradeInMake" id="tradeInMake" class="form-select"></select></div></div><div class="grid grid-cols-1 gap-2"><label class="label">Model</label><select name="tradeInModel" id="tradeInModel" class="form-select"><option value="">Select</option></select></div><div class="grid grid-cols-2 gap-3"><div><label class="label">Kilometres</label><input type="number" name="tradeInKms" id="tradeInKms" class="form-input" inputmode="numeric"/></div><div><label class="label">Lien Amount</label><input type="text" id="tradeInOwed" name="tradeInOwed" placeholder="e.g. $5,000" class="form-input"/></div></div></div></div></div></section>
                      <section class="form-step js-hidden" data-id="step-income"><div class="step-inner"><div class="step-title"><h3 class="h2">Income Details</h3></div><div class="step-body"><div class="content space-y-3"><div class="space-y-1"><label class="label">Employment Type</label><select id="incomeSourceFull" name="incomeSourceFull" class="form-select" required><option value="">Select…</option><option value="Full-Time">Full-Time</option><option value="Part-Time">Part-Time</option><option value="Self-Employed">Self-Employed</option><option value="Disability">Disability</option><option value="Other">Other</option></select></div><div class="space-y-1"><label class="label">Monthly Income (Gross)</label><input type="text" id="avgMonthlyIncome" name="avgMonthlyIncome" class="form-input text-center font-bold text-lg" placeholder="$4,000" required></div></div></div></div></section>
                      <section class="form-step js-hidden" data-id="step-yourinfo"><div class="step-inner"><div class="step-title"><h3 class="h2">Contact Info</h3></div><div class="step-body"><div class="content space-y-3"><div class="grid grid-cols-2 gap-3"><input type="text" name="firstName" class="form-input" placeholder="First Name" required><input type="text" name="lastName" class="form-input" placeholder="Last Name" required></div><div class="grid grid-cols-4 gap-2"><div class="col-span-1"><label class="label">Year</label><select id="dobYear" name="dobYear" class="form-select px-1 text-center" required></select></div><div class="col-span-1"><label class="label">Month</label><select id="dobMonth" name="dobMonth" class="form-select px-1 text-center" required><option value="">MM</option></select></div><div class="col-span-1"><label class="label">Day</label><select id="dobDay" name="dobDay" class="form-select px-1 text-center" required><option value="">DD</option></select></div><div class="col-span-1"><label class="label">Status</label><select id="maritalStatus" name="maritalStatus" class="form-select px-1 text-[11px]" required><option value="">Select</option><option>Single</option><option>Married</option><option>Common-Law</option><option>Divorced</option></select></div></div><div class="grid grid-cols-2 gap-3"><input type="tel" id="phone" name="phone" class="form-input" placeholder="(555) 555-5555" required><input type="email" id="email" name="email" class="form-input" placeholder="Email Address" required></div></div></div></div></section>
                      <section class="form-step js-hidden" data-id="step-address"><div class="step-inner"><div class="step-title"><h3 class="h2">Current Address</h3></div><div class="step-body"><div class="content space-y-3"><div class="grid grid-cols-3 gap-2"><div class="col-span-2"><input type="text" name="streetAddress" class="form-input" placeholder="Street Address" required></div><div class="col-span-1"><input type="text" name="unitNumber" class="form-input" placeholder="Unit #"></div></div><div class="grid grid-cols-3 gap-2"><div class="col-span-1"><input type="text" name="city" class="form-input" placeholder="City" required></div><div class="col-span-1"><select id="currentProvince" name="currentProvince" class="form-select" required></select></div><div class="col-span-1"><input type="text" name="postalCode" class="form-input" placeholder="Postal" required></div></div><div class="grid grid-cols-2 gap-2"><div class="seg" role="group"><button type="button" id="btnRent" class="seg-btn" aria-pressed="true">Rent</button><button type="button" id="btnOwn" class="seg-btn" aria-pressed="false">Own</button><input type="hidden" name="housingType" id="housingType" value="Rent"></div><input type="text" id="housingPayment" name="housingPayment" class="form-input" placeholder="Pmt ($)" required></div><div class="grid grid-cols-2 gap-2"><div><select id="timeAtAddressYears" name="timeAtAddressYears" class="form-select"><option value="">Years at Addr.</option></select></div><div><select id="timeAtAddressMonths" name="timeAtAddressMonths" class="form-select"><option value="">Months</option></select></div></div></div></div></div></section>
                      <section class="form-step js-hidden" data-id="step-employer"><div class="step-inner"><div class="step-title"><h3 class="h2">Work History</h3></div><div class="step-body"><div class="content space-y-3"><input type="text" name="employerName" class="form-input" placeholder="Employer Name" required><input type="text" name="jobTitle" class="form-input" placeholder="Job Title" required><div class="grid grid-cols-2 gap-3"><select id="timeWithEmployerYears" name="timeWithEmployerYears" class="form-select" required><option value="">Years</option></select><select id="timeWithEmployerMonths" name="timeWithEmployerMonths" class="form-select" required><option value="">Months</option></select></div><div class="grid-inline-2"><input id="otherIncomeSource" name="otherIncomeSource" class="form-input" placeholder="Other Income Source"/><input type="text" id="otherIncomeAmount" name="otherIncomeAmount" class="form-input" placeholder="Amount ($)"/></div><label class="flex items-start gap-3 mt-2 p-3 border border-slate-200 rounded-lg bg-slate-50 cursor-pointer hover:bg-white transition-colors"><input type="checkbox" name="creditConsent" id="creditConsent" class="mt-1 accent-[var(--blue-600)]" checked required><span class="text-[11px] text-slate-600 leading-snug text-left">I confirm I am the person named above and consent to Vancouver Island Credit obtaining credit reports. (VSA #41114)</span></label></div></div></div></section>
                      <section class="form-step js-hidden" data-id="step-consent"><div class="step-inner"><div class="step-title"><h3 class="h2">Final Step</h3></div><div class="step-body"><div class="content space-y-4 text-center"><div class="p-4 bg-slate-50 rounded border border-slate-200"><p class="text-xs text-slate-600 mb-2">Clicking "Submit Application" finalizes your secure request.</p><p class="text-[10px] text-slate-400">Your data is secured with 256-bit encryption and is never sold to third-party marketing lists.</p></div></div></div></div></section>
                    </form>
                </div></div>
                <div class="form-footer flex items-center justify-between" id="form-footer"><button type="button" id="btnBack" class="font-semibold text-slate-600 hover:text-slate-900 px-4 py-2 rounded-lg hover:bg-slate-100 transition-colors">Back</button><button type="button" id="btnNext" class="cta-button">Next</button></div>
            </div> 
            <button id="form-close" class="form-close-btn hidden" aria-label="Close form"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg></button>
          </div>
        </div>
        
        <aside class="flex flex-col h-full w-full">
            <div class="calc-box">
              <div class="calc-header">
                <div>
                  <h4>Refinance Calculator</h4>
                  <p>Estimate Potential Savings</p>
                </div>
                <div class="text-white">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" /></svg>
                </div>
              </div>

              <div class="calc-display-hero">
                <div class="save-label">Est. Total Savings</div>
                <div class="save-amount" id="refTotalSave">$0.00</div>
                <div class="save-sub">Interest Saved Over Term</div>
              </div>

              <div class="calc-inputs">
                <div class="grid grid-cols-2 gap-3">
                  <div class="bold-input-group">
                    <label class="bold-label">Balance</label>
                    <input type="text" id="refLoanInput" class="bold-input" placeholder="15,000" inputmode="numeric">
                  </div>
                  <div class="bold-input-group">
                    <label class="bold-label">Cur. Rate %</label>
                    <input type="text" id="refRateInput" class="bold-input" placeholder="8.99" inputmode="decimal">
                  </div>
                </div>

                <div class="space-y-3">
                  <div>
                    <div class="flex justify-between mb-1">
                      <span class="text-[10px] font-bold text-slate-500 uppercase">New Rate Target</span>
                      <span class="text-[11px] font-bold text-[var(--blue-600)]"><span id="refNewRateOut">7.99</span>%</span>
                    </div>
                    <input id="refNewRateSlider" type="range" min="0.00" max="12.99" step="0.05" value="7.99" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-[var(--blue-600)]">
                  </div>
                  
                  <div>
                    <div class="flex justify-between mb-1">
                      <span class="text-[10px] font-bold text-slate-500 uppercase">New Term</span>
                      <span class="text-[11px] font-bold text-slate-800"><span id="termDisplay">5</span> Years</span>
                    </div>
                    <input id="refTermInput" type="range" min="1" max="8" step="1" value="5" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-[var(--blue-600)]">
                  </div>
                </div>

                <div class="flex justify-between items-center bg-slate-50 p-2 rounded-lg border border-slate-200 mt-1">
                  <span class="text-[10px] font-bold text-slate-500 uppercase">New Payment</span>
                  <div class="text-slate-800 font-black text-xl" id="refNewPmtOut">$0.00<span class="text-[10px] text-slate-400 font-medium ml-1">/bi-w</span></div>
                </div>
              </div>
            </div>
            </aside>
      </section>
    </main> <section id="finance-guide" class="wide-section-container mt-12 mb-12">
        <div class="text-center mb-8">
            <h2 class="h1 text-3xl text-slate-800 mb-2">Finance Guide</h2>
            <p class="text-base text-slate-500 font-medium">Find your path below. Each stage requires specific questions for a secure approval.</p>
        </div>

        <div class="wide-section-container">
            <div class="desktop-tree tree-wrapper">
                <div class="tree-row">
                    <div class="tree-col only-child">
                        <div class="node-box root">Start Here</div>
                        <div class="connector-down"></div>
                    </div>
                </div>

                <div class="tree-row">
                    <div class="tree-col">
                        <div class="node-box">No Trade-In</div>
                        <div class="connector-down"></div>
                        <div class="tree-row">
                            <div class="tree-col">
                                <div class="node-step">Good Credit</div>
                                <div class="connector-down"></div>
                                <div class="node-card">
                                    <span class="sub">660 - 900 Score</span>
                                    <h5>Unlimited Access</h5>
                                    <ul class="t-list">
                                        <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Any Make/Model</li>
                                        <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Lowest Fixed Rates</li>
                                        <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Longest Terms</li>
                                    </ul>
                                    <div class="summary-box">
                                        <p class="summary-text">Financing is available for most vehicles. This is where figuring out what option is best for where you are in life.</p>
                                        <a href="#personalized-search" class="summary-link">See Personalized Search</a>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="tree-col">
                                <div class="node-step">Rebuilding</div>
                                <div class="connector-down"></div>
                                <div class="node-card">
                                    <span class="sub">300 - 659 Score</span>
                                    <h5>Reliability Focus</h5>
                                    <ul class="t-list">
                                        <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>2016+ Vehicles</li>
                                        <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Refinance in 12mo</li>
                                    </ul>
                                    <div class="summary-box">
                                        <p class="summary-text">Limited availability on financing options. Approvals have higher rates, so picking the right vehicle is crucial.</p>
                                    </div>
                                </div>
                                <div class="connector-down" style="height:20px;"></div>
                                <div class="node-connector-text">Income Over $2200/mo?</div>
                                <div class="connector-down" style="height:20px;"></div>
                                <div class="node-card">
                                    <span class="sub">Unlimited Access</span>
                                    <h5>Special Program</h5>
                                    <ul class="t-list">
                                        <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Any Make/Model</li>
                                        <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Access to Lowest</li>
                                    </ul>
                                    <div class="summary-box">
                                        <p class="summary-text">Best case scenario for a person with new/low credit as it gives you access to regular rates.</p>
                                        <a href="#personalized-search" class="summary-link">See Personalized Search</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="tree-col">
                        <div class="node-box">With Trade-In</div>
                        <div class="connector-down"></div>
                        <div class="tree-row">
                            <div class="tree-col">
                                <div class="node-step">Good Credit</div>
                                <div class="connector-down"></div>
                                <div class="tree-row">
                                    <div class="tree-col">
                                        <div class="node-step">Positive Equity</div>
                                        <div class="connector-down"></div>
                                        <div class="node-card">
                                            <span class="sub">660 - 900 Score</span>
                                            <h5>Unlimited Access</h5>
                                            <ul class="t-list">
                                                <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Any Make/Model</li>
                                                <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Lowest Fixed Rates</li>
                                            </ul>
                                            <div class="summary-box">
                                                <p class="summary-text">Financing is available for most vehicles. This is where getting/retaining the most value matters.</p>
                                                <a href="#personalized-search" class="summary-link">See Personalized Search</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tree-col">
                                        <div class="node-step">Negative Equity</div>
                                        <div class="connector-down"></div>
                                        <div class="node-card">
                                            <span class="sub">Reliability Focus</span>
                                            <h5>Negative Equity Fix</h5>
                                            <ul class="t-list">
                                                <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>2016+ Vehicles</li>
                                                <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Refinance 12mo</li>
                                            </ul>
                                            <div class="summary-box">
                                                <p class="summary-text">Financing is available. This is where it is important to know where you stand to see if the change makes sense.</p>
                                                <a href="#personalized-search" class="summary-link">See Personalized Search</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="tree-col">
                                <div class="node-step">Rebuilding</div>
                                <div class="connector-down"></div>
                                <div class="tree-row">
                                    <div class="tree-col">
                                        <div class="node-step">Positive Equity</div>
                                        <div class="connector-down"></div>
                                        <div class="node-card">
                                            <span class="sub">660 - 900 Score</span>
                                            <h5>Unlimited Access</h5>
                                            <ul class="t-list">
                                                <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Any Make/Model</li>
                                                <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Lowest Rates</li>
                                            </ul>
                                            <div class="summary-box">
                                                <p class="summary-text">Financing is limited. Important to know where you stand to see if the change makes sense.</p>
                                                <a href="#personalized-search" class="summary-link">See Personalized Search</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="connector-down" style="height:20px;"></div>
                                    <div class="node-connector-text">Income Over $2200/mo?</div>
                                    <div class="connector-down" style="height:20px;"></div>
                                    <div class="node-card">
                                        <span class="sub">Unlimited Access</span>
                                        <h5>Special Program</h5>
                                        <ul class="t-list">
                                            <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Any Make/Model</li>
                                            <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Access to Lowest</li>
                                        </ul>
                                        <div class="summary-box">
                                            <p class="summary-text">Best case scenario for a person with new/low credit as it gives you access to regular rates while improving vehicle situation.</p>
                                            <a href="#personalized-search" class="summary-link">See Personalized Search</a>
                                        </div>
                                    </div>
                                    
                                    <div class="tree-col">
                                        <div class="node-step">Negative Equity</div>
                                        <div class="connector-down"></div>
                                        <div class="node-card">
                                            <span class="sub">Reliability Focus</span>
                                            <h5>Negative Equity Fix</h5>
                                            <ul class="t-list">
                                                <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>2016+ Vehicles</li>
                                                <li class="t-item"><svg class="t-icon check" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Refinance 12mo</li>
                                            </ul>
                                            <div class="summary-box">
                                                <p class="summary-text">This is where it is important to know where you stand to see if the vehicle change makes sense.</p>
                                                <a href="#personalized-search" class="summary-link">See Personalized Search</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mobile-tree"><div class="node-box root w-full">Tap branches to expand (Mobile View Simplified)</div></div>
        </div>
    </section>

    <main class="w-full max-w-5xl mx-auto px-4 py-4 space-y-4">
      <section id="personalized-search" class="mt-8 mb-8">
        <div class="flex flex-col md:flex-row gap-10 items-start">
            <div class="flex-1">
                <h2 class="h1 text-3xl text-slate-800 mb-4 tracking-tight">Personalized Search</h2>
                <p class="text-base text-slate-600 leading-relaxed mb-6">Buying a vehicle is typically the second biggest purchase people make. It's crucial you make the right decision. We work with you to see where you are at in life, what you qualify for, and help you find the right vehicle for the situation.</p>
                
                <div class="flex items-center gap-6 mb-8">
                    <div class="h-12 w-12 bg-white rounded-full flex items-center justify-center text-[var(--blue-600)] shadow-sm border border-slate-200 flex-shrink-0">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    </div>
                    <div>
                        <div class="flex text-yellow-400 gap-1 mb-1">
                            <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                            <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                            <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                            <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                            <svg class="w-5 h-5 fill-current" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        </div>
                        <p class="text-sm font-extrabold text-slate-800">5,000+ Verified Reviews</p>
                        <p class="text-[11px] text-slate-500 font-medium">Top Rated in BC on Google</p>
                    </div>
                </div>
                
                <div class="timeline-wrapper bg-white rounded-xl shadow-sm border border-slate-100 p-6">
                    <div class="milestone-track">
                        <div class="milestone-line"></div>
                        <div class="milestone">
                            <div class="milestone-circle"><svg class="milestone-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg></div>
                            <span class="milestone-label">Eligibility</span>
                            <span class="milestone-q">First Car?</span>
                        </div>
                        <div class="milestone">
                            <div class="milestone-circle"><svg class="milestone-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></div>
                            <span class="milestone-label">Newcomer</span>
                            <span class="milestone-q">No Credit?</span>
                        </div>
                        <div class="milestone">
                            <div class="milestone-circle"><svg class="milestone-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" /></svg></div>
                            <span class="milestone-label">Growth</span>
                            <span class="milestone-q">Safety?</span>
                        </div>
                        <div class="milestone">
                            <div class="milestone-circle"><svg class="milestone-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" /></svg></div>
                            <span class="milestone-label">Rebuild</span>
                            <span class="milestone-q">Repair?</span>
                        </div>
                        <div class="milestone">
                            <div class="milestone-circle"><svg class="milestone-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" /></svg></div>
                            <span class="milestone-label">Family</span>
                            <span class="milestone-q">Upgrade?</span>
                        </div>
                        <div class="milestone">
                            <div class="milestone-circle"><svg class="milestone-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" /></svg></div>
                            <span class="milestone-label">Retire</span>
                            <span class="milestone-q">Income?</span>
                        </div>
                    </div>
                </div>
                
                <button type="button" class="cta-button w-full md:w-auto justify-center mt-6 shadow-lg shadow-blue-900/20" onclick="document.getElementById('lead-form-card').scrollIntoView({behavior: 'smooth'});">Start A Custom Search</button>
            </div>
            
            <div class="flex-1 w-full">
                <h3 class="h2 mb-4 text-slate-800">Used Vehicle Tips</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-lg transition-all duration-300 relative group overflow-hidden">
                        <div class="flex items-center gap-3 mb-2 relative z-10">
                            <div class="h-10 w-10 rounded-lg bg-blue-50 text-[var(--blue-600)] flex items-center justify-center shadow-sm">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" /></svg>
                            </div>
                            <h4 class="text-sm font-extrabold text-slate-800 uppercase tracking-tight">Service History</h4>
                        </div>
                        <p class="text-xs text-slate-500 font-medium leading-relaxed relative z-10">The #1 factor. We verify oil change intervals and shop reports to ensure long-term reliability.</p>
                    </div>

                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-lg transition-all duration-300 relative group overflow-hidden">
                        <div class="flex items-center gap-3 mb-2 relative z-10">
                            <div class="h-10 w-10 rounded-lg bg-blue-50 text-[var(--blue-600)] flex items-center justify-center shadow-sm">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                            </div>
                            <h4 class="text-sm font-extrabold text-slate-800 uppercase tracking-tight">Clean Titles</h4>
                        </div>
                        <p class="text-xs text-slate-500 font-medium leading-relaxed relative z-10">Crucial in BC. We guarantee clean titles with zero hidden debts, liens, or legal headaches.</p>
                    </div>

                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-lg transition-all duration-300 relative group overflow-hidden">
                        <div class="flex items-center gap-3 mb-2 relative z-10">
                            <div class="h-10 w-10 rounded-lg bg-blue-50 text-[var(--blue-600)] flex items-center justify-center shadow-sm">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>
                            </div>
                            <h4 class="text-sm font-extrabold text-slate-800 uppercase tracking-tight">Rust & Body</h4>
                        </div>
                        <p class="text-xs text-slate-500 font-medium leading-relaxed relative z-10">We check for Eastern cars (salt damage) and "Headliner" status—a true sign of neglect.</p>
                    </div>

                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm hover:shadow-lg transition-all duration-300 relative group overflow-hidden">
                        <div class="flex items-center gap-3 mb-2 relative z-10">
                            <div class="h-10 w-10 rounded-lg bg-blue-50 text-[var(--blue-600)] flex items-center justify-center shadow-sm">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" /></svg>
                            </div>
                            <h4 class="text-sm font-extrabold text-slate-800 uppercase tracking-tight">Model Specifics</h4>
                        </div>
                        <p class="text-xs text-slate-500 font-medium leading-relaxed relative z-10">We avoid specific "Bad Years." Dodging known transmission and engine issues saves you thousands.</p>
                    </div>
                </div>
            </div>
        </div>
      </section>

      <section id="inventory" class="card card-accent p-5">
        <div class="flex items-center justify-between mb-3"><h3 class="h2">Browse Inventory</h3><a href="#lead-form" class="text-xs font-bold uppercase tracking-wide text-[var(--blue-600)] hover:underline js-view-inventory">View All (<span id="inv-total">1571</span>)</a></div>
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Coupe.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">Coupe <span class="text-slate-400 font-normal">(168)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Hatchback.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">Hatchback <span class="text-slate-400 font-normal">(138)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Electric.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">EV / Hybrid <span class="text-slate-400 font-normal">(421)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Sedan.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">Sedan <span class="text-slate-400 font-normal">(349)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Crossover.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">Crossover <span class="text-slate-400 font-normal">(307)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Suv.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">SUV <span class="text-slate-400 font-normal">(486)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Van.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">Van <span class="text-slate-400 font-normal">(102)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Truck.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">Truck <span class="text-slate-400 font-normal">(86)</span></p></div></a>
        </div>
      </section>

      <section id="map" class="card card-accent p-0 mt-6 overflow-hidden">
        <div class="p-4"><h3 class="h2">Head Office — Victoria, BC</h3><p class="text-xs text-slate-600 mt-1">Real location. Real people.</p></div>
        <iframe class="map-embed" title="Map — Vancouver Island Credit" loading="lazy" referrerpolicy="no-referrer-when-downgrade" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2647.612610356825!2d-123.3816246843408!3d48.44991197924958!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x548f73877c401593!2s525%20Gorge%20Rd%20E%2C%20Victoria%2C%20BC%20V8T%202W5!5e0!3m2!1sen!2sca!4v1677000000000!5m2!1sen!2sca"></iframe>
        <div class="px-4 py-3 text-xs text-slate-600 border-t border-slate-200">525 Gorge Rd E, Victoria, BC V8T 4T2</div>
      </section>

      <footer id="contact" class="text-center text-xs text-slate-500 pt-2 space-y-1.5">
        <div class="flex justify-center gap-4 text-xs text-slate-400 mb-2 underline"><a href="/privacy-policy.html" target="_blank">Privacy Policy</a><a href="/terms.html" target="_blank">Terms of Service</a></div>
        <p class="font-bold text-slate-600">Vancouver Island Credit</p>
        <p>525 Gorge Rd E, Victoria, BC V8T 4T2</p>
        <p><a href="tel:+1-236-969-2424" class="hover:text-[var(--blue-600)] transition-colors">Customer service: (236) 969-2424</a></p>
        <p class="pt-1">Serving Vancouver Island & British Columbia • Delivery available province-wide</p>
        <p class="mt-2 text-slate-400">© <span id="year"></span> Vancouver Island Credit • All rights reserved • <span class="block sm:inline">VSA Dealer #41114</span></p>
      </footer>
    </main>

    <div id="form-backdrop" class="form-backdrop"></div>
  </div>

  <div id="progress-overlay" class="progress-overlay hidden" aria-hidden="true"><div class="progress-card"><div class="progress-title">Working on it…</div><div class="progress-track"><div id="progress-bar" class="progress-bar"></div></div><ul id="progress-steps" class="progress-steps"><li class="active">Submitting your application…</li><li>Verifying your information…</li><li>Finding the best options…</li></ul><p class="progress-note">Secure & encrypted. We never share or sell your info.</p></div></div>
  <script>
  const vehicleData={Acura:["ILX","MDX","RDX","TLX","Integra","ZDX"],Audi:["A3","A4","A5","A6","Q3","Q5","Q7","e-tron"],BMW:["3 Series","5 Series","X1","X3","X5","i4","iX"],Chevrolet:["Equinox","Malibu","Silverado","Traverse","Tahoe"],Chrysler:["Pacifica","300"],Dodge:["Challenger","Charger","Durango","Grand Caravan"],Ford:["Escape","Explorer","F-150","Mustang","Edge","Ranger"],GMC:["Acadia","Sierra","Terrain","Yukon"],Honda:["Accord","Civic","CR-V","HR-V","Odyssey","Pilot"],Hyundai:["Elantra","Kona","Santa Fe","Sonata","Tucson","Palisade"],Jeep:["Cherokee","Grand Cherokee","Wrangler","Compass","Renegade"],Kia:["Forte","Sorento","Soul","Sportage","Telluride","K5"],Lexus:["ES","IS","NX","RX","UX"],Mazda:["Mazda3","Mazda6","CX-30","CX-5","CX-9"],MercedesBenz:["C-Class","E-Class","GLA","GLC","GLE","S-Class"],Nissan:["Altima","Kicks","Murano","Rogue","Sentra","Titan","Qashqai"],Subaru:["Crosstrek","Forester","Impreza","Outback","Ascent","WRX"],Toyota:["Camry","Corolla","RAV4","Tacoma","Sienna","Highlander","Tundra"],Volkswagen:["Golf","Jetta","Passat","Tiguan","Atlas","ID.4"],Volvo:["S60","S90","XC40","XC60","XC90"]};
  const $=(id)=>document.getElementById(id);const bySel=(s,root=document)=>root.querySelector(s);const bySelAll=(s,root=document)=>Array.from(root.querySelectorAll(s));
  function fmtMoney(x){x=isFinite(x)?x:0;return"$"+x.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}
  function parseMoneyInput(v){if(!v)return 0;return parseFloat(String(v).replace(/[^0-9.]/g,''))||0}
  function formatMoneyField(input){const num=parseMoneyInput(input.value);input.value=num>0?num.toLocaleString('en-CA',{style:'currency',currency:'CAD',maximumFractionDigits:0}):''}
  function calcPayment(P,annualRate,years){const r=(annualRate/100)/12;const n=years*12;if(!n||n<=0)return 0;if(P<=0)return 0;if(r===0)return P/n;return P*r/(1-Math.pow(1+r,-n))}
   
  // MERGED HELPERS FROM OLD CODE
  function populateMakes(makeSelectId,modelSelectId){const makeSelect=$(makeSelectId);if(!makeSelect)return;makeSelect.innerHTML='<option value="" selected>Make</option>';const makes=Object.keys(vehicleData).sort();makes.forEach(make=>{const option=document.createElement('option');option.value=make;option.textContent=make;makeSelect.appendChild(option)});makeSelect.addEventListener('change',()=>updateModels(makeSelectId,modelSelectId))}
  function updateModels(makeSelectId,modelSelectId){const makeSelect=$(makeSelectId);const modelSelect=$(modelSelectId);if(!modelSelect)return;const selectedMake=makeSelect.value;modelSelect.innerHTML='';modelSelect.disabled=true;if(selectedMake&&vehicleData[selectedMake]){const models=vehicleData[selectedMake].sort();modelSelect.innerHTML='<option value="" selected>Select</option>';models.forEach(model=>{const option=document.createElement('option');option.value=model;option.textContent=model;modelSelect.appendChild(option)});modelSelect.disabled=false}else{modelSelect.innerHTML='<option value="" selected>Select Make First</option>'}}
  function populateRefiYearsLeft(sel){if(!sel)return;sel.innerHTML='<option value="" selected>Select</option>';for(let i=1;i<=8;i++){const option=document.createElement('option');option.value=i;option.textContent=i;sel.appendChild(option)}}
  function populateYears(sel,start,end){if(!sel)return;sel.innerHTML='<option value="">Year</option>';for(let i=start;i>=end;i--){const opt=document.createElement('option');opt.value=i;opt.textContent=i;sel.appendChild(opt)}}
  function populateDOBYears(sel){if(!sel)return;const cur=new Date().getFullYear();sel.innerHTML='<option value="">Year</option>';for(let i=cur-16;i>=cur-90;i--){const opt=document.createElement('option');opt.value=i;opt.textContent=i;sel.appendChild(opt)}}
  function populateMonths(sel){if(!sel)return;const months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];sel.innerHTML='<option value="">MM</option>';months.forEach((m,i)=>{const opt=document.createElement('option');opt.value=i+1;opt.textContent=m;sel.appendChild(opt)})}
  function updateDays(){const y=parseInt($('dobYear')?.value);const m=parseInt($('dobMonth')?.value);const dSel=$('dobDay');if(!y||!m||!dSel)return;const daysInMonth=new Date(y,m,0).getDate();dSel.innerHTML='<option value="">DD</option>';for(let i=1;i<=daysInMonth;i++){const opt=document.createElement('option');opt.value=i;opt.textContent=i;dSel.appendChild(opt)}}
  function populateDropdown(sel,min,max,label,suffix){if(!sel)return;sel.innerHTML=`<option value="">${label}</option>`;for(let i=min;i<=max;i++){const opt=document.createElement('option');opt.value=i;opt.textContent=i+(suffix?` ${suffix}`:'');sel.appendChild(opt)}}
  function populateProvinces(sel){if(!sel)return;const provs=["AB","BC","MB","NB","NL","NS","NT","NU","ON","PE","QC","SK","YT"];sel.innerHTML='<option value="">Prov</option>';provs.forEach(p=>{const opt=document.createElement('option');opt.value=p;opt.textContent=p;if(p==="BC")opt.selected=true;sel.appendChild(opt)})}

  document.addEventListener('DOMContentLoaded',function(){$('menuBtn')?.addEventListener('click',()=>$('mobileMenu')?.classList.toggle('hidden'));const stepsMap={};bySelAll('.form-step').forEach(sec=>stepsMap[sec.getAttribute('data-id')]=sec);
   
  function currentFlow(){const intent=$('intent')?.value||'finance';const hasTrade=($('hasTradeIn')?.value||'No').toLowerCase()==='yes';
  // REFI FLOW
  if(intent==='refinance'){return['step-intent','step-refi-details','step-income','step-yourinfo','step-address','step-employer','step-consent']}
  // PURCHASE FLOW
  let flow=['step-intent','step-vehicle-type','step-budget','step-purchase'];
  if(hasTrade)flow.push('step-tradein');
  flow=flow.concat(['step-income','step-yourinfo','step-address','step-employer','step-consent']);return flow}

  function showOnly(id){Object.values(stepsMap).forEach(sec=>sec.classList.add('js-hidden'));stepsMap[id]?.classList.remove('js-hidden')}
  function updateProgress(curId){const flow=currentFlow();const i=Math.max(0,flow.indexOf(curId));const visible=flow.filter(x=>x!=='step-consent');const total=visible.length;const stepNumber=Math.min(i+1,total);const pct=Math.round((i)/(Math.max(1,total-1))*100);$('btnBack').disabled=(i===0);$('btnNext').textContent=(i>=total-1)?'Submit Application':'Next';bySel('#progress-label').textContent='Step '+stepNumber+' of '+total;bySel('#progress-fill').style.width=(total>1?pct:0)+'%';const endcap=bySel('#progress-endcap');if(i>0)endcap.textContent="See Options";else endcap.textContent="Start"}
  let curStepId='step-intent';function goTo(id){curStepId=id;showOnly(id);updateProgress(id)}
   
  function validateCurrent(stepId){const stepEl=stepsMap[stepId];if(!stepEl)return true;
  if(stepId==='step-intent'){const v=$('intent').value;const ok=(v==='finance'||v==='refinance');bySelAll('[data-intent]').forEach(x=>x.classList.toggle('err',!ok));return ok}
  if(stepId==='step-vehicle-type'){const ok=!!$('vehicleType').value;bySelAll('[data-type]').forEach(x=>x.classList.toggle('err',!ok));return ok}
  if(stepId==='step-budget'){return!!$('budgetRange').value}
   
  let ok=true;let firstError=null;const fields=Array.from(stepEl.querySelectorAll('[required]'));
  fields.forEach(el=>{if(window.getComputedStyle(el).display==='none'||!el.closest('.form-step')||el.closest('.form-step').classList.contains('js-hidden'))return;let pass=(el.type==='checkbox')?el.checked:(el.value&&el.value.trim()!=='');if(el.id==='phone')pass=el.value.replace(/\D/g,'').length>=10;if(el.type==='email'||el.id==='email'){const v=el.value.trim();pass=pass&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v)}if(!pass){el.classList.add('err');if(!firstError)firstError=el}else{el.classList.remove('err')}const lab=el.closest('div')?.querySelector('label');lab?.classList.toggle('err-label',!pass);if(!pass)ok=false});if(firstError){firstError.scrollIntoView({behavior:'smooth',block:'center'});firstError.focus({preventScroll:true})}return ok}
  function handleNavigation(delta){const flow=currentFlow();let i=flow.indexOf(curStepId);if(i<0)i=0;if(delta>0&&!validateCurrent(curStepId))return;i+=delta;const visible=flow.filter(x=>x!=='step-consent');const lastIdx=visible.length-1;if(delta>0&&i>lastIdx){setTimeout(submitForm,200)}else if(i>=0){const delay=(delta>0)?200:0;setTimeout(()=>{goTo(visible[i])},delay)}else{goTo(visible[0])}}
  $('btnNext')?.addEventListener('click',()=>handleNavigation(1));$('btnBack')?.addEventListener('click',()=>handleNavigation(-1));
    
  // INTENT LOGIC
  bySelAll('[data-intent]').forEach(btn=>{btn.addEventListener('click',()=>{
      bySelAll('[data-intent]').forEach(x=>x.classList.remove('selected','err'));
      btn.classList.add('selected');
      const val = btn.dataset.intent;
      $('intent').value = val;
      const targetStep=(val==='refinance')?currentFlow()[1]:'step-vehicle-type';
      setTimeout(()=>{goTo(targetStep)},200)
  })});

  // REAL TIME CALC LOGIC
  const refLoanInput = $('refLoanInput');
  const refTermInput = $('refTermInput');
  const refNewRateSlider = $('refNewRateSlider');
  const refRateInput = $('refRateInput');
  const refTotalSave = $('refTotalSave');
  const refNewPmtOut = $('refNewPmtOut');
  const termDisplay = $('termDisplay');
  const refNewRateOut = $('refNewRateOut');

  function calculateRefi() {
        if (!refLoanInput || !refTermInput || !refNewRateSlider || !refRateInput) return;
        const balance = parseMoneyInput(refLoanInput.value);
        const currentRate = parseFloat(refRateInput.value) || 0;
        const newRate = parseFloat(refNewRateSlider.value) || 7.99;
        const years = parseInt(refTermInput.value) || 5;
        termDisplay.textContent = years;
        refNewRateOut.textContent = newRate.toFixed(2);
        if (balance > 0) {
            const newPayment = calcPayment(balance, newRate, years) * 12 / 26;
            refNewPmtOut.innerHTML = fmtMoney(newPayment) + '<span class="text-[10px] text-slate-400 font-medium ml-1">/bi-w</span>';
            const oldMonthly = calcPayment(balance, currentRate, years);
            const newMonthly = calcPayment(balance, newRate, years);
            if (currentRate > newRate) {
                const monthlySavings = oldMonthly - newMonthly;
                const totalSavings = monthlySavings * 12 * years;
                refTotalSave.textContent = fmtMoney(totalSavings);
                refTotalSave.classList.replace('text-slate-400', 'text-[var(--theme-green)]');
            } else {
                refTotalSave.textContent = "$0.00";
                refTotalSave.classList.replace('text-[var(--theme-green)]', 'text-slate-400');
            }
        }
  }

  // FIXED: Moved input listener logic into a named function
  function setupRefiCalcInputs() {
      [refLoanInput, refTermInput, refNewRateSlider, refRateInput].forEach(el => {
          if(el) el.addEventListener('input', calculateRefi);
      });
      // Run once on load to init zeros
      calculateRefi();
  }

  bySelAll('[data-type]').forEach(btn=>{btn.addEventListener('click',()=>{bySelAll('[data-type]').forEach(x=>x.classList.remove('selected','err'));btn.classList.add('selected');$('vehicleType').value=btn.dataset.type||'';setTimeout(()=>{goTo('step-budget')},200)})});
  bySelAll('[data-trade]').forEach(btn=>{btn.addEventListener('click',()=>{bySelAll('[data-trade]').forEach(x=>x.classList.remove('selected'));btn.classList.add('selected');$('hasTradeIn').value=btn.dataset.trade||'No';})});
  const biw=$('biWeeklyRange');const out=$('biWeeklyOut');const br=$('budgetRange');if(biw&&out&&br){const updateBudget=()=>{out.textContent=biw.value;br.value='$'+biw.value+' bi-weekly'};biw.addEventListener('input',updateBudget);updateBudget()}
  function setHousing(type){$('housingType').value=type;$('btnRent')?.setAttribute('aria-pressed',String(type==='Rent'));$('btnOwn')?.setAttribute('aria-pressed',String(type==='Own'))}$('btnRent')?.addEventListener('click',()=>setHousing('Rent'));$('btnOwn')?.addEventListener('click',()=>setHousing('Own'));
  const moneyFields=['avgMonthlyIncome','otherIncomeAmount','refLoanInput'];moneyFields.forEach(id=>{const el=$(id);if(el){el.addEventListener('blur',(e)=>formatMoneyField(e.target));el.addEventListener('focus',(e)=>{e.target.value=e.target.value.replace(/[^0-9]/g,'')})}});
  $('phone')?.addEventListener('input',(e)=>{const d=e.target.value.replace(/\D/g,'').slice(0,10);if(d.length>6)e.target.value=`(${d.slice(0,3)}) ${d.slice(3,6)}-${d.slice(6)}`;else if(d.length>3)e.target.value=`(${d.slice(0,3)}) ${d.slice(3)}`;else if(d.length>0)e.target.value=`(${d}`;});
  const hp=$('housingPayment');if(hp){hp.addEventListener('input',(e)=>{e.target.value=e.target.value.replace(/\D/g,'').slice(0,5)});hp.addEventListener('blur',(e)=>formatMoneyField(e.target));hp.addEventListener('focus',(e)=>{e.target.value=e.target.value.replace(/[^0-9]/g,'')})}
  function generateAppCode(){const n=Math.floor(Math.random()*1_000_000);return'ABC-'+String(n).padStart(6,'0')}async function runProgressOverlay(minMs=4200){const overlay=$('progress-overlay');const bar=$('progress-bar');const stepsEl=bySelAll('#progress-steps li');if(!overlay||!bar)return;overlay.classList.remove('hidden');const stages=[{width:35,index:0,ms:900},{width:70,index:1,ms:1200},{width:100,index:2,ms:1400}];const t0=Date.now();for(const st of stages){stepsEl.forEach((li,i)=>li.classList.toggle('active',i===st.index));requestAnimationFrame(()=>bar.style.width=st.width+'%');await new Promise(r=>setTimeout(r,st.ms))}const elapsed=Date.now()-t0;if(elapsed<minMs)await new Promise(r=>setTimeout(r,minMs-elapsed));overlay.classList.add('hidden')}function submitForm(){const flow=currentFlow().filter(id=>id!=='step-consent');for(const id of flow){if(!validateCurrent(id)){goTo(id);return}}bySel('#the-form').requestSubmit()}bySel('#the-form')?.addEventListener('submit',async(e)=>{e.preventDefault();const code=generateAppCode();try{sessionStorage.setItem('vic_app_code',code)}catch(_){}const codeInput=$('appCode');if(codeInput)codeInput.value=code;await runProgressOverlay(4200);e.target.submit()});
  bySelAll('.js-view-inventory').forEach(el=>{el.addEventListener('click',(e)=>{e.preventDefault();$('lead-form')?.scrollIntoView({behavior:'smooth',block:'start'})})});
  const formShell=$('form-shell');const formSpacer=$('form-spacer');const formBackdrop=$('form-backdrop');const formClose=$('form-close');const formTrigger=$('form-trigger');
  function expandForm(){if(formShell.classList.contains('form-focused'))return;formSpacer.classList.remove('js-hidden');formShell.classList.add('form-focused');formBackdrop.classList.add('active');formClose.classList.remove('hidden');formTrigger.classList.add('hidden');document.body.classList.add('modal-open')}
  function collapseForm(){if(!formShell.classList.contains('form-focused'))return;formShell.classList.add('form-closing');formBackdrop.classList.remove('active');formShell.addEventListener('animationend',function(){formShell.classList.remove('form-focused');formShell.classList.remove('form-closing');formSpacer.classList.add('js-hidden');document.body.classList.remove('modal-open');formClose.classList.add('hidden');formTrigger.classList.remove('hidden')},{once:true})}
  $('btnGetStarted')?.addEventListener('click',(e)=>{e.preventDefault();expandForm()});$('navApplyBtn')?.addEventListener('click',(e)=>{e.preventDefault();expandForm()});$('mobileApplyBtn')?.addEventListener('click',(e)=>{e.preventDefault();expandForm()});formTrigger?.addEventListener('click',expandForm);formClose?.addEventListener('click',collapseForm);formBackdrop?.addEventListener('click',collapseForm);
   
  // INIT HELPERS
  (function init(){
      bySel('#year').textContent=new Date().getFullYear();
      $('intent').value='finance';
      $('housingType')&&($('housingType').value='Rent');
      
      // Call new populate functions
      populateDOBYears($('dobYear'));
      populateMonths($('dobMonth'));
      updateDays();
      $('dobMonth')?.addEventListener('change', updateDays);
      $('dobYear')?.addEventListener('change', updateDays);
      
      populateDropdown($('timeWithEmployerYears'),0,30,'Years','Year');
      populateDropdown($('timeWithEmployerMonths'),0,11,'Months','Month');
      populateDropdown($('timeAtAddressYears'),0,30,'Years','Year');
      populateDropdown($('timeAtAddressMonths'),0,11,'Months','Month');
      populateProvinces($('currentProvince'));

      populateYears($('tradeInYear'), new Date().getFullYear(), 1995);
      populateYears($('refiYear'),    new Date().getFullYear(), 1995);
      
      populateRefiYearsLeft($('refiRemainYears'));
      
      populateMakes('refiMake','refiModel');
      populateMakes('tradeInMake','tradeInModel');
      
      goTo('step-intent');
      setupRefiCalcInputs(); // Re-ensure listeners are attached
  })();});
  </script>
</body>
</html>```
