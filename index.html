<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Vancouver Island Credit | Auto Approvals Online — Work with Blake</title>

  <meta name="description" content="Fast, confidential auto approvals across Vancouver Island & BC. New & used options. Delivery to your door. Work 1 on 1 with Blake Stolth — no call centres." />
  <link rel="canonical" href="https://vancouverislandcredit.ca/"/>
  <meta property="og:title" content="Vancouver Island Credit — Auto Approvals Online"/>
  <meta property="og:description" content="Get approved online. New & used inventory across Vancouver Island & BC. Delivery to your door. Work directly with Blake."/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://vancouverislandcredit.ca/"/>
  <meta property="og:image" content="https://vancouverislandcredit.ca/0041B99D-D49A-4024-AA7A-2786A4605342.jpg"/>
  <meta name="theme-color" content="#2A5D9F"/>

  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --blue-600:#2A5D9F;
      --blue-700:#214B80;
      --blue-100:#EAF1FB;
      --blue-grad:#4C7CC0;
      --nav-h: 60px;

      /* Universal compact scale */
      --fs-label: 13px;
      --fs-body: 14.5px;
      --fs-cta: 15px;
      --input-pad-y: 10px;     /* ~.625rem */
      --input-pad-x: 12px;     /* .75rem */
      --radius: 10px;

      /* Grid gaps */
      --gap-tight: .5rem;
      --gap-med: .65rem;
    }

    body { font-family: 'Inter', sans-serif; background:#f6f7fb; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
    .card { background:#fff; border-radius:1rem; border:1px solid #e5e7eb; box-shadow:0 10px 15px -3px rgb(0 0 0 / 0.05), 0 4px 6px -4px rgb(0 0 0 / 0.05); }

    /* Inputs — universal/compact */
    .form-input, .form-select, .form-textarea {
      background:#f3f4f6; color:#18181b; border:2px solid transparent; font-size:var(--fs-body); width:100%;
      padding:var(--input-pad-y) var(--input-pad-x); border-radius:var(--radius); transition:all .2s ease;
    }
    .form-input::placeholder { color:#a1a1aa; }
    .form-input:focus, .form-select:focus, .form-textarea:focus { background:#fff; border-color:var(--blue-600); box-shadow:0 0 0 3px rgba(42,93,159,.18); outline:none; }

    /* Labels */
    .label { font-size:var(--fs-label); color:#3f3f46; font-weight:600; }

    /* CTA */
    .cta-button { background:var(--blue-600); color:#fff; font-weight:800; padding:.7rem .9rem; border-radius:.7rem; transition:all .2s ease; box-shadow:0 4px 6px -1px rgb(0 0 0 / .08), 0 2px 4px -2px rgb(0 0 0 / .08); font-size:var(--fs-cta);}
    .cta-button:hover { transform:translateY(-1px); background:var(--blue-700); }

    /* Selection tiles — universal sizing */
    .tile, .choice {
      border-radius:10px; border:1.5px solid #e5e7eb; background:#fff; transition:.15s; font-weight:800; color:#111827; font-size:14px;
    }
    .tile { display:flex; align-items:center; justify-content:center; text-align:center; aspect-ratio:4/3; width:100%; }
    .choice { padding:.7rem; text-align:center; width:100%; }
    .tile:hover, .choice:hover { border-color:var(--blue-600); background:#f5f8ff; }
    .tile.selected, .choice.selected { border-color:var(--blue-600); background:#eef4ff; box-shadow:inset 0 0 0 2px var(--blue-600); }

    /* Progress */
    .track { height:7px; background:#e5e7eb; border-radius:9999px; overflow:hidden; }
    .fill { height:7px; background:linear-gradient(90deg, var(--blue-600), var(--blue-grad)); border-radius:9999px; width:0%; transition:width .25s ease; }

    /* Validation */
    .err { border-color:#ef4444 !important; }
    .err-label { color:#ef4444 !important; }

    /* Rent/Own segmented switch */
    .seg { display:inline-flex; gap:.25rem; background:#f3f4f6; padding:.2rem; border-radius:.6rem; }
    .seg-btn { padding:.4rem .6rem; border-radius:.5rem; font-weight:600; color:#374151; background:transparent; border:2px solid transparent; font-size:14px; }
    .seg-btn[aria-pressed="true"] { background:#e0ecff; color:#214B80; border-color:#bfdbfe; }

    /* FORM SHELL — auto height to tallest step (no extra air) */
    .form-shell{
      position:relative;
      height:auto;             /* we’ll set exact px via JS */
      overflow:hidden;         /* no internal scroll now that we fit tallest */
    }
    .form-shell .sticky{ position: sticky; top: 0; z-index: 10; }

    /* Tight rhythm inside the form */
    .form-tight > * + *{ margin-top: .85rem !important; }
    .step-tight > * + *{ margin-top: .6rem !important; }

    /* Inventory cards — universal 16:9 media and paddings */
    .bodytype-card{
      position:relative; overflow:hidden; border-radius:.8rem; border:1px solid #e5e7eb; background:#fff;
      transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease;
    }
    .bodytype-card:hover{ transform:translateY(-1px); border-color:var(--blue-600); box-shadow:0 10px 18px -10px rgba(42,93,159,.3); }
    .bodytype-media{ position:relative; width:100%; aspect-ratio:16/9; background:#e9eef6; }
    .bodytype-media img{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; }
    .bodytype-card .p-3{ padding:.6rem !important; }
    .bodytype-card p{ font-size:14px; }

    /* Utility containers */
    .container { width:100%; max-width: 980px; margin-inline:auto; }
    .max-form { width:100%; max-width: 720px; margin-inline:auto; }
  </style>
</head>
<body class="min-h-screen">
  <!-- NAV -->
  <header class="w-full container mt-4 px-4" style="height:var(--nav-h);">
    <nav class="bg-white/90 backdrop-blur card px-4 sm:px-6 py-2.5 flex items-center justify-between">
      <a href="#" class="flex items-center gap-3">
        <img src="Untitled_Artwork.PNG" alt="Vancouver Island Credit" class="h-10 w-auto object-contain rounded-md" width="120" height="48" onerror="this.style.display='none'"/>
        <span class="hidden sm:inline font-extrabold tracking-tight text-zinc-900">Vancouver Island Credit</span>
      </a>
      <div class="hidden sm:flex items-center gap-6 text-sm font-semibold text-zinc-700">
        <a href="#inventory" class="hover:text-blue-600">Inventory</a>
        <a href="#about" class="hover:text-blue-600">About</a>
        <a href="#contact" class="hover:text-blue-600">Contact</a>
        <a href="#lead-form" class="cta-button text-white !py-2">Apply Now</a>
      </div>
      <button id="menuBtn" class="sm:hidden inline-flex items-center justify-center h-10 w-10 rounded-md border border-zinc-200" aria-label="Open menu">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-zinc-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
      </button>
    </nav>
    <div id="mobileMenu" class="hidden sm:hidden mt-2 card px-4 py-3">
      <div class="flex flex-col gap-2 text-sm font-semibold text-zinc-700">
        <a href="#inventory" class="py-2 px-2 rounded hover:bg-blue-100">Inventory</a>
        <a href="#about" class="py-2 px-2 rounded hover:bg-blue-100">About</a>
        <a href="#contact" class="py-2 px-2 rounded hover:bg-blue-100">Contact</a>
        <a href="#lead-form" class="mt-1 cta-button text-center">Apply Now</a>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="container px-4 sm:px-6 py-5 sm:py-8 space-y-6">
    <!-- HERO -->
    <section id="about" class="card p-4 sm:p-6">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-3">
          <h1 class="font-black text-2xl sm:text-3xl text-zinc-900 tracking-tight">Get driving in 3 easy steps</h1>
          <ol class="space-y-2 text-[var(--fs-body)]">
            <li class="flex items-start gap-2">
              <span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-blue-100 text-blue-600 font-extrabold text-sm">1</span>
              <p><span class="font-semibold">Enter your info</span> — 2–3 minutes, no pressure.</p>
            </li>
            <li class="flex items-start gap-2">
              <span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-blue-100 text-blue-600 font-extrabold text-sm">2</span>
              <p><span class="font-semibold">Get online access</span> to the options you actually qualify for in BC.</p>
            </li>
            <li class="flex items-start gap-2">
              <span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-blue-100 text-blue-600 font-extrabold text-sm">3</span>
              <p><span class="font-semibold">We deliver</span> to your doorstep—fast & stress-free.</p>
            </li>
          </ol>
        </div>

        <div>
          <div class="flex items-center space-x-3 mb-3">
            <div class="bg-blue-100 p-2.5 rounded-lg">
              <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
            </div>
            <h2 class="text-xl font-extrabold text-zinc-900">Fastest Online Approval</h2>
          </div>
          <ul class="space-y-1.5 text-zinc-700 text-[var(--fs-body)]">
            <li><strong class="text-zinc-900">Avoid the Runaround:</strong> Deal with one real person.</li>
            <li><strong class="text-zinc-900">All Credit Welcome:</strong> High approval rates.</li>
            <li><strong class="text-zinc-900">Huge Selection:</strong> New & used vehicles across BC.</li>
            <li><strong class="text-zinc-900">Canada-wide delivery:</strong> To your door—easy.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- FORM (auto height → tallest step; universal sizing) -->
    <section class="card p-0 overflow-hidden relative max-form" id="lead-form">
      <div class="form-shell" id="form-shell">
        <!-- sticky progress -->
        <div id="progressBar" class="px-4 sm:px-5 pt-3 pb-2 sticky bg-white border-b">
          <div class="flex items-center justify-between mb-2">
            <div id="progress-label" class="text-[12px] font-semibold text-zinc-700">Step 1 of 8</div>
            <div id="progress-endcap" class="text-[12px] text-blue-700 font-semibold">Let’s get you approved</div>
          </div>
          <div class="track mb-1.5"><div id="progress-fill" class="fill" style="width:0%"></div></div>
        </div>

        <!-- form body -->
        <div class="px-4 sm:px-5 py-4">
          <form id="the-form" name="lead-form" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" action="/thank-you.html" class="form-tight" novalidate>
            <input type="hidden" name="form-name" value="lead-form"/>
            <input type="hidden" name="app_type" id="app_type" value="" />
            <input type="hidden" name="vehicleCondition" id="vehicleCondition" />
            <input type="hidden" name="vehicleType" id="vehicleType" />
            <p class="hidden" aria-hidden="true"><label>Don’t fill this out: <input name="bot-field"/></label></p>

            <!-- Steps (same structure & logic as before) -->
            <section class="form-step step-tight" data-step-key="vehicle">
              <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">What type of vehicle?</h3>
              <div class="mt-2 grid grid-cols-4 gap-2">
                <button type="button" class="tile" data-type="Car">Car</button>
                <button type="button" class="tile" data-type="SUV">SUV</button>
                <button type="button" class="tile" data-type="Van">Van</button>
                <button type="button" class="tile" data-type="Truck">Truck</button>
              </div>
            </section>

            <section class="form-step step-tight hidden" data-step-key="condition">
              <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">Used or new?</h3>
              <div class="mt-2 grid grid-cols-2 gap-2">
                <button type="button" class="choice" data-cond="Used">Used</button>
                <button type="button" class="choice" data-cond="New">New</button>
              </div>
            </section>

            <section class="form-step step-tight hidden" data-step-key="budget">
              <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">Monthly budget?</h3>
              <div class="mt-2 grid grid-cols-2 gap-2">
                <label class="tile cursor-pointer"><input type="radio" class="sr-only" name="budgetRange" value="$250 – $375" required><span>$250 – $375</span></label>
                <label class="tile cursor-pointer"><input type="radio" class="sr-only" name="budgetRange" value="$376 – $499" required><span>$376 – $499</span></label>
                <label class="tile cursor-pointer"><input type="radio" class="sr-only" name="budgetRange" value="$500 – $750" required><span>$500 – $750</span></label>
                <label class="tile cursor-pointer"><input type="radio" class="sr-only" name="budgetRange" value="$750+" required><span>$750+</span></label>
              </div>
            </section>

            <section class="form-step step-tight hidden" data-step-key="purchase">
              <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">Purchase details</h3>
              <div class="mt-2 grid gap-2">
                <div>
                  <label for="downPayment" class="label mb-1">Estimated down payment?</label>
                  <select id="downPayment" name="downPayment" class="form-select">
                    <option value="">Please select…</option>
                    <option>$3,000+</option>
                    <option>$1,000 – $3,000</option>
                    <option>$0 – $1,000</option>
                  </select>
                </div>
                <div>
                  <label for="hasTradeIn" class="label mb-1">Vehicle to trade in?</label>
                  <select id="hasTradeIn" name="hasTradeIn" class="form-select">
                    <option>No</option>
                    <option>Yes</option>
                  </select>
                </div>
                <div id="tradeInDetails" class="hidden">
                  <div class="grid grid-cols-4 gap-2">
                    <input type="number" name="tradeInYear" placeholder="Year" class="form-input" inputmode="numeric" />
                    <input type="text" name="tradeInMake" placeholder="Make" class="form-input"/>
                    <input type="text" name="tradeInModel" placeholder="Model" class="form-input"/>
                    <input type="number" name="tradeInKms" placeholder="KM" class="form-input" inputmode="numeric"/>
                  </div>
                  <input type="text" name="tradeInOwed" placeholder="Money owed? e.g., $5,000 or None" class="form-input mt-2"/>
                </div>
              </div>
            </section>

            <section class="form-step step-tight hidden" data-step-key="apptype">
              <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">Choose your path</h3>
              <div class="mt-2 grid grid-cols-2 gap-2" role="tablist" aria-label="Application type">
                <button type="button" class="choice" data-app="Credit Inquiry" aria-pressed="false">Credit Inquiry</button>
                <button type="button" class="choice" data-app="Full Application" aria-pressed="false">Full Application</button>
              </div>
              <p class="text-[12px] text-zinc-500 mt-1">
                Credit Inquiry shows where you stand and likely options. Full Application (if Blake sent this) gives exact options.
              </p>
            </section>

            <section class="form-step step-tight hidden" data-step-key="yourinfo">
              <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">Your information</h3>
              <div class="mt-2 grid grid-cols-1 sm:grid-cols-3 gap-2">
                <div>
                  <label for="firstName" class="label mb-1">First name <span class="text-red-500">*</span></label>
                  <input type="text" id="firstName" name="firstName" class="form-input" autocomplete="given-name" required/>
                </div>
                <div>
                  <label for="middleName" class="label mb-1">Middle name <span class="text-red-500">*</span></label>
                  <input type="text" id="middleName" name="middleName" class="form-input" autocomplete="additional-name" required/>
                </div>
                <div>
                  <label for="lastName" class="label mb-1">Last name <span class="text-red-500">*</span></label>
                  <input type="text" id="lastName" name="lastName" class="form-input" autocomplete="family-name" required/>
                </div>
              </div>
              <div class="mt-2 grid grid-cols-1 sm:grid-cols-2 gap-2">
                <div>
                  <label for="phone" class="label mb-1">Phone <span class="text-red-500">*</span></label>
                  <input type="tel" id="phone" name="phone" class="form-input" autocomplete="tel" inputmode="tel" required/>
                </div>
                <div>
                  <label for="email" class="label mb-1">Email <span class="text-red-500">*</span></label>
                  <input type="email" id="email" name="email" class="form-input" autocomplete="email" required/>
                </div>
              </div>
              <div class="mt-2 grid grid-cols-1 sm:grid-cols-4 gap-2">
                <div>
                  <label for="dobMonth" class="label mb-1">Month <span class="text-red-500">*</span></label>
                  <select id="dobMonth" name="dobMonth" class="form-select" required><option value="">Month</option></select>
                </div>
                <div>
                  <label for="dobDay" class="label mb-1">Day <span class="text-red-500">*</span></label>
                  <select id="dobDay" name="dobDay" class="form-select" required><option value="">Day</option></select>
                </div>
                <div>
                  <label for="dobYear" class="label mb-1">Year <span class="text-red-500">*</span></label>
                  <input type="number" id="dobYear" name="dobYear" placeholder="1992" class="form-input" inputmode="numeric" required/>
                </div>
                <div>
                  <label for="maritalStatus" class="label mb-1">Marital status <span class="text-red-500">*</span></label>
                  <select id="maritalStatus" name="maritalStatus" class="form-select" required>
                    <option value="">Please select…</option>
                    <option>Single</option>
                    <option>Married</option>
                    <option>Common-Law</option>
                    <option>Divorced</option>
                    <option>Separated</option>
                    <option>Widowed</option>
                  </select>
                </div>
              </div>
            </section>

            <section class="form-step step-tight hidden" data-step-key="income">
              <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">Income</h3>

              <div id="income-simple" class="mt-1 space-y-2">
                <div>
                  <label for="incomeSource" class="label mb-1">Primary income source</label>
                  <select id="incomeSource" name="incomeSource" class="form-select">
                    <option value="">Please select…</option>
                    <option value="Full-Time">Full-Time Employment</option>
                    <option value="Part-Time">Part-Time Employment</option>
                    <option value="Self-Employed">Self-Employed / Business Owner</option>
                    <option value="Disability">Disability</option>
                    <option value="Other">Other</option>
                  </select>
                </div>
                <div>
                  <label for="monthlyIncome" class="label mb-1">Monthly income (before tax) <span class="text-red-500">*</span></label>
                  <input type="text" id="monthlyIncome" name="monthlyIncome" placeholder="$3,500" class="form-input" inputmode="numeric"/>
                </div>
              </div>

              <div id="income-full" class="hidden mt-1 space-y-2">
                <div>
                  <label for="incomeSourceFull" class="label mb-1">Primary income source <span class="text-red-500">*</span></label>
                  <select id="incomeSourceFull" name="incomeSourceFull" class="form-select">
                    <option value="">Please select…</option>
                    <option value="Full-Time">Full-Time Employment</option>
                    <option value="Part-Time">Part-Time Employment</option>
                    <option value="Self-Employed">Self-Employed / Business Owner</option>
                    <option value="Disability">Disability</option>
                    <option value="Other">Other</option>
                  </select>
                </div>

                <div id="full-employment" class="hidden space-y-2">
                  <div>
                    <label for="currentEmployer" class="label mb-1">Employer <span class="text-red-500">*</span></label>
                    <input type="text" id="currentEmployer" name="currentEmployer" class="form-input" placeholder="Company name"/>
                  </div>
                  <div>
                    <label for="jobTitle" class="label mb-1">Position <span class="text-red-500">*</span></label>
                    <input type="text" id="jobTitle" name="jobTitle" class="form-input" placeholder="Your role"/>
                  </div>
                  <div>
                    <label class="label mb-1">Time with employer <span class="text-red-500">*</span></label>
                    <div class="grid grid-cols-2 gap-2">
                      <select id="timeWithEmployerYears" name="timeWithEmployerYears" class="form-select"><option value="">Years</option></select>
                      <select id="timeWithEmployerMonths" name="timeWithEmployerMonths" class="form-select"><option value="">Months</option></select>
                    </div>
                  </div>
                </div>

                <div id="full-self" class="hidden space-y-2">
                  <div>
                    <label for="businessName" class="label mb-1">Business name <span class="text-red-500">*</span></label>
                    <input type="text" id="businessName" name="businessName" class="form-input" placeholder="Your business"/>
                  </div>
                  <div>
                    <label for="avgMonthlyIncome" class="label mb-1">Average monthly income (before tax) <span class="text-red-500">*</span></label>
                    <input type="text" id="avgMonthlyIncome" name="avgMonthlyIncome" class="form-input" placeholder="$4,000" inputmode="numeric"/>
                  </div>
                </div>

                <div id="full-other" class="hidden space-y-2">
                  <div>
                    <label for="otherIncomeAmount" class="label mb-1">Monthly income (before tax) <span class="text-red-500">*</span></label>
                    <input type="text" id="otherIncomeAmount" name="otherIncomeAmount" class="form-input" placeholder="$2,000" inputmode="numeric"/>
                  </div>
                  <div>
                    <label for="otherIncomeSource" class="label mb-1">Source description <span class="text-red-500">*</span></label>
                    <textarea id="otherIncomeSource" name="otherIncomeSource" class="form-textarea form-input" rows="2" placeholder="Describe the source"></textarea>
                  </div>
                </div>
              </div>
            </section>

            <section class="form-step step-tight hidden" data-step-key="prev-employment">
              <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">Previous employment</h3>
              <p class="text-[12px] text-zinc-500 mb-1">Less than 2 years with current employer.</p>
              <div class="space-y-2">
                <div>
                  <label for="previousEmployer" class="label mb-1">Previous employer <span class="text-red-500">*</span></label>
                  <input type="text" id="previousEmployer" name="previousEmployer" class="form-input" placeholder="Company"/>
                </div>
                <div class="grid grid-cols-2 gap-2">
                  <select id="prevTimeWithEmployerYears" name="prevTimeWithEmployerYears" class="form-select"><option value="">Years</option></select>
                  <select id="prevTimeWithEmployerMonths" name="prevTimeWithEmployerMonths" class="form-select"><option value="">Months</option></select>
                </div>
              </div>
            </section>

            <section class="form-step step-tight hidden" data-step-key="address">
              <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">Where do you live?</h3>
              <div class="mt-1 space-y-2">
                <label class="label">Current address <span class="text-red-500">*</span></label>
                <div class="grid grid-cols-6 gap-2">
                  <input type="text" id="currentStreetAddress" name="currentStreetAddress" class="form-input col-span-6 sm:col-span-4" placeholder="Street Address" autocomplete="street-address" required/>
                  <input type="text" id="currentUnit" name="currentUnit" class="form-input col-span-6 sm:col-span-2" placeholder="Unit #"/>
                  <input type="text" id="currentCity" name="currentCity" class="form-input col-span-6 sm:col-span-3" placeholder="City" autocomplete="address-level2" required/>
                  <select id="currentProvince" name="currentProvince" class="form-select col-span-6 sm:col-span-2" required><option value="">Province</option></select>
                  <input type="text" id="currentPostalCode" name="currentPostalCode" class="form-input col-span-6 sm:col-span-1" placeholder="Postal" autocomplete="postal-code" required/>
                </div>
              </div>

              <div class="mt-2 grid grid-cols-1 sm:grid-cols-2 gap-2 items-end" id="housing-row">
                <div>
                  <label id="housingLabel" for="housingPayment" class="label mb-1">Monthly Payment <span class="text-red-500">*</span></label>
                  <input type="text" id="housingPayment" name="housingPayment" class="form-input" placeholder="$1,500" inputmode="numeric" required/>
                </div>
                <div>
                  <label class="label mb-1">Rent or Own? <span class="text-red-500">*</span></label>
                  <div class="seg">
                    <button type="button" class="seg-btn" id="btnRent" aria-pressed="true">Rent</button>
                    <button type="button" class="seg-btn" id="btnOwn" aria-pressed="false">Own</button>
                  </div>
                  <input type="hidden" id="housingType" name="housingType" value="Rent" />
                </div>
              </div>

              <div id="addr-duration" class="mt-2">
                <label class="label mb-1">Time at current address <span class="text-red-500">*</span></label>
                <div class="grid grid-cols-2 gap-2">
                  <select id="timeAtAddressYears" name="timeAtAddressYears" class="form-select"><option value="">Years</option></select>
                  <select id="timeAtAddressMonths" name="timeAtAddressMonths" class="form-select"><option value="">Months</option></select>
                </div>
              </div>
            </section>

            <section class="form-step step-tight hidden" data-step-key="prev-address">
              <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">Previous address</h3>
              <p class="text-[12px] text-zinc-500 mb-1">Less than 2 years at current address.</p>
              <div class="space-y-2">
                <div class="grid grid-cols-6 gap-2">
                  <input type="text" id="prevStreetAddress" name="prevStreetAddress" class="form-input col-span-6 sm:col-span-4" placeholder="Street Address"/>
                  <input type="text" id="prevUnit" name="prevUnit" class="form-input col-span-6 sm:col-span-2" placeholder="Unit #"/>
                  <input type="text" id="prevCity" name="prevCity" class="form-input col-span-6 sm:col-span-3" placeholder="City"/>
                  <select id="prevProvince" name="prevProvince" class="form-select col-span-6 sm:col-span-2"><option value="">Province</option></select>
                  <input type="text" id="prevPostalCode" name="prevPostalCode" class="form-input col-span-6 sm:col-span-1" placeholder="Postal"/>
                </div>
                <div class="grid grid-cols-2 gap-2 mt-1">
                  <select id="prevTimeAtAddressYears" name="prevTimeAtAddressYears" class="form-select"><option value="">Years</option></select>
                  <select id="prevTimeAtAddressMonths" name="prevTimeAtAddressMonths" class="form-select"><option value="">Months</option></select>
                </div>
              </div>
            </section>

            <section class="form-step step-tight hidden" data-step-key="consent">
              <p id="consent-inline" class="text-[11.5px] leading-4 text-zinc-600">
                By submitting, you consent to Vancouver Island Credit collecting and using the information you provide to assess financing options and to contact you about your application.
              </p>
              <div class="pt-2">
                <button type="submit" id="submitBtn" class="w-full cta-button">Submit and See Options</button>
                <p id="form-status" class="mt-2 text-[12px] text-center text-red-600" aria-live="polite"></p>
              </div>
            </section>

            <!-- NAV -->
            <div id="formNav" class="flex items-center justify-between pt-1">
              <button type="button" id="btnBack" class="text-[13px] font-semibold text-zinc-500 hover:text-zinc-800 px-2 py-2 disabled:opacity-30">Back</button>
              <button type="button" id="btnNext" class="cta-button">Next</button>
            </div>
          </form>
        </div>
      </div>
    </section>

    <!-- INVENTORY (8 boxes) -->
    <section id="inventory" class="card p-4 sm:p-6">
      <div class="flex items-center justify-between mb-2">
        <h3 class="text-lg sm:text-xl font-extrabold text-zinc-900">Browse by Vehicle Type</h3>
        <a href="#lead-form" class="text-[13px] font-semibold text-blue-600 hover:underline js-view-inventory">View all</a>
      </div>
      <p class="text-[13px] text-zinc-600 mb-3">Pick a body style to see matching options after a quick approval.</p>

      <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-media"><img src="/img/type-suv-800.jpg" alt="SUV / Crossover"></div>
          <div class="p-3"><p class="font-semibold">SUV / Crossover</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-media"><img src="/img/type-truck-800.jpg" alt="Truck"></div>
          <div class="p-3"><p class="font-semibold">Truck</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-media"><img src="/img/type-sedan-800.jpg" alt="Sedan"></div>
          <div class="p-3"><p class="font-semibold">Sedan</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-media"><img src="/img/type-coupe-800.jpg" alt="Coupe"></div>
          <div class="p-3"><p class="font-semibold">Coupe</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-media"><img src="/img/type-minivan-800.jpg" alt="Minivan"></div>
          <div class="p-3"><p class="font-semibold">Minivan</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-media"><img src="/img/type-hatchback-800.jpg" alt="Hatchback"></div>
          <div class="p-3"><p class="font-semibold">Hatchback</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-media"><img src="/img/type-convertible-800.jpg" alt="Convertible"></div>
          <div class="p-3"><p class="font-semibold">Convertible</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-media"><img src="/img/type-wagon-800.jpg" alt="Wagon"></div>
          <div class="p-3"><p class="font-semibold">Wagon</p></div>
        </a>
      </div>
    </section>

    <footer id="contact" class="text-center text-xs text-zinc-500 pt-2 space-y-1.5">
      <p class="font-semibold text-zinc-600">Vancouver Island Credit</p>
      <p>525 Gorge Rd E, Victoria, BC V8T 4T2</p>
      <p><a href="tel:2369692424" class="hover:text-blue-600 transition-colors">(236) 969-2424</a></p>
      <p class="pt-1">Serving Vancouver Island & British Columbia • Delivery available province-wide</p>
      <p class="mt-1">© <span id="year"></span> Vancouver Island Credit • All rights reserved</p>
    </footer>
  </main>

  <script>
    // Helpers
    const $ = (id) => document.getElementById(id);
    const bySel = (s, root=document) => root.querySelector(s);
    const bySelAll = (s, root=document) => Array.from(root.querySelectorAll(s));

    // Mobile menu
    $('menuBtn')?.addEventListener('click', ()=> $('mobileMenu')?.classList.toggle('hidden'));

    // ----- Dynamic Steps Engine -----
    const BASE_ORDER = [
      'vehicle','condition','budget','purchase','apptype','yourinfo','income','address','consent'
    ];
    let dynamicOrder = [...BASE_ORDER];

    function getStepEl(key){ return bySel(`.form-step[data-step-key="${key}"]`); }
    function allStepEls(){ return dynamicOrder.map(getStepEl).filter(Boolean); }

    function ensureInOrder(key, afterKey){
      const exists = dynamicOrder.includes(key);
      if (exists) dynamicOrder = dynamicOrder.filter(k => k !== key);
      const idx = dynamicOrder.indexOf(afterKey);
      if (idx >= 0) dynamicOrder.splice(idx+1, 0, key);
    }
    function removeFromOrder(key){
      dynamicOrder = dynamicOrder.filter(k => k !== key);
    }

    function showStepByIndex(idx){
      const els = allStepEls();
      els.forEach(el => el.classList.add('hidden'));
      const cur = els[idx];
      if (cur) cur.classList.remove('hidden');

      $('btnBack').disabled = (idx === 0);
      $('btnNext').textContent = (idx === els.length-1) ? 'See My Options' : 'Next';

      const pct = Math.round((idx) / Math.max(1, (els.length-1)) * 100);
      $('progress-fill').style.width = pct + '%';
      $('progress-label').textContent = `Step ${idx+1} of ${els.length}`;
      $('progress-endcap').textContent = (idx === els.length-1) ? 'See options you’re actually qualified for' : 'Let’s get you approved';

      window.__currentIndex = idx;

      // Recompute auto height to fit tallest step whenever we change step
      setShellHeightToTallest();
    }

    // Auto height: compute tallest total and set once so the bottom hugs the longest step
    function setShellHeightToTallest(){
      const shell = $('form-shell');
      const progress = $('progressBar');
      const form = $('the-form');
      if(!shell || !form || !progress) return;

      // measure paddings/margins to get an accurate total
      const shellStyles = window.getComputedStyle(shell);
      const shellVert = parseFloat(shellStyles.borderTopWidth) + parseFloat(shellStyles.borderBottomWidth);

      const progressH = progress.offsetHeight;
      const navH = $('formNav')?.offsetHeight || 0;

      // Temporarily reveal all steps to measure their heights
      const steps = bySelAll('.form-step', form);
      const prevStates = steps.map(el => el.classList.contains('hidden'));
      steps.forEach(el => el.classList.remove('hidden'));

      // Measure tallest step content box (margin included by offsetHeight)
      let tallest = 0;
      steps.forEach(el => {
        const h = el.offsetHeight;
        if (h > tallest) tallest = h;
      });

      // Restore visibility states
      steps.forEach((el,i)=> prevStates[i] && el.classList.add('hidden'));

      // Padding around the form inner wrapper (px-4/py-4 etc.)
      const wrapper = form.closest('.px-4, .px-5')?.parentElement || form.parentElement;
      const wrapStyles = window.getComputedStyle(form.parentElement);
      const wrapPad = parseFloat(wrapStyles.paddingTop) + parseFloat(wrapStyles.paddingBottom);

      // Add a tiny buffer so the button shadow never clips
      const BUFFER = 6;

      const total = progressH + tallest + navH + wrapPad + shellVert + BUFFER;
      shell.style.height = Math.ceil(total) + 'px';
      shell.style.overflow = 'hidden'; // keeps it crisp
    }

    function rebuildAndStay(){
      const idx = window.__currentIndex ?? 0;
      const els = allStepEls();
      const curEl = els[idx];
      const curKey = curEl?.dataset.stepKey;
      const newEls = allStepEls();
      let newIdx = newEls.findIndex(el => el.dataset.stepKey === curKey);
      if (newIdx < 0) newIdx = Math.min(idx, newEls.length-1);
      showStepByIndex(newIdx);
    }

    // Mode & branching
    function setAppMode(nextMode){
      $('app_type').value = nextMode || '';
      bySelAll('[data-app]').forEach(b=> { b.classList.remove('selected'); b.setAttribute('aria-pressed','false'); });
      if (nextMode) { const btn = bySel(`[data-app="${nextMode}"]`); btn?.classList.add('selected'); btn?.setAttribute('aria-pressed','true'); }

      const isCredit = nextMode === 'Credit Inquiry';
      const isFull = nextMode === 'Full Application';

      // Required
      ['middleName','dobYear','dobMonth','dobDay','maritalStatus'].forEach(id => $(id).required = true);

      // Toggle income subforms
      bySel('#income-simple')?.classList.toggle('hidden', !!isFull);
      bySel('#income-full')?.classList.toggle('hidden', !isFull);

      // Reset requirements
      ['currentStreetAddress','currentCity','currentProvince','currentPostalCode',
       'timeAtAddressYears','timeAtAddressMonths',
       'previousEmployer','prevTimeWithEmployerYears','prevTimeWithEmployerMonths',
       'prevStreetAddress','prevCity','prevProvince','prevPostalCode',
       'prevTimeAtAddressYears','prevTimeAtAddressMonths',
       'monthlyIncome','incomeSource','incomeSourceFull','currentEmployer','jobTitle']
        .forEach(id => { const n=$(id); if(n) n.required = false; });

      if (isCredit) {
        ['currentStreetAddress','currentCity','currentProvince','currentPostalCode'].forEach(id => $(id).required = true);
        $('monthlyIncome').required = true;
        $('housingPayment').required = true;
      }

      if (isFull) {
        ['currentStreetAddress','currentCity','currentProvince','currentPostalCode','timeAtAddressYears','timeAtAddressMonths'].forEach(id => $(id).required = true);
        $('incomeSourceFull').required = true;
        $('housingPayment').required = true;
      }

      // Height may change with mode toggle
      setShellHeightToTallest();
    }

    function monthsValue(yRaw, mRaw){
      const y = parseInt(yRaw || '0',10);
      const m = parseInt(mRaw || '0',10);
      return (y*12)+m;
    }

    function onIncomeSourceFullChange(){
      const v = $('incomeSourceFull')?.value || '';
      const employed = (v === 'Full-Time' || v === 'Part-Time');
      const selfEmp = (v === 'Self-Employed');
      const other = (v === 'Disability' || v === 'Other');

      ['full-employment','full-self','full-other'].forEach(id => bySel('#'+id)?.classList.add('hidden'));
      ['currentEmployer','jobTitle','timeWithEmployerYears','timeWithEmployerMonths','businessName','avgMonthlyIncome','otherIncomeAmount','otherIncomeSource','previousEmployer','prevTimeWithEmployerYears','prevTimeWithEmployerMonths'].forEach(id => { const n=$(id); if(n) n.required=false; });

      if (employed){
        bySel('#full-employment')?.classList.remove('hidden');
        ['currentEmployer','jobTitle','timeWithEmployerYears','timeWithEmployerMonths'].forEach(id => $(id).required = true);
      } else if (selfEmp){
        bySel('#full-self')?.classList.remove('hidden');
        ['businessName','avgMonthlyIncome'].forEach(id => $(id).required = true);
      } else if (other){
        bySel('#full-other')?.classList.remove('hidden');
        ['otherIncomeAmount','otherIncomeSource'].forEach(id => $(id).required = true);
      }

      maybeInsertPrevEmploymentStep();
      setShellHeightToTallest();
    }

    function maybeInsertPrevEmploymentStep(){
      const v = $('incomeSourceFull')?.value || '';
      const employed = (v === 'Full-Time' || v === 'Part-Time');
      const yRaw = $('timeWithEmployerYears')?.value ?? '';
      const mRaw = $('timeWithEmployerMonths')?.value ?? '';
      const hasAny = (yRaw !== '' || mRaw !== '');
      const need = employed && hasAny && monthsValue(yRaw,mRaw) < 24;

      const key = 'prev-employment';
      if (need){
        ensureInOrder(key, 'income');
        ['previousEmployer','prevTimeWithEmployerYears','prevTimeWithEmployerMonths'].forEach(id => { const n=$(id); if(n) n.required = true; });
        getStepEl(key)?.classList.remove('hidden');
      } else {
        ['previousEmployer','prevTimeWithEmployerYears','prevTimeWithEmployerMonths'].forEach(id => { const n=$(id); if(n) n.required = false; });
        removeFromOrder(key);
        getStepEl(key)?.classList.add('hidden');
      }
      rebuildAndStay();
      setShellHeightToTallest();
    }

    function maybeInsertPrevAddressStep(){
      const yRaw = $('timeAtAddressYears')?.value ?? '';
      const mRaw = $('timeAtAddressMonths')?.value ?? '';
      const hasAny = (yRaw !== '' || mRaw !== '');
      const need = hasAny && monthsValue(yRaw,mRaw) < 24;

      const key = 'prev-address';
      if (need){
        ensureInOrder(key, 'address');
        ['prevStreetAddress','prevCity','prevProvince','prevPostalCode','prevTimeAtAddressYears','prevTimeAtAddressMonths']
          .forEach(id => { const n=$(id); if(n) n.required = true; });
        getStepEl(key)?.classList.remove('hidden');
      } else {
        ['prevStreetAddress','prevCity','prevProvince','prevPostalCode','prevTimeAtAddressYears','prevTimeAtAddressMonths']
          .forEach(id => { const n=$(id); if(n) n.required = false; });
        removeFromOrder(key);
        getStepEl(key)?.classList.add('hidden');
      }
      rebuildAndStay();
      setShellHeightToTallest();
    }

    function validateStepIndex(idx){
      const stepEl = allStepEls()[idx];
      if(!stepEl) return true;
      let ok = true;
      const fields = Array.from(stepEl.querySelectorAll('[required]'));
      fields.forEach(el => {
        let pass = (el.type==='checkbox') ? el.checked : (el.value && el.value.trim()!=='');
        if (el.id==='phone') pass = el.value.replace(/\D/g,'').length>=10;
        if (el.type==='email' || el.id==='email'){ const v=el.value.trim(); pass = pass && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v); }
        if (!pass){ ok=false; el.classList.add('err'); const lab = bySel('label[for="'+el.id+'"]'); lab?.classList.add('err-label'); }
        else { el.classList.remove('err'); const lab = bySel('label[for="'+el.id+'"]'); lab?.classList.remove('err-label'); }
      });
      return ok;
    }

    function validateAll(){
      let ok = true;
      for (let i=0;i<allStepEls().length;i++){ if(!validateStepIndex(i)) ok=false; }
      return ok;
    }

    function next(delta){
      const cur = window.__currentIndex || 0;
      if (delta>0 && !validateStepIndex(cur)) return;
      let t = cur + delta;
      t = Math.max(0, Math.min(t, allStepEls().length - 1));
      if (delta>0 && t === cur && cur === allStepEls().length - 1) { submitForm(); return; }
      showStepByIndex(t);
    }

    $('btnNext').addEventListener('click', ()=> next(1));
    $('btnBack').addEventListener('click', ()=> next(-1));

    // Selections
    bySelAll('[data-type]').forEach(b=> b.addEventListener('click', ()=>{
      $('vehicleType').value = b.dataset.type;
      bySelAll('[data-type]').forEach(x=>x.classList.remove('selected')); b.classList.add('selected'); next(1);
    }));
    bySelAll('[data-cond]').forEach(b=> b.addEventListener('click', ()=>{
      $('vehicleCondition').value = b.dataset.cond;
      bySelAll('[data-cond]').forEach(x=>x.classList.remove('selected')); b.classList.add('selected'); next(1);
    }));
    bySelAll('[name="budgetRange"]').forEach(r=>{
      r.addEventListener('change', ()=> next(1));
      r.parentElement.addEventListener('click', ()=>{ r.checked=true; next(1); });
    });

    $('hasTradeIn')?.addEventListener('change', (e)=>{
      bySel('#tradeInDetails')?.classList.toggle('hidden', e.target.value.toLowerCase()!=='yes');
      setShellHeightToTallest();
    });

    bySelAll('[data-app]').forEach(b=> b.addEventListener('click', ()=>{
      setAppMode(b.dataset.app);
      next(1);
    }));

    // Rent/Own switch
    function setHousing(type){
      $('housingType').value = type;
      $('btnRent').setAttribute('aria-pressed', type==='Rent');
      $('btnOwn').setAttribute('aria-pressed', type==='Own');
      $('housingLabel').textContent = 'Monthly Payment *';
    }
    $('btnRent')?.addEventListener('click', ()=> { setHousing('Rent'); });
    $('btnOwn')?.addEventListener('click', ()=> { setHousing('Own'); });

    // Formatters
    function currencyFmt(e){ let v=e.target.value.replace(/[$,]/g,''); e.target.value = (!v||isNaN(v))? '' : ('$'+ new Intl.NumberFormat('en-US').format(v)); }
    function phoneFmt(e){ const d=e.target.value.replace(/\D/g,'').slice(0,10); if(d.length>6)e.target.value=`(${d.slice(0,3)}) ${d.slice(3,6)}-${d.slice(6)}`; else if(d.length>3)e.target.value=`(${d.slice(0,3)}) ${d.slice(3)}`; else if(d.length>0)e.target.value=`(${d}`; }
    $('phone')?.addEventListener('input', phoneFmt);
    ['monthlyIncome','avgMonthlyIncome','otherIncomeAmount','housingPayment'].forEach(id=> $(id)?.addEventListener('input', currencyFmt));

    // Branching listeners (and re-measure height on change)
    $('incomeSourceFull')?.addEventListener('change', onIncomeSourceFullChange);
    $('timeWithEmployerYears')?.addEventListener('change', ()=>{ maybeInsertPrevEmploymentStep(); });
    $('timeWithEmployerMonths')?.addEventListener('change', ()=>{ maybeInsertPrevEmploymentStep(); });

    $('timeAtAddressYears')?.addEventListener('change', ()=>{ maybeInsertPrevAddressStep(); });
    $('timeAtAddressMonths')?.addEventListener('change', ()=>{ maybeInsertPrevAddressStep(); });

    // Inventory CTA -> jump to form
    document.querySelectorAll('.js-view-inventory').forEach(el=>{
      el.addEventListener('click', (e)=>{
        e.preventDefault();
        document.getElementById('lead-form')?.scrollIntoView({behavior:'smooth', block:'start'});
      });
    });

    // Submit
    async function submitForm(){
      if (!validateAll()) { $('form-status').textContent = 'Please complete all required fields.'; return; }
      $('submitBtn').disabled = true; $('submitBtn').textContent = 'Submitting…';
      const fd = new FormData($('the-form'));
      try {
        await fetch('/', { method:'POST', headers:{'Content-Type':'application/x-www-form-urlencoded'}, body:new URLSearchParams(fd).toString() });
        window.location.href = '/thank-you.html';
      } catch (e) {
        $('the-form').submit();
      }
    }

    // Boot
    (function init(){
      const y = new Date().getFullYear(); bySel('#year').textContent = y;

      // DOB selects
      function populateMonths(sel){ if(!sel) return; const m=["January","February","March","April","May","June","July","August","September","October","November","December"]; m.forEach((mm,i)=>{ const o=document.createElement('option'); o.value=i+1; o.textContent=mm; sel.appendChild(o);}); }
      function updateDays(){ const y=parseInt($('dobYear').value||'',10); const m=parseInt($('dobMonth').value||'',10); const sel=parseInt($('dobDay').value||'',10); const days=(y&&m)?new Date(y,m,0).getDate():31; $('dobDay').innerHTML='<option value="">Day</option>'; for(let i=1;i<=days;i++){ const o=document.createElement('option'); o.value=i; o.textContent=i; $('dobDay').appendChild(o);} if(sel&&sel<=days)$('dobDay').value=sel; }
      populateMonths($('dobMonth')); updateDays();
      $('dobMonth').addEventListener('change', updateDays);
      $('dobYear').addEventListener('input', updateDays);

      // Dropdowns
      function populateDropdown(sel,start,end,label,singular){ if(!sel) return; sel.innerHTML='<option value="">'+(singular||label)+'</option>'; for(let i=start;i<=end;i++){ const o=document.createElement('option'); o.value=i; o.textContent=i+' '+(i!==1?label:(singular||label)); sel.appendChild(o);} }
      populateDropdown($('timeWithEmployerYears'), 0, 30, 'Years', 'Year');
      populateDropdown($('timeWithEmployerMonths'), 0, 11, 'Months', 'Month');
      populateDropdown($('prevTimeWithEmployerYears'), 0, 30, 'Years', 'Year');
      populateDropdown($('prevTimeWithEmployerMonths'), 0, 11, 'Months', 'Month');
      populateDropdown($('timeAtAddressYears'), 0, 30, 'Years', 'Year');
      populateDropdown($('timeAtAddressMonths'), 0, 11, 'Months', 'Month');
      populateDropdown($('prevTimeAtAddressYears'), 0, 30, 'Years', 'Year');
      populateDropdown($('prevTimeAtAddressMonths'), 0, 11, 'Months', 'Month');

      // Provinces
      function populateProvinces(cur, prev){ const prov=["AB","BC","MB","NB","NL","NS","NT","NU","ON","PE","QC","SK","YT"]; [cur,prev].forEach(sel=>{ if(!sel) return; prov.forEach(p=>{ const o=document.createElement('option'); o.value=p; o.textContent=p; sel.appendChild(o); }); }); }
      populateProvinces($('currentProvince'), $('prevProvince'));

      // Default housing
      $('housingType').value = 'Rent';

      // Start
      dynamicOrder = [...BASE_ORDER];
      showStepByIndex(0);

      // First height compute (after initial paints)
      requestAnimationFrame(setShellHeightToTallest);
      window.addEventListener('resize', ()=> { setShellHeightToTallest(); });
    })();
  </script>
</body>
</html>
