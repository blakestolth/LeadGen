<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    
  <title>Vancouver Island Credit | Auto Approvals Online</title>

  <meta name="description" content="Fast, confidential auto approvals across Vancouver Island & BC. New & used options. Delivery to your door. Work 1 on 1 with Blake Stolth." />
  <link rel="canonical" href="https://vancouverislandcredit.ca/"/>
  <meta property="og:title" content="Vancouver Island Credit — Auto Approvals Online"/>
  <meta property="og:description" content="Get approved online. New & used inventory across Vancouver Island & BC. Delivery to your door."/>
  <meta property="og:type" content="website"/>
  <meta property="og:image" content="https://vancouverislandcredit.ca/0041B99D-D49A-4024-AA7A-2786A4605342.jpg"/>
  <meta name="theme-color" content="#2A5D9F"/>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>

  <style>
    :root{
      /* COLORS */
      --blue-600:#2A5D9F; 
      --blue-700:#214B80; 
      --blue-100:#EAF1FB; 
      --red-equifax: #A8202A; /* Exact Equifax Red */
      --theme-green: #166534; /* Professional Forest Green */
      --slate-50: #f8fafc;
      --slate-100: #f1f5f9;
      --slate-200: #e2e8f0;
      --slate-300: #cbd5e1;
      --slate-400: #94a3b8;
      --slate-500: #64748b;
      --slate-600: #475569;
      --slate-700: #334155;
      --slate-800: #1e293b;

      /* Typography & Spacing */
      --fs-h1: 26px; --fs-h2: 18px; --fs-body: 13px; --fs-label: 11px; 
      --radius: 8px;
      --control-h: 44px;
      --field-gap: 8px; 
      --section-max: 720px;
    }

    body{
      font-family:'Work Sans',sans-serif;
      background: var(--slate-100);
      color: var(--slate-700);
      overflow-x: hidden;
    }
    
    body.modal-open { overflow: hidden !important; }

    .h1{ font-size:var(--fs-h1); font-weight:800; color:var(--slate-800); line-height: 1.1; letter-spacing: -0.5px; }
    .h2{ font-size:var(--fs-h2); font-weight:700; color:var(--slate-800); margin-bottom:4px; white-space: nowrap; }
    @media(max-width: 640px) { .h2 { white-space: normal; } }
    .label{ font-size:var(--fs-label); color:var(--slate-700); font-weight:600; display:block; margin-bottom:4px; text-transform: uppercase; letter-spacing: 0.02em; text-align: center; }
    
    .card{ background:#fff; border-radius:12px; border:1px solid var(--slate-200); box-shadow:0 10px 15px -3px rgb(0 0 0 / 0.05); }
    .card-accent{ border: 1px solid var(--slate-300); box-shadow: 0 10px 25px -5px rgba(30, 41, 59, 0.05); background: #fff; }

    /* Forms */
    .form-input,.form-select{
      background: var(--slate-50); color:var(--slate-800); border:1px solid var(--slate-300);
      font-size:var(--fs-body); width:100%; padding: 0 var(--input-px); border-radius: var(--radius); 
      height: var(--control-h) !important; line-height: var(--control-h); font-weight: 500; display: block; box-sizing: border-box;
    }
    .form-input:focus,.form-select:focus{ background:#fff; border-color:var(--blue-600); box-shadow:0 0 0 3px rgba(42,93,159,.15); outline:none; }

    .form-select {
      -webkit-appearance: none; appearance: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
      background-position: right 0.8rem center; background-size: 1.2em 1.2em; background-repeat: no-repeat; padding-right: 2.5rem;
      display: flex; align-items: center;
    }

    .cta-button{ background:var(--blue-600); color:#fff; font-weight:700; padding:.5rem 1.2rem; border-radius: var(--radius); font-size:var(--fs-cta); min-height:42px; transition: all .2s ease; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); display: inline-flex; align-items: center; justify-content: center; cursor: pointer; border: none;}
    .cta-button:hover{ background:var(--blue-700); transform: translateY(-1px); }
    .cta-button:active{ transform: scale(0.98); }

    .track{ height:5px; background:var(--slate-200); border-radius:9999px; overflow:hidden; }
    .fill{ height:5px; background:var(--blue-600); border-radius:9999px; width:0%; transition:width .3s ease; }
    .err{ border-color:var(--red-equifax) !important; background-color: #fff5f5; animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; } 
    .err-label{ color:var(--red-equifax) !important; }
    @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }

    /* Utility */
    .choice-rect { width:100%; text-align:left; border:1.5px solid var(--slate-300); border-radius:var(--radius); background:#fff; font-weight:600; color: var(--slate-700); transition:all .15s ease; display:flex; align-items:center; cursor:pointer; padding: 0 16px; min-height: 50px; font-size: 15px; justify-content: center; }
    .choice-rect:hover{ border-color:var(--blue-600); background: #f8fafc; transform: translateY(-1px); }
    .choice-rect.selected{ border-color:var(--blue-600); background:var(--blue-100); color: var(--blue-700); box-shadow: 0 0 0 1px var(--blue-600); }
    .seg{ display:inline-flex; align-items:center; gap:4px; background:var(--slate-100); border:1.5px solid var(--slate-200); border-radius:8px; padding:4px; width: 100%; }
    .seg-btn{ flex: 1; appearance:none; border:0; background:transparent; cursor:pointer; padding:6px 10px; border-radius:6px; font-weight:700; font-size:13px; color:var(--slate-500); transition:all .15s ease; }
    .seg-btn[aria-pressed="true"]{ background:#fff; color:var(--blue-600); box-shadow:0 1px 3px rgba(0,0,0,.1); }
    .grid-inline-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    .brand-left{ display:flex; align-items:center; gap:12px; }
    .site-logo{ height:45px; width:auto; object-fit:contain; display:block; transform:translateY(-1px); }
    @media (min-width:640px){ .site-logo{ height:60px; } }
    .brand-stack{ display:flex; flex-direction:column; justify-content: center; gap:2px; }
    .brand-title{ color:var(--slate-800); font-weight:800; letter-spacing:-0.02em; font-size:var(--nav-font); white-space:nowrap; text-decoration:none; line-height:1; margin-left:-2px; }
    .powered-by-inline{ display:flex; align-items:center; gap:6px; font-size: 11px; color:var(--slate-500); font-weight:600; line-height:1; margin-top:2px; }
    .powered-by-inline img{ height: 11px; width:auto; object-fit:contain; position:relative; top:1px; opacity: 0.8; }
    .abc-badge{ display:inline-flex; align-items:center; justify-content:center; width:20px; height:20px; border-radius:9999px; background:var(--blue-600); color:#fff; border:none; font-weight:800; font-size:11px; line-height:1; flex-shrink:0; }
    .bodytype-card{ position: relative; overflow:hidden; border-radius:12px; border:1px solid var(--slate-200); background:#fff; transition:transform .2s,box-shadow .2s,border-color .2s; }
    .bodytype-card:hover{ transform:translateY(-3px); border-color:var(--blue-600); box-shadow:0 12px 20px -5px rgba(42,93,159,.2); }
    .bodytype-img{ background:#e5e7eb center/cover no-repeat; height:90px; }
    @media (min-width:640px){ .bodytype-img{ height:100px; } }
    .inv-overlay { position: absolute; inset: 0; background: rgba(42,93,159,0.9); display: flex; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.2s ease; color: white; font-weight: 700; font-size: 14px; z-index: 5; border-radius: 11px;}
    .bodytype-card:hover .inv-overlay { opacity: 1; }
    .map-embed{ width:100%; height:200px; border:0; border-radius: inherit; }
    @media (min-width:640px){ .map-embed{ height:150px; } }
    .progress-overlay{position:fixed;inset:0;background:rgba(15,23,42,.6);backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:center;z-index:50}
    .progress-card{background:#fff;border-radius:16px;box-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);width:min(520px,92vw);padding:24px 20px}
    .progress-title{font-weight:800;font-size:18px;color:var(--slate-800)}
    .progress-track{height:8px;background:var(--slate-200);border-radius:9999px;overflow:hidden;margin-top:12px}
    .progress-bar{height:8px;width:0%;background:linear-gradient(90deg,var(--blue-600),var(--blue-grad));transition:width .6s ease}
    .progress-steps{list-style:none;padding:0;margin:16px 0 0;font-size:14px;color:var(--slate-600); space-y-2}
    .progress-steps li{display:flex;align-items:center;gap:10px;opacity:.7; transition: all .3s ease;}
    .progress-steps li.active{opacity:1;font-weight:700; color: var(--slate-800);}
    .progress-note{margin-top:12px;font-size:12px;color:var(--slate-500)}

    /* --- COMPACT TREE STYLES --- */
    .tree-wrapper { 
        display: flex; flex-direction: column; align-items: center; 
        /* EXPANDED WIDTH TO FIT CONTENT */
        width: 120%; 
        margin-left: -10%; 
        max-width: 1400px;
        overflow-x: hidden; 
        padding-bottom: 20px;
    }

    .desktop-tree {
        transform: scale(0.95); /* Slight shrink to ensure edge-to-edge fit */
        transform-origin: top center;
        width: 100%;
    }

    .tree-row { display: flex; justify-content: center; width: 100%; position: relative; gap: 8px; /* TIGHT GAP */ }

    .tree-col {
        display: flex; flex-direction: column; align-items: center;
        position: relative; padding: 20px 2px 0; /* REDUCED PADDING */
        flex: 1; 
    }

    /* THE LINES */
    .tree-col::before {
        content: ''; position: absolute; top: 0; left: 50%;
        border-left: 2px solid #94a3b8; width: 0; height: 20px; 
    }
    .tree-col::after {
        content: ''; position: absolute; top: 0;
        border-top: 2px solid #94a3b8; height: 20px; width: 50%; 
    }
    .tree-col:first-child::after { left: 50%; border-left: 0; }
    .tree-col:last-child::after { right: 50%; border-right: 0; }
    .tree-col.only-child::after, .tree-col.only-child::before { display: none; }
    .tree-col.only-child { padding-top: 0; }

    .connector-down { width: 2px; height: 20px; background: #94a3b8; margin: 0 auto; }

    /* COMPACT NODES */
    .node-box {
        background: #1e293b; 
        color: #fff;
        border-radius: 6px;
        padding: 8px 10px; /* REDUCED */
        text-align: center; 
        position: relative; z-index: 10;
        box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); 
        min-width: 110px; /* REDUCED */
        font-size: 13px; /* REDUCED */
        font-weight: 800; 
        text-transform: uppercase;
        letter-spacing: 0.02em;
    }
    .node-box.branch { background: #2A5D9F; }
    
    .node-pill {
        color: #fff;
        font-weight: 700; 
        font-size: 11px; /* REDUCED */
        min-width: 90px; /* REDUCED */
        padding: 5px 8px; /* REDUCED */
        border-radius: 99px; 
        z-index: 10; 
        white-space: nowrap;
        text-transform: uppercase;
        text-align: center;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .node-pill.blue { background: #2A5D9F; }
    .node-pill.green { background: var(--theme-green); }
    .node-pill.red { background: var(--red-equifax); }

    .node-card {
        background: #fff; 
        border: 1px solid #e2e8f0; 
        border-radius: 6px;
        text-align: left; 
        min-width: 145px; /* SIGNIFICANTLY REDUCED */
        max-width: 180px; 
        padding: 8px; /* REDUCED */
        box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
        z-index: 10;
        position: relative;
        white-space: nowrap; 
    }
    .node-card.accent-blue { border-top: 4px solid #2A5D9F; }
    .node-card.accent-red { border-top: 4px solid var(--red-equifax); }
    .node-card.accent-green { border-top: 4px solid var(--theme-green); }
    
    .node-card h5 { 
        font-weight: 800; 
        font-size: 12px; /* REDUCED */
        color: #0f172a; 
        margin-bottom: 2px; 
        line-height: 1.1; 
    }
    .node-card .sub { 
        font-size: 9px; /* REDUCED */
        font-weight: 700; 
        text-transform: uppercase; 
        color: #64748b; 
        margin-bottom: 6px; 
        display: block; 
    }
    
    .t-list { list-style: none; padding: 0; margin: 0; }
    .t-item { display: flex; align-items: center; gap: 4px; font-size: 10px; color: #334155; margin-bottom: 3px; line-height: 1.1; font-weight: 600; }
    .t-icon { color: var(--theme-green); width: 10px; height: 10px; flex-shrink: 0; }

    .node-connector-text { 
        font-size: 9px; 
        font-weight: 800; 
        color: #fff; 
        background: #0f172a; 
        padding: 2px 8px; 
        border-radius: 99px; 
        z-index: 15; 
        position: relative; 
        margin: 6px 0; 
    }

    /* Mobile Stack */
    @media (max-width: 1024px) {
        .tree-row { flex-direction: column; gap: 10px; position: static; }
        .tree-col, .tree-col::before, .tree-col::after, .connector-down { display: none; }
        .tree-wrapper { align-items: stretch; gap: 12px; width: 100%; margin: 0; overflow: visible; }
        
        .mobile-stack-item {
            display: flex; flex-direction: column; gap: 12px; 
            border-left: 3px solid #e2e8f0; padding-left: 20px; margin-left: 10px;
        }
        .node-box, .node-pill, .node-card { width: 100%; max-width: 100%; text-align: left; align-items: flex-start; white-space: normal; }
        .desktop-tree { display: none; }
        .mobile-tree { display: flex; flex-direction: column; gap: 24px;}
    }
    @media (min-width: 1025px) { .mobile-tree { display: none; } }

    /* LAYOUT ENGINE FOR FORM */
    #lead-form-card { min-height: 382px; position: relative; }
    .form-shell { position: relative; overflow: hidden; height: 380px; background: #fff; transition: height 0.3s ease; z-index: 1; }
    .form-clipper { position: relative; width: 100%; height: 100%; display: flex; flex-direction: column; background: #fff; border-radius: 12px; overflow: hidden; }
    .form-header { position: absolute; top: 0; left: 0; right: 0; z-index: 10; background: rgba(255,255,255,0.98); padding: 10px 20px; border-bottom: 1px solid var(--slate-200); height: 50px; }
    .step-viewport { position: absolute; top: 50px; bottom: 70px; left: 0; right: 0; overflow-y: auto; overflow-x: hidden; display: flex; flex-direction: column; }
    .step-viewport-inner, #the-form, .form-step { height: 100%; width: 100%; }
    .step-inner { width: 100%; max-width: var(--section-max); margin: 0 auto; height: 100%; display: flex; flex-direction: column; padding: 0 20px; }
    .step-title { text-align: center; margin-top: 12px; flex-shrink: 0; padding-bottom: 4px; }
    .step-body { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; padding-bottom: 5px; }
    .step-body > .content { width: 95%; max-width: 500px; margin: 0 auto; text-align: center; }
    .form-footer { position: absolute; bottom: 0; left: 0; right: 0; background: rgba(255,255,255,0.98); border-top: 1px solid var(--slate-200); padding: 0 20px; height: 70px; z-index: 20; display: flex; align-items: center; justify-content: space-between; }
    .form-backdrop { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.4); backdrop-filter: blur(6px); opacity: 0; pointer-events: none; transition: opacity 0.3s ease; z-index: 9990; }
    .form-backdrop.active { opacity: 1; pointer-events: auto; }
    .form-focused { position: fixed !important; top: 50% !important; left: 50% !important; width: 95vw !important; max-width: 800px !important; height: 600px !important; max-height: 90vh !important; z-index: 9999 !important; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); border-radius: 12px; margin: 0 !important; overflow: visible !important; animation: modalPop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }
    .form-focused.form-closing { animation: modalPopReverse 0.3s ease-in forwards !important; }
    .form-close-btn { position: absolute; top: -12px; right: -12px; width: 26px; height: 26px; background: #e2e8f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; color: #64748b; transition: all 0.2s; z-index: 10000; border: 2px solid #fff; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
    .form-close-btn:hover { background: #cbd5e1; color: #1e293b; transform: scale(1.1); }
    .form-trigger-overlay { position: absolute; inset: 0; z-index: 30; cursor: pointer; }
    .js-hidden { display:none !important; }

  </style>
</head>
<body>

  <div id="main-content" class="transition-all duration-300">
    <header class="w-full max-w-5xl mx-auto mt-4 px-4 relative z-50">
      <nav class="bg-white/90 backdrop-blur-lg card card-accent px-6 py-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-4 flex-shrink-0">
            <div class="brand-left">
              <img src="Logo.png" alt="Vancouver Island Credit logo" class="site-logo"/>
              <div class="brand-stack">
                <a href="#" class="brand-title" aria-label="Home">Vancouver Island Credit</a>
                <div class="powered-by-inline"><span>Powered by</span><img src="Equifax.png" alt="Equifax"/></div>
              </div>
            </div>
          </div>
          <div class="hidden md:flex items-center gap-5 flex-shrink-0">
            <a href="tel:+12369692424" class="font-bold text-slate-800 text-[13px] hover:text-[var(--blue-600)] transition-colors">(236) 969-2424</a>
            <button type="button" id="navApplyBtn" class="cta-button text-xs shadow-md">Get Started</button>
          </div>
          <button id="menuBtn" class="md:hidden text-slate-700 p-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg>
          </button>
        </div>
        <div id="mobileMenu" class="hidden md:hidden border-t border-slate-200 mt-4 pt-4 space-y-4">
            <div class="grid grid-cols-1 gap-3 text-sm font-bold text-slate-600">
              <a href="#finance-guide" class="block py-2">Financing Guide</a>
              <a href="#personalized-search" class="block py-2">Personalized Search</a>
              <a href="tel:+12369692424" class="block py-2 text-[var(--blue-600)]">(236) 969-2424</a>
            </div>
            <button type="button" id="mobileApplyBtn" class="cta-button w-full justify-center">Get Started</button>
        </div>
      </nav>
    </header>

    <main class="w-full max-w-5xl mx-auto px-4 py-4 space-y-4">
      
      <section id="about" class="grid grid-cols-1 md:grid-cols-2 gap-x-10 gap-y-6 p-5">
          <div>
            <div class="flex items-center gap-4 mb-3">
               <img src="Untitled Project.jpg" alt="Blake Stolth" class="w-12 h-12 rounded-full border-2 border-[var(--blue-600)] object-cover"/>
               <div><h1 class="h1 text-lg">See options in 3 Steps</h1><p class="text-[11px] text-slate-500 font-medium">Personally reviewed by Blake</p></div>
            </div>
            <ol class="text-sm space-y-2.5 mt-2">
              <li class="flex items-start gap-3"><span class="flex h-5 w-5 shrink-0 items-center justify-center rounded-full bg-[var(--blue-600)] text-white font-bold text-[11px]">1</span><span class="text-left leading-tight pt-0.5"><b>Enter info</b> — 2 mins</span></li>
              <li class="flex items-start gap-3"><span class="flex h-5 w-5 shrink-0 items-center justify-center rounded-full bg-[var(--blue-600)] text-white font-bold text-[11px]">2</span><span class="text-left leading-tight pt-0.5"><b>See options</b> you qualify for</span></li>
              <li class="flex items-start gap-3"><span class="flex h-5 w-5 shrink-0 items-center justify-center rounded-full bg-[var(--blue-600)] text-white font-bold text-[11px]">3</span><span class="text-left leading-tight pt-0.5"><b>Doorstep delivery</b> anywhere in BC</span></li>
            </ol>
          </div>
          <div>
            <h2 class="h2 text-base mb-3">Why people pick us</h2>
            <ul class="text-sm space-y-2.5">
              <li class="flex items-start gap-2.5"><span class="abc-badge" style="width:18px; height:18px; font-size:10px;">A</span><span class="text-left leading-tight pt-0.5"><b>All credit welcome</b> Current rates low as 0%</span></li>
              <li class="flex items-start gap-2.5"><span class="abc-badge" style="width:18px; height:18px; font-size:10px;">B</span><span class="text-left leading-tight pt-0.5"><b>Biggest Selection</b> New & Used across BC</span></li>
              <li class="flex items-start gap-2.5"><span class="abc-badge" style="width:18px; height:18px; font-size:10px;">C</span><span class="text-left leading-tight pt-0.5"><b>Confidential</b> No data sold to dealerships</span></li>
              <li class="flex items-start gap-2.5"><span class="abc-badge" style="width:18px; height:18px; font-size:10px;">D</span><span class="text-left leading-tight pt-0.5"><b>Delivery</b> Right to your driveway</span></li>
            </ul>
          </div>
      </section>

      <section class="grid grid-cols-1 md:grid-cols-2 gap-4 items-start">
        <div class="card card-accent p-0 overflow-hidden relative" id="lead-form-card" style="height: 452px;"> 
          <div id="form-spacer" class="js-hidden h-[380px]"></div>
          <div class="form-shell" id="form-shell" style="height: 100%;">
            <div class="form-clipper">
                <div id="form-trigger" class="form-trigger-overlay"></div>
                <div class="form-header">
                  <div class="flex items-center justify-between mb-1.5"><div id="progress-label" class="text-[10px] uppercase tracking-wider font-bold text-slate-500">Step 1</div><div id="progress-endcap" class="text-[10px] font-bold text-[var(--blue-700)]">Start</div></div>
                  <div class="track mt-1.5"><div id="progress-fill" class="fill"></div></div>
                </div>
                <div id="step-viewport" class="step-viewport px-4"><div class="step-viewport-inner">
                    <form id="the-form" name="lead-form" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" action="/thank-you.html" novalidate>
                      <input type="hidden" name="form-name" value="lead-form"/><input type="hidden" name="app_type" id="app_type" value="Full Application" /><input type="hidden" name="appCode" id="appCode" value="" /><input type="hidden" name="intent" id="intent" value="finance" />
                      
                      <section class="form-step" data-id="step-intent"><div class="step-inner"><div class="step-title"><h3 class="h2">Select Goal</h3></div><div class="step-body"><div class="content grid grid-cols-2 gap-3"><button type="button" class="choice-rect" data-intent="finance">Finance</button><button type="button" class="choice-rect" data-intent="refinance">Refinance</button></div></div></div></section>
                      
                      <section class="form-step js-hidden" data-id="step-vehicle-type"><div class="step-inner"><div class="step-title"><h3 class="h2">Vehicle Type</h3></div><div class="step-body"><div class="content grid grid-cols-2 gap-3"><button type="button" class="choice-rect" data-type="Car">Car</button><button type="button" class="choice-rect" data-type="SUV">SUV</button><button type="button" class="choice-rect" data-type="Truck">Truck</button><button type="button" class="choice-rect" data-type="Van">Van</button><input type="hidden" name="vehicleType" id="vehicleType"></div></div></div></section>
                      
                      <section class="form-step js-hidden" data-id="step-refi-details"><div class="step-inner"><div class="step-title"><h3 class="h2">Current Vehicle</h3></div><div class="step-body"><div class="content space-y-3">
                        <div class="grid grid-cols-2 gap-3">
                            <select id="refiMake" class="form-select" required></select>
                            <select id="refiModel" class="form-select" required disabled><option>Model</option></select>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <input type="number" name="refiYear" id="refiYear" class="form-input" placeholder="Year" required>
                            <input type="tel" name="refiMileage" id="refiMileage" class="form-input" placeholder="Kilometers" required>
                        </div>
                        <input type="tel" name="refLoanInput" id="refLoanInput" class="form-input" placeholder="Est. Loan Balance ($)" required>
                      </div></div></div></section>

                      <section class="form-step js-hidden" data-id="step-budget"><div class="step-inner"><div class="step-title"><h3 class="h2">Desired Payment</h3></div><div class="step-body"><div class="content">
                        <div class="mb-6 text-center"><span class="text-3xl font-bold text-slate-800">$<span id="biWeeklyOut">250</span></span><span class="text-sm text-slate-500 font-medium ml-1">/ bi-weekly</span></div>
                        <input type="range" min="100" max="1000" step="10" value="250" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer" id="biWeeklyRange">
                        <div class="flex justify-between text-[10px] text-slate-400 font-bold mt-2"><span>$100</span><span>$1000+</span></div>
                        <input type="hidden" name="budget" id="budgetRange" value="$250 bi-weekly">
                      </div></div></div></section>

                      <section class="form-step js-hidden" data-id="step-purchase"><div class="step-inner"><div class="step-title"><h3 class="h2">Trading a vehicle?</h3></div><div class="step-body"><div class="content grid grid-cols-2 gap-3">
                        <button type="button" class="choice-rect" data-trade="Yes">Yes</button>
                        <button type="button" class="choice-rect" data-trade="No">No</button>
                        <input type="hidden" name="hasTradeIn" id="hasTradeIn" value="No">
                      </div></div></div></section>

                      <section class="form-step js-hidden" data-id="step-tradein"><div class="step-inner"><div class="step-title"><h3 class="h2">Trade Details</h3></div><div class="step-body"><div class="content space-y-3">
                        <div class="grid grid-cols-2 gap-3">
                             <select id="tradeInMake" name="tradeInMake" class="form-select"><option>Make</option></select>
                             <select id="tradeInModel" name="tradeInModel" class="form-select" disabled><option>Model</option></select>
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <input type="number" name="tradeInYear" class="form-input" placeholder="Year">
                            <input type="tel" name="tradeInMileage" class="form-input" placeholder="Kilometers">
                        </div>
                      </div></div></div></section>

                      <section class="form-step js-hidden" data-id="step-income"><div class="step-inner"><div class="step-title"><h3 class="h2">Employment</h3></div><div class="step-body"><div class="content space-y-3">
                        <select name="employmentStatus" id="employmentStatus" class="form-select" required>
                            <option value="" disabled selected>Employment Status</option>
                            <option value="Employed">Employed</option>
                            <option value="Self-Employed">Self-Employed</option>
                            <option value="Pension">Pension / Retired</option>
                            <option value="Disability">Disability</option>
                            <option value="Other">Other</option>
                        </select>
                        <input type="tel" name="avgMonthlyIncome" id="avgMonthlyIncome" class="form-input" placeholder="Monthly Income (Before Tax)" required>
                        <input type="tel" name="otherIncomeAmount" id="otherIncomeAmount" class="form-input" placeholder="Other Income (Optional)">
                      </div></div></div></section>

                      <section class="form-step js-hidden" data-id="step-yourinfo"><div class="step-inner"><div class="step-title"><h3 class="h2">About You</h3></div><div class="step-body"><div class="content space-y-3">
                        <div class="grid grid-cols-2 gap-3">
                            <input type="text" name="firstName" id="firstName" class="form-input" placeholder="First Name" required autocomplete="given-name">
                            <input type="text" name="lastName" id="lastName" class="form-input" placeholder="Last Name" required autocomplete="family-name">
                        </div>
                        <input type="email" name="email" id="email" class="form-input" placeholder="Email Address" required autocomplete="email">
                        <div class="grid grid-cols-2 gap-3">
                            <input type="tel" name="phone" id="phone" class="form-input" placeholder="Cell Phone" required autocomplete="tel">
                            <input type="text" name="dob" id="dob" class="form-input" placeholder="DOB (MM/DD/YYYY)" required>
                        </div>
                      </div></div></div></section>

                      <section class="form-step js-hidden" data-id="step-address"><div class="step-inner"><div class="step-title"><h3 class="h2">Current Address</h3></div><div class="step-body"><div class="content space-y-3">
                        <input type="text" name="streetAddress" id="streetAddress" class="form-input" placeholder="Street Address" required autocomplete="address-line1">
                        <div class="grid grid-cols-2 gap-3">
                            <input type="text" name="city" id="city" class="form-input" placeholder="City" required autocomplete="address-level2">
                            <input type="text" name="postalCode" id="postalCode" class="form-input" placeholder="Postal Code" required autocomplete="postal-code">
                        </div>
                        <div class="seg">
                             <button type="button" id="btnRent" class="seg-btn" aria-pressed="true">Rent</button>
                             <button type="button" id="btnOwn" class="seg-btn" aria-pressed="false">Own</button>
                             <input type="hidden" name="housingType" id="housingType" value="Rent">
                        </div>
                        <div class="grid grid-cols-2 gap-3">
                            <input type="tel" name="housingPayment" id="housingPayment" class="form-input" placeholder="Mthly Payment" required>
                            <input type="text" name="timeAtAddress" id="timeAtAddress" class="form-input" placeholder="Duration (e.g. 2y)" required>
                        </div>
                      </div></div></div></section>

                      <section class="form-step js-hidden" data-id="step-employer"><div class="step-inner"><div class="step-title"><h3 class="h2">Work Details</h3></div><div class="step-body"><div class="content space-y-3">
                        <input type="text" name="employerName" id="employerName" class="form-input" placeholder="Employer Name" required>
                        <div class="grid grid-cols-2 gap-3">
                             <input type="text" name="jobTitle" id="jobTitle" class="form-input" placeholder="Job Title" required>
                             <input type="text" name="timeAtEmployer" id="timeAtEmployer" class="form-input" placeholder="Duration (e.g. 1y)" required>
                        </div>
                      </div></div></div></section>

                      <section class="form-step js-hidden" data-id="step-consent"><div class="step-inner"><div class="step-title"><h3 class="h2">Final Step</h3></div><div class="step-body"><div class="content text-center">
                        <p class="text-xs text-slate-500 leading-relaxed mb-4">By clicking "Submit Application", I certify that the information provided is true and consent to a credit check to verify my identity and process my request.</p>
                      </div></div></div></section>

                    </form>
                </div></div>
                <div class="form-footer flex items-center justify-between" id="form-footer"><button type="button" id="btnBack" class="font-semibold text-slate-600 hover:text-slate-900 px-4 py-2 rounded-lg hover:bg-slate-100 transition-colors">Back</button><button type="button" id="btnNext" class="cta-button">Next</button></div>
            </div> 
            <button id="form-close" class="form-close-btn hidden" aria-label="Close form"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg></button>
          </div>
        </div>
        
        <aside class="flex flex-col h-full">
            <div class="card card-accent p-0 flex-1 overflow-hidden relative flex flex-col" style="height: 452px;">
              <div class="h-[50px] px-5 border-b border-slate-100 bg-white flex justify-between items-center flex-shrink-0"><div><h4 class="text-sm font-bold text-slate-800">Refinance Calculator</h4></div><div class="abc-badge text-[10px] bg-[var(--blue-100)] text-[var(--blue-700)] px-2 w-auto">Estimate</div></div>
              <div class="flex-1 p-4 flex flex-col overflow-y-auto">
                
                <div id="calc-placeholder" class="text-center mt-10">
                    <p class="text-slate-400 text-sm">Select 'Refinance' in the form to unlock detailed calculator.</p>
                </div>

                <div id="refi-calc-ui" class="hidden flex-col h-full justify-between">
                    <div class="space-y-4">
                        <div class="bg-slate-50 p-3 rounded-lg border border-slate-200">
                            <p class="text-[10px] uppercase font-bold text-slate-500 mb-1">Current Balance</p>
                            <p class="text-xl font-bold text-slate-800" id="calc-balance">$0.00</p>
                        </div>
                        <div class="space-y-2">
                             <div class="flex justify-between text-xs text-slate-600"><span>Current Rate (Est)</span><span>12.99%</span></div>
                             <div class="w-full bg-slate-200 h-2 rounded-full"><div class="bg-slate-400 h-2 rounded-full" style="width:75%"></div></div>
                             <div class="flex justify-between text-xs font-bold text-[var(--theme-green)]"><span>New Rate (Est)</span><span>6.99%</span></div>
                             <div class="w-full bg-slate-200 h-2 rounded-full"><div class="bg-[var(--theme-green)] h-2 rounded-full" style="width:35%"></div></div>
                        </div>
                    </div>
                    <div class="bg-[var(--blue-100)] p-4 rounded-lg mt-4 border border-blue-200">
                        <p class="text-xs text-center text-blue-800 font-bold mb-1">Estimated Monthly Savings</p>
                        <p class="text-3xl text-center text-blue-700 font-extrabold" id="calc-savings">$0/mo</p>
                        <p class="text-[10px] text-center text-blue-600 mt-1">Based on credit approval</p>
                    </div>
                </div>

              </div>
            </div>
        </aside>
      </section>

      <section id="finance-guide" class="mt-12 mb-12">
        <div class="text-center mb-10">
            <h2 class="h1 text-3xl text-slate-800 mb-2">Finance Guide</h2>
            <p class="text-base text-slate-500 font-medium">Find your path below to see how we structure your approval.</p>
        </div>

        <div class="desktop-tree tree-wrapper">
            
            <div class="tree-row">
                <div class="tree-col only-child">
                    <div class="node-box root">START HERE</div>
                    <div class="connector-down"></div>
                </div>
            </div>

            <div class="tree-row">
                
                <div class="tree-col">
                    <div class="node-box branch">Buying a Car</div>
                    <div class="connector-down"></div>
                    
                    <div class="tree-row">
                        <div class="tree-col">
                            <div class="node-pill blue">Good Credit</div>
                            <div class="connector-down"></div>
                            <div class="node-card accent-blue">
                                <span class="sub">Unlimited Access</span>
                                <h5>660 - 900 Score</h5>
                                <ul class="t-list">
                                    <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Vehicles: Any year</li>
                                    <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Rate: Access to the lowest</li>
                                    <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Term: Access to the longest term</li>
                                </ul>
                            </div>
                        </div>

                        <div class="tree-col">
                            <div class="node-pill red">New / Bad Credit</div>
                            <div class="connector-down"></div>
                            <div class="node-card accent-red">
                                <span class="sub" style="color:var(--red-equifax);">Reliability Focus</span>
                                <h5>300 - 659 Score</h5>
                                <ul class="t-list">
                                    <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>2016+ Vehicles</li>
                                    <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Refinance 12mo</li>
                                </ul>
                            </div>
                            <div class="connector-down" style="height:15px;"></div>
                            <div class="node-connector-text">OR (500+ Score)</div>
                            <div class="connector-down" style="height:15px;"></div>
                            <div class="node-card accent-blue">
                                <span class="sub">Special Program</span>
                                <h5>Unlimited Access</h5>
                                <ul class="t-list">
                                    <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Vehicles: Any year</li>
                                    <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Rate: Access to the lowest</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tree-col">
                    <div class="node-box branch">Trading In</div>
                    <div class="connector-down"></div>

                    <div class="tree-row">
                        <div class="tree-col">
                            <div class="node-pill blue">Good Credit</div>
                            <div class="connector-down"></div>
                            <div class="tree-row">
                                <div class="tree-col">
                                    <div class="node-pill green">Positive Equity</div>
                                    <div class="connector-down"></div>
                                    <div class="node-card accent-blue">
                                        <span class="sub">Unlimited Access</span>
                                        <h5>660 - 900 Score</h5>
                                        <ul class="t-list">
                                            <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Vehicles: Any year</li>
                                            <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Rate: Access to the lowest</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="tree-col">
                                    <div class="node-pill red">Negative Equity</div>
                                    <div class="connector-down"></div>
                                    <div class="node-card accent-red">
                                        <span class="sub" style="color:var(--red-equifax);">Reliability Focus</span>
                                        <h5>Negative Equity Fix</h5>
                                        <ul class="t-list">
                                            <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>2016+ Vehicles</li>
                                            <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Refinance 12mo</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="connector-down" style="height:15px;"></div>
                                    <div class="node-connector-text">OR (500+ Score)</div>
                                    <div class="connector-down" style="height:15px;"></div>
                                    <div class="node-card accent-blue">
                                        <span class="sub">Special Program</span>
                                        <h5>Unlimited Access</h5>
                                        <ul class="t-list">
                                            <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Vehicles: Any year</li>
                                            <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Rate: Access to the lowest</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tree-col">
                            <div class="node-pill red">New / Bad Credit</div>
                            <div class="connector-down"></div>
                            <div class="tree-row">
                                <div class="tree-col">
                                    <div class="node-pill green">Positive Equity</div>
                                    <div class="connector-down"></div>
                                    <div class="node-card accent-blue">
                                        <span class="sub">Unlimited Access</span>
                                        <h5>660 - 900 Score</h5>
                                        <ul class="t-list">
                                            <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Vehicles: Any year</li>
                                            <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Rate: Access to the lowest</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="tree-col">
                                    <div class="node-pill red">Negative Equity</div>
                                    <div class="connector-down"></div>
                                    <div class="node-card accent-red">
                                        <span class="sub" style="color:var(--red-equifax);">Reliability Focus</span>
                                        <h5>Negative Equity Fix</h5>
                                        <ul class="t-list">
                                            <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>2016+ Vehicles</li>
                                            <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Refinance 12mo</li>
                                        </ul>
                                    </div>
                                    
                                    <div class="connector-down" style="height:15px;"></div>
                                    <div class="node-connector-text">OR (500+ Score)</div>
                                    <div class="connector-down" style="height:15px;"></div>
                                    <div class="node-card accent-blue">
                                        <span class="sub">Special Program</span>
                                        <h5>Unlimited Access</h5>
                                        <ul class="t-list">
                                            <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Vehicles: Any year</li>
                                            <li class="t-item"><svg class="t-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>Rate: Access to the lowest</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="mobile-tree">
                <div class="node-box root w-full">Tap branches to expand (Mobile View Simplified)</div>
            </div>

        </div>
      </section>

      <section id="personalized-search" class="mt-8 mb-8">
        <div class="flex flex-col md:flex-row gap-8 items-start">
            
            <div class="flex-1">
                <h2 class="h1 text-3xl text-slate-800 mb-4">Personalized Search</h2>
                <p class="text-base text-slate-600 leading-relaxed mb-6">
                    Buying a car isn’t about picking a color. It's about avoiding the lemons. With years of mechanical knowledge in the BC market, I don't just sell you a car—I help you hunt for the <i>right</i> one.
                </p>
                
                <div class="bg-white rounded-lg p-5 border border-slate-200 shadow-sm mb-8">
                    <div class="flex items-center gap-1 mb-2">
                        <svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                        <svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>
                    </div>
                    <p class="text-sm font-bold text-slate-800">Over 5,000 5-Star Google Reviews</p>
                    <p class="text-[11px] text-slate-500 mt-1">Trusted by families across Vancouver Island.</p>
                </div>

                <div class="timeline-wrapper">
                    <div class="timeline-container">
                        <div class="timeline-line"></div>
                        <div class="timeline-stage stage-purple"><div class="stage-icon">🎓</div><div class="stage-bar"></div><div class="stage-text">Age of<br>Eligibility &<br>New Credit</div></div>
                        <div class="timeline-stage stage-black"><div class="stage-icon">🍁</div><div class="stage-bar"></div><div class="stage-text">New to<br>Canada</div></div>
                        <div class="timeline-stage stage-yellow"><div class="stage-icon">🏠</div><div class="stage-bar"></div><div class="stage-text">Young<br>Adult</div></div>
                        <div class="timeline-stage stage-blue"><div class="stage-icon">💳</div><div class="stage-bar"></div><div class="stage-text">Rebuilding<br>Credit<br>(Any Age)</div></div>
                        <div class="timeline-stage stage-orange"><div class="stage-icon">👨‍👩‍👧‍👦</div><div class="stage-bar"></div><div class="stage-text">Mid-Life &<br>Major Purchases</div></div>
                        <div class="timeline-stage stage-red"><div class="stage-icon">🏖️</div><div class="stage-bar"></div><div class="stage-text">Retired</div></div>
                    </div>
                </div>

                <button type="button" class="cta-button w-full md:w-auto justify-center mt-6" onclick="document.getElementById('lead-form-card').scrollIntoView({behavior: 'smooth'});">
                    Start A Custom Search
                </button>
            </div>

            <div class="flex-1 w-full">
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    
                    <div class="bg-white p-5 rounded-lg border border-slate-200 shadow-sm hover:border-blue-300 transition-colors">
                        <div class="flex items-center gap-2 mb-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                            <h4 class="text-sm font-bold text-slate-800">Service History</h4>
                        </div>
                        <p class="text-xs text-slate-600 leading-relaxed">The #1 factor. We verify oil change intervals and shop reports to ensure long-term life.</p>
                    </div>

                    <div class="bg-white p-5 rounded-lg border border-slate-200 shadow-sm hover:border-blue-300 transition-colors">
                        <div class="flex items-center gap-2 mb-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                            <h4 class="text-sm font-bold text-slate-800">Lien Checks</h4>
                        </div>
                        <p class="text-xs text-slate-600 leading-relaxed">Crucial in BC. We guarantee clean titles with zero hidden debts or legal headaches.</p>
                    </div>

                    <div class="bg-white p-5 rounded-lg border border-slate-200 shadow-sm hover:border-blue-300 transition-colors">
                        <div class="flex items-center gap-2 mb-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>
                            <h4 class="text-sm font-bold text-slate-800">Rust & Body</h4>
                        </div>
                        <p class="text-xs text-slate-600 leading-relaxed">We check for Eastern cars (salt damage) and "Headliner" status—a true sign of neglect.</p>
                    </div>

                    <div class="bg-white p-5 rounded-lg border border-slate-200 shadow-sm hover:border-blue-300 transition-colors">
                        <div class="flex items-center gap-2 mb-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" /></svg>
                            <h4 class="text-sm font-bold text-slate-800">Model Specifics</h4>
                        </div>
                        <p class="text-xs text-slate-600 leading-relaxed">We know the "Bad Years." Avoiding specific transmissions and engines saves you thousands.</p>
                    </div>

                </div>
            </div>

        </div>
      </section>

      <section id="inventory" class="card card-accent p-5">
        <div class="flex items-center justify-between mb-3"><h3 class="h2">Browse Inventory</h3><a href="#lead-form" class="text-xs font-bold uppercase tracking-wide text-[var(--blue-600)] hover:underline js-view-inventory">View All (<span id="inv-total">1571</span>)</a></div>
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Coupe.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">Coupe <span class="text-slate-400 font-normal">(168)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Hatchback.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">Hatchback <span class="text-slate-400 font-normal">(138)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Electric.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">EV / Hybrid <span class="text-slate-400 font-normal">(421)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Sedan.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">Sedan <span class="text-slate-400 font-normal">(349)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Crossover.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">Crossover <span class="text-slate-400 font-normal">(307)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Suv.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">SUV <span class="text-slate-400 font-normal">(486)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Van.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">Van <span class="text-slate-400 font-normal">(102)</span></p></div></a>
          <a href="#lead-form" class="bodytype-card js-view-inventory"><div class="inv-overlay">Check Approval</div><div class="bodytype-img" style="background-image:url('Truck.jpg');"></div><div class="p-2"><p class="font-bold text-xs text-center">Truck <span class="text-slate-400 font-normal">(86)</span></p></div></a>
        </div>
      </section>

      <section id="map" class="card card-accent p-0 mt-6 overflow-hidden">
        <div class="p-4"><h3 class="h2">Head Office — Victoria, BC</h3><p class="text-xs text-slate-600 mt-1">Real location. Real people.</p></div>
        <iframe class="map-embed" title="Map — Vancouver Island Credit" loading="lazy" referrerpolicy="no-referrer-when-downgrade" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2647.612610356825!2d-123.3816246843408!3d48.44991197924958!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x548f73877c401593!2s525%20Gorge%20Rd%20E%2C%20Victoria%2C%20BC%20V8T%202W5!5e0!3m2!1sen!2sca!4v1677000000000!5m2!1sen!2sca"></iframe>
        <div class="px-4 py-3 text-xs text-slate-600 border-t border-slate-200">525 Gorge Rd E, Victoria, BC V8T 4T2</div>
      </section>

      <footer id="contact" class="text-center text-xs text-slate-500 pt-2 space-y-1.5">
        <div class="flex justify-center gap-4 text-xs text-slate-400 mb-2 underline"><a href="/privacy-policy.html" target="_blank">Privacy Policy</a><a href="/terms.html" target="_blank">Terms of Service</a></div>
        <p class="font-bold text-slate-600">Vancouver Island Credit</p>
        <p>525 Gorge Rd E, Victoria, BC V8T 4T2</p>
        <p><a href="tel:+1-236-969-2424" class="hover:text-[var(--blue-600)] transition-colors">Customer service: (236) 969-2424</a></p>
        <p class="pt-1">Serving Vancouver Island & British Columbia • Delivery available province-wide</p>
        <p class="mt-2 text-slate-400">© <span id="year"></span> Vancouver Island Credit • All rights reserved • <span class="block sm:inline">VSA Dealer #41114</span></p>
      </footer>
    </main>

    <div id="form-backdrop" class="form-backdrop"></div>
  </div>

  <div id="progress-overlay" class="progress-overlay hidden" aria-hidden="true"><div class="progress-card"><div class="progress-title">Working on it…</div><div class="progress-track"><div id="progress-bar" class="progress-bar"></div></div><ul id="progress-steps" class="progress-steps"><li class="active">Submitting your application…</li><li>Verifying your information…</li><li>Finding the best options…</li></ul><p class="progress-note">Secure & encrypted. We never share or sell your info.</p></div></div>
  <script>
  const vehicleData={Acura:["ILX","MDX","RDX","TLX","Integra","ZDX"],Audi:["A3","A4","A5","A6","Q3","Q5","Q7","e-tron"],BMW:["3 Series","5 Series","X1","X3","X5","i4","iX"],Chevrolet:["Equinox","Malibu","Silverado","Traverse","Tahoe"],Chrysler:["Pacifica","300"],Dodge:["Challenger","Charger","Durango","Grand Caravan"],Ford:["Escape","Explorer","F-150","Mustang","Edge","Ranger"],GMC:["Acadia","Sierra","Terrain","Yukon"],Honda:["Accord","Civic","CR-V","HR-V","Odyssey","Pilot"],Hyundai:["Elantra","Kona","Santa Fe","Sonata","Tucson","Palisade"],Jeep:["Cherokee","Grand Cherokee","Wrangler","Compass","Renegade"],Kia:["Forte","Sorento","Soul","Sportage","Telluride","K5"],Lexus:["ES","IS","NX","RX","UX"],Mazda:["Mazda3","Mazda6","CX-30","CX-5","CX-9"],MercedesBenz:["C-Class","E-Class","GLA","GLC","GLE","S-Class"],Nissan:["Altima","Kicks","Murano","Rogue","Sentra","Titan","Qashqai"],Subaru:["Crosstrek","Forester","Impreza","Outback","Ascent","WRX"],Toyota:["Camry","Corolla","RAV4","Tacoma","Sienna","Highlander","Tundra"],Volkswagen:["Golf","Jetta","Passat","Tiguan","Atlas","ID.4"],Volvo:["S60","S90","XC40","XC60","XC90"]};
  const $=(id)=>document.getElementById(id);const bySel=(s,root=document)=>root.querySelector(s);const bySelAll=(s,root=document)=>Array.from(root.querySelectorAll(s));
  function fmtMoney(x){x=isFinite(x)?x:0;return"$"+x.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}
  function parseMoneyInput(v){if(!v)return 0;return parseFloat(String(v).replace(/[^0-9.]/g,''))||0}
  function formatMoneyField(input){const num=parseMoneyInput(input.value);input.value=num>0?num.toLocaleString('en-CA',{style:'currency',currency:'CAD',maximumFractionDigits:0}):''}
  function calcPayment(P,annualRate,years){const r=(annualRate/100)/12;const n=years*12;if(!n||n<=0)return 0;if(P<=0)return 0;if(r===0)return P/n;return P*r/(1-Math.pow(1+r,-n))}
  function populateMakes(makeSelectId,modelSelectId){const makeSelect=$(makeSelectId);if(!makeSelect)return;makeSelect.innerHTML='<option value="" selected>Make</option>';const makes=Object.keys(vehicleData).sort();makes.forEach(make=>{const option=document.createElement('option');option.value=make;option.textContent=make;makeSelect.appendChild(option)});makeSelect.addEventListener('change',()=>updateModels(makeSelectId,modelSelectId))}
  function updateModels(makeSelectId,modelSelectId){const makeSelect=$(makeSelectId);const modelSelect=$(modelSelectId);if(!modelSelect)return;const selectedMake=makeSelect.value;modelSelect.innerHTML='';modelSelect.disabled=true;if(selectedMake&&vehicleData[selectedMake]){const models=vehicleData[selectedMake].sort();modelSelect.innerHTML='<option value="" selected>Select</option>';models.forEach(model=>{const option=document.createElement('option');option.value=model;option.textContent=model;modelSelect.appendChild(option)});modelSelect.disabled=false}else{modelSelect.innerHTML='<option value="" selected>Select Make First</option>'}}
  function populateRefiYearsLeft(sel){if(!sel)return;sel.innerHTML='<option value="" selected>Select</option>';for(let i=1;i<=8;i++){const option=document.createElement('option');option.value=i;option.textContent=i;sel.appendChild(option)}}
  document.addEventListener('DOMContentLoaded',function(){$('menuBtn')?.addEventListener('click',()=>$('mobileMenu')?.classList.toggle('hidden'));const stepsMap={};bySelAll('.form-step').forEach(sec=>stepsMap[sec.getAttribute('data-id')]=sec);
  function currentFlow(){const intent=$('intent')?.value||'finance';const hasTrade=($('hasTradeIn')?.value||'No').toLowerCase()==='yes';if(intent==='refinance'){return['step-intent','step-refi-details','step-income','step-yourinfo','step-address','step-employer','step-consent']}let flow=['step-intent','step-vehicle-type','step-budget','step-purchase'];if(hasTrade)flow.push('step-tradein');flow=flow.concat(['step-income','step-yourinfo','step-address','step-employer','step-consent']);return flow}
  function showOnly(id){Object.values(stepsMap).forEach(sec=>sec.classList.add('js-hidden'));stepsMap[id]?.classList.remove('js-hidden')}
  function updateProgress(curId){const flow=currentFlow();const i=Math.max(0,flow.indexOf(curId));const visible=flow.filter(x=>x!=='step-consent');const total=visible.length;const stepNumber=Math.min(i+1,total);const pct=Math.round((i)/(Math.max(1,total-1))*100);$('btnBack').disabled=(i===0);$('btnNext').textContent=(i>=total-1)?'Submit Application':'Next';bySel('#progress-label').textContent='Step '+stepNumber+' of '+total;bySel('#progress-fill').style.width=(total>1?pct:0)+'%';const endcap=bySel('#progress-endcap');if(i>0)endcap.textContent="See Options";else endcap.textContent="Start"}
  let curStepId='step-intent';function goTo(id){curStepId=id;showOnly(id);updateProgress(id)}
  function validateCurrent(stepId){const stepEl=stepsMap[stepId];if(!stepEl)return true;if(stepId==='step-intent'){const v=$('intent').value;const ok=(v==='finance'||v==='refinance');bySelAll('[data-intent]').forEach(x=>x.classList.toggle('err',!ok));return ok}if(stepId==='step-vehicle-type'){const ok=!!$('vehicleType').value;bySelAll('[data-type]').forEach(x=>x.classList.toggle('err',!ok));return ok}if(stepId==='step-budget'){return!!$('budgetRange').value}let ok=true;let firstError=null;const fields=Array.from(stepEl.querySelectorAll('[required]'));fields.forEach(el=>{if(window.getComputedStyle(el).display==='none'||!el.closest('.form-step')||el.closest('.form-step').classList.contains('js-hidden'))return;let pass=(el.type==='checkbox')?el.checked:(el.value&&el.value.trim()!=='');if(el.id==='phone')pass=el.value.replace(/\D/g,'').length>=10;if(el.type==='email'||el.id==='email'){const v=el.value.trim();pass=pass&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v)}if(!pass){el.classList.add('err');if(!firstError)firstError=el}else{el.classList.remove('err')}const lab=el.closest('div')?.querySelector('label');lab?.classList.toggle('err-label',!pass);if(!pass)ok=false});if(firstError){firstError.scrollIntoView({behavior:'smooth',block:'center'});firstError.focus({preventScroll:true})}return ok}
  function handleNavigation(delta){const flow=currentFlow();let i=flow.indexOf(curStepId);if(i<0)i=0;if(delta>0&&!validateCurrent(curStepId))return;i+=delta;const visible=flow.filter(x=>x!=='step-consent');const lastIdx=visible.length-1;if(delta>0&&i>lastIdx){setTimeout(submitForm,200)}else if(i>=0){const delay=(delta>0)?200:0;setTimeout(()=>{goTo(visible[i])},delay)}else{goTo(visible[0])}}
  $('btnNext')?.addEventListener('click',()=>handleNavigation(1));$('btnBack')?.addEventListener('click',()=>handleNavigation(-1));
  
  // INTENT LOGIC & CALCULATOR TOGGLE
  bySelAll('[data-intent]').forEach(btn=>{btn.addEventListener('click',()=>{
      bySelAll('[data-intent]').forEach(x=>x.classList.remove('selected','err'));
      btn.classList.add('selected');
      const val = btn.dataset.intent;
      $('intent').value = val;
      
      // Toggle Calc UI
      const calcUI = $('refi-calc-ui');
      const calcPlace = $('calc-placeholder');
      if(val === 'refinance'){
          calcUI?.classList.remove('hidden');
          calcUI?.classList.add('flex');
          calcPlace?.classList.add('hidden');
      } else {
          calcUI?.classList.add('hidden');
          calcUI?.classList.remove('flex');
          calcPlace?.classList.remove('hidden');
      }

      const targetStep=(val==='refinance')?currentFlow()[1]:'step-vehicle-type';
      setTimeout(()=>{goTo(targetStep)},200)
  })});

  // REAL TIME CALC LOGIC
  $('refLoanInput')?.addEventListener('input', (e)=>{
      const val = parseMoneyInput(e.target.value);
      $('calc-balance').textContent = fmtMoney(val);
      // Simple logic: Assume 12.99% current vs 6.99% new over 60mo
      const oldPmt = calcPayment(val, 12.99, 5);
      const newPmt = calcPayment(val, 6.99, 5);
      const save = Math.max(0, oldPmt - newPmt);
      $('calc-savings').textContent = fmtMoney(save) + "/mo";
  });

  bySelAll('[data-type]').forEach(btn=>{btn.addEventListener('click',()=>{bySelAll('[data-type]').forEach(x=>x.classList.remove('selected','err'));btn.classList.add('selected');$('vehicleType').value=btn.dataset.type||'';setTimeout(()=>{goTo('step-budget')},200)})});
  bySelAll('[data-trade]').forEach(btn=>{btn.addEventListener('click',()=>{bySelAll('[data-trade]').forEach(x=>x.classList.remove('selected'));btn.classList.add('selected');$('hasTradeIn').value=btn.dataset.trade||'No'})});
  const biw=$('biWeeklyRange');const out=$('biWeeklyOut');const br=$('budgetRange');if(biw&&out&&br){const updateBudget=()=>{out.textContent=biw.value;br.value='$'+biw.value+' bi-weekly'};biw.addEventListener('input',updateBudget);updateBudget()}
  function setHousing(type){$('housingType').value=type;$('btnRent')?.setAttribute('aria-pressed',String(type==='Rent'));$('btnOwn')?.setAttribute('aria-pressed',String(type==='Own'))}$('btnRent')?.addEventListener('click',()=>setHousing('Rent'));$('btnOwn')?.addEventListener('click',()=>setHousing('Own'));
  const moneyFields=['avgMonthlyIncome','otherIncomeAmount','refLoanInput'];moneyFields.forEach(id=>{const el=$(id);if(el){el.addEventListener('blur',(e)=>formatMoneyField(e.target));el.addEventListener('focus',(e)=>{e.target.value=e.target.value.replace(/[^0-9]/g,'')})}});
  $('phone')?.addEventListener('input',(e)=>{const d=e.target.value.replace(/\D/g,'').slice(0,10);if(d.length>6)e.target.value=`(${d.slice(0,3)}) ${d.slice(3,6)}-${d.slice(6)}`;else if(d.length>3)e.target.value=`(${d.slice(0,3)}) ${d.slice(3)}`;else if(d.length>0)e.target.value=`(${d}`});
  const hp=$('housingPayment');if(hp){hp.addEventListener('input',(e)=>{e.target.value=e.target.value.replace(/\D/g,'').slice(0,5)});hp.addEventListener('blur',(e)=>formatMoneyField(e.target));hp.addEventListener('focus',(e)=>{e.target.value=e.target.value.replace(/[^0-9]/g,'')})}
  function generateAppCode(){const n=Math.floor(Math.random()*1_000_000);return'ABC-'+String(n).padStart(6,'0')}async function runProgressOverlay(minMs=4200){const overlay=$('progress-overlay');const bar=$('progress-bar');const stepsEl=bySelAll('#progress-steps li');if(!overlay||!bar)return;overlay.classList.remove('hidden');const stages=[{width:35,index:0,ms:900},{width:70,index:1,ms:1200},{width:100,index:2,ms:1400}];const t0=Date.now();for(const st of stages){stepsEl.forEach((li,i)=>li.classList.toggle('active',i===st.index));requestAnimationFrame(()=>bar.style.width=st.width+'%');await new Promise(r=>setTimeout(r,st.ms))}const elapsed=Date.now()-t0;if(elapsed<minMs)await new Promise(r=>setTimeout(r,minMs-elapsed));overlay.classList.add('hidden')}function submitForm(){const flow=currentFlow().filter(id=>id!=='step-consent');for(const id of flow){if(!validateCurrent(id)){goTo(id);return}}bySel('#the-form').requestSubmit()}bySel('#the-form')?.addEventListener('submit',async(e)=>{e.preventDefault();const code=generateAppCode();try{sessionStorage.setItem('vic_app_code',code)}catch(_){}const codeInput=$('appCode');if(codeInput)codeInput.value=code;await runProgressOverlay(4200);e.target.submit()});
  bySelAll('.js-view-inventory').forEach(el=>{el.addEventListener('click',(e)=>{e.preventDefault();$('lead-form')?.scrollIntoView({behavior:'smooth',block:'start'})})});
  const formShell=$('form-shell');const formSpacer=$('form-spacer');const formBackdrop=$('form-backdrop');const formClose=$('form-close');const formTrigger=$('form-trigger');
  function expandForm(){if(formShell.classList.contains('form-focused'))return;formSpacer.classList.remove('js-hidden');formShell.classList.add('form-focused');formBackdrop.classList.add('active');formClose.classList.remove('hidden');formTrigger.classList.add('hidden');document.body.classList.add('modal-open')}
  function collapseForm(){if(!formShell.classList.contains('form-focused'))return;formShell.classList.add('form-closing');formBackdrop.classList.remove('active');formShell.addEventListener('animationend',function(){formShell.classList.remove('form-focused');formShell.classList.remove('form-closing');formSpacer.classList.add('js-hidden');document.body.classList.remove('modal-open');formClose.classList.add('hidden');formTrigger.classList.remove('hidden')},{once:true})}
  $('btnGetStarted')?.addEventListener('click',(e)=>{e.preventDefault();expandForm()});$('navApplyBtn')?.addEventListener('click',(e)=>{e.preventDefault();expandForm()});$('mobileApplyBtn')?.addEventListener('click',(e)=>{e.preventDefault();expandForm()});formTrigger?.addEventListener('click',expandForm);formClose?.addEventListener('click',collapseForm);formBackdrop?.addEventListener('click',collapseForm);
  (function init(){bySel('#year').textContent=new Date().getFullYear();$('intent').value='finance';$('housingType')&&($('housingType').value='Rent');populateMakes('refiMake','refiModel');populateMakes('tradeInMake','tradeInModel');goTo('step-intent')})();});
  </script>
</body>
</html>
