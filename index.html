<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Vancouver Island Credit | Auto Approvals Online — Work with Blake</title>

  <meta name="description" content="Fast, confidential auto approvals across Vancouver Island & BC. New & used options. Delivery to your door. Work 1 on 1 with Blake Stolth — no call centres." />
  <link rel="canonical" href="https://vancouverislandcredit.ca/"/>
  <meta property="og:title" content="Vancouver Island Credit — Auto Approvals Online"/>
  <meta property="og:description" content="Get approved online. New & used inventory across Vancouver Island & BC. Delivery to your door. Work directly with Blake."/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://vancouverislandcredit.ca/"/>
  <meta property="og:image" content="https://vancouverislandcredit.ca/0041B99D-D49A-4024-AA7A-2786A4605342.jpg"/>
  <meta name="theme-color" content="#2A5D9F"/>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --blue-600:#2A5D9F; --blue-700:#214B80; --blue-100:#EAF1FB; --blue-grad:#4C7CC0;

      /* tightened again */
      --shellH: 430px;          /* fixed height for the entire form */
      --progressH: 40px;        /* progress header height */
      --navH: 40px;             /* back/next row height */
      --contentH: calc(var(--shellH) - var(--progressH) - var(--navH));

      --fs-h1: 22px;
      --fs-h2: 18px;
      --fs-body: 14px;
      --fs-label: 12px;
      --fs-cta: 14px;

      /* tighter rhythm */
      --pad-section: 4px;
      --gap-small: 6px;
      --gap-regular: 6px;

      /* shorter inputs */
      --input-py: 5px;
      --input-px: 10px;
      --radius: 10px;
    }

    body{ font-family:'Inter',sans-serif; background:#f6f7fb; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
    .card{ background:#fff; border-radius:12px; border:1px solid #e5e7eb; box-shadow:0 8px 18px -10px rgb(0 0 0 / .15); }

    /* Headings */
    .h1{ font-size:var(--fs-h1); font-weight:800; color:#0f172a; }
    .h2{ font-size:var(--fs-h2); font-weight:800; color:#0f172a; }

    /* Inputs */
    .form-input,.form-select,.form-textarea{
      background:#f3f4f6; color:#18181b; border:1.5px solid #e5e7eb; font-size:var(--fs-body); width:100%;
      padding:var(--input-py) var(--input-px); border-radius:var(--radius); transition:all .15s ease;
    }
    .form-input::placeholder{ color:#a1a1aa; }
    .form-input:focus,.form-select:focus,.form-textarea:focus{ background:#fff; border-color:var(--blue-600); box-shadow:0 0 0 3px rgba(42,93,159,.15); outline:none; }
    .label{ font-size:var(--fs-label); color:#3f3f46; font-weight:600; }

    /* CTAs */
    .cta-button{ background:var(--blue-600); color:#fff; font-weight:800; padding:.5rem .8rem; border-radius:.6rem; font-size:var(--fs-cta); }
    .cta-button:hover{ background:var(--blue-700); }

    /* Tiles & Choices */
    .tile,.choice{ border-radius:10px; border:1.5px solid #e5e7eb; background:#fff; transition:.15s; font-weight:800; color:#111827; font-size:13px; }
    .tile{ display:flex; align-items:center; justify-content:center; text-align:center; aspect-ratio:4/3; width:100%; padding:.35rem; }
    .choice{ padding:.45rem; text-align:center; width:100%; }
    .tile:hover,.choice:hover{ border-color:var(--blue-600); background:#f5f8ff; }
    .tile.selected,.choice.selected{ border-color:var(--blue-600); background:#eef4ff; box-shadow:inset 0 0 0 2px var(--blue-600); }

    /* Progress bar */
    .track{ height:6px; background:#e5e7eb; border-radius:9999px; overflow:hidden; }
    .fill{ height:6px; background:linear-gradient(90deg,var(--blue-600),var(--blue-grad)); border-radius:9999px; width:0%; transition:width .25s ease; }

    /* Validation */
    .err{ border-color:#ef4444 !important; } .err-label{ color:#ef4444 !important; }

    /* Segmented toggle */
    .seg{ display:inline-flex; gap:4px; background:#f3f4f6; padding:3px; border-radius:8px; }
    .seg-btn{ padding:5px 8px; border-radius:6px; font-weight:600; color:#374151; background:transparent; border:2px solid transparent; font-size:12px; }
    .seg-btn[aria-pressed="true"]{ background:#e0ecff; color:#214B80; border-color:#bfdbfe; }

    /* Fixed-height form shell (SMALL) */
    .form-shell{ height:var(--shellH); overflow:hidden; position:relative; }
    .form-shell .sticky{ position:sticky; top:0; z-index:10; background:#fff; }

    /* Each step fits inside contentH */
    .step-pane{ min-height:var(--contentH); display:flex; }
    .step-inner{ width:100%; margin:auto; padding-top:var(--pad-section); padding-bottom:var(--pad-section); }
    .step-inner > .h2{ margin-top: 6px; }

    /* Tight vertical rhythm */
    .vstack > * + *{ margin-top: var(--gap-regular); }

    /* Inventory cards */
    .bodytype-card{ overflow:hidden; border-radius:10px; border:1px solid #e5e7eb; background:#fff; transition:transform .15s,box-shadow .15s,border-color .15s; }
    .bodytype-card:hover{ transform:translateY(-1px); border-color:var(--blue-600); box-shadow:0 10px 18px -12px rgba(42,93,159,.28); }
    .bodytype-img{ background:#e5e7eb center/cover no-repeat; height:92px; }
    @media (min-width:640px){ .bodytype-img{ height:110px; } }

    /* Utilities */
    .grid-sq{ display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:10px; }
    .grid-2{ display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:10px; }
    .grid-3{ display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:10px; }
    @media (max-width:460px){ .grid-3{ grid-template-columns:repeat(2,minmax(0,1fr)); } }
    @media (min-width:640px){ .grid-sq{ grid-template-columns:repeat(4,minmax(0,1fr)); } }

    .abc-badge{
      display:inline-flex; align-items:center; justify-content:center;
      width:20px; height:20px; border-radius:9999px;
      border:2px solid var(--blue-600); color:#2A5D9F; background:#fff;
      font-weight:800; font-size:11px; line-height:1; flex-shrink:0;
    }

    section, header, footer { scroll-margin-top: 70px; }
  </style>

  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"AutoDealer",
    "name":"Vancouver Island Credit",
    "telephone":"+1-236-969-2424",
    "address":{"@type":"PostalAddress","streetAddress":"525 Gorge Rd E","addressLocality":"Victoria","addressRegion":"BC","postalCode":"V8T 4T2","addressCountry":"CA"},
    "areaServed":"British Columbia, Canada",
    "image":"https://vancouverislandcredit.ca/0041B99D-D49A-4024-AA7A-2786A4605342.jpg",
    "url":"https://vancouverislandcredit.ca",
    "slogan":"Get approved online. Delivery across BC. Work directly with Blake.",
    "founder":{"@type":"Person","name":"Blake Stolth"},
    "makesOffer":[{"@type":"Offer","itemOffered":{"@type":"Service","name":"Auto Financing (New & Used)"}}]
  }
  </script>
</head>
<body>
  <!-- NAV -->
  <header class="w-full max-w-5xl mx-auto mt-4 px-4">
    <nav class="bg-white/90 backdrop-blur card px-4 sm:px-6 py-2.5 flex items-center justify-between">
      <a href="#" class="flex items-center gap-3">
        <img src="Untitled_Artwork.PNG" alt="Vancouver Island Credit" class="h-14 w-auto object-contain rounded-md" onerror="this.style.display='none'"/>
        <span class="hidden sm:inline font-extrabold tracking-tight text-zinc-900">Vancouver Island Credit</span>
      </a>
      <div class="hidden sm:flex items-center gap-6 text-sm font-semibold text-zinc-700">
        <a href="#inventory" class="hover:text-[var(--blue-600)]">Inventory</a>
        <a href="#about" class="hover:text-[var(--blue-600)]">About</a>
        <a href="#contact" class="hover:text-[var(--blue-600)]">Contact</a>
        <a href="#lead-form" class="cta-button !py-1.5">Apply Now</a>
      </div>
      <button id="menuBtn" class="sm:hidden inline-flex items-center justify-center h-9 w-9 rounded-md border border-zinc-200">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-zinc-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
      </button>
    </nav>
    <div id="mobileMenu" class="hidden sm:hidden mt-2 card px-4 py-3">
      <div class="flex flex-col gap-2 text-sm font-semibold text-zinc-700">
        <a href="#inventory" class="py-2 px-2 rounded hover:bg-[var(--blue-100)]">Inventory</a>
        <a href="#about" class="py-2 px-2 rounded hover:bg-[var(--blue-100)]">About</a>
        <a href="#contact" class="py-2 px-2 rounded hover:bg-[var(--blue-100)]">Contact</a>
        <a href="#lead-form" class="mt-1 cta-button text-center">Apply Now</a>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="w-full max-w-5xl mx-auto px-4 py-6 space-y-6">
    <!-- HERO / ABOUT -->
    <section id="about" class="card p-5">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="vstack">
          <h1 class="h1">Get driving in 3 easy steps</h1>
          <ol class="text-[13px] text-zinc-700 space-y-2">
            <li class="flex items-start gap-2">
              <span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-[var(--blue-600)] text-white font-extrabold text-[12px]">1</span>
              <span><b>Enter your info</b> — 2–3 minutes, no pressure.</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-[var(--blue-600)] text-white font-extrabold text-[12px]">2</span>
              <span><b>See options you qualify for</b> across BC.</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-[var(--blue-600)] text-white font-extrabold text-[12px]">3</span>
              <span><b>We deliver</b> to your door — fast & stress-free.</span>
            </li>
          </ol>
        </div>
        <div class="vstack">
          <h2 class="h2">Fastest Online Approval</h2>
          <ul class="text-[13px] text-zinc-700 space-y-2">
            <li class="flex items-start gap-2">
              <span class="abc-badge">A</span>
              <span><b>One real person:</b> no call centres.</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="abc-badge">B</span>
              <span><b>All credit welcome:</b> high approval rates.</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="abc-badge">C</span>
              <span><b>Huge selection:</b> new & used across BC.</span>
            </li>
            <li class="flex items-start gap-2">
              <span class="abc-badge">D</span>
              <span><b>Delivery:</b> to your doorstep.</span>
            </li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Application Code section (unchanged) -->
    <section id="resume" class="card p-5">
      <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-3">
        <div>
          <h3 class="h2">Already have an application code?</h3>
          <p class="text-[12px] text-zinc-600 mt-1">Enter your code if application is completed.</p>
        </div>
        <form id="code-form" class="flex items-center gap-2 w-full sm:w-auto">
          <input id="appCodeInput" type="text" inputmode="text" autocomplete="one-time-code" placeholder="ABC123" class="form-input w-full sm:w-40 uppercase" maxlength="16" aria-label="Application code"/>
          <button type="submit" class="cta-button">Resume</button>
        </form>
      </div>
      <p id="code-help" class="text-[11px] text-zinc-500 mt-2">Tip: You’ll receive this code after you submit your details.</p>
      <p id="code-error" class="text-[11px] text-red-600 mt-1 hidden">Please enter a valid code (letters and numbers only).</p>
    </section>

    <!-- FORM -->
    <section class="card p-0 overflow-hidden" id="lead-form">
      <div class="form-shell" id="form-shell">
        <!-- sticky progress -->
        <div class="sticky px-4 py-2 border-b">
          <div class="flex items-center justify-between">
            <div id="progress-label" class="text-[11px] font-semibold text-zinc-700">Step 1 of 7</div>
            <div id="progress-endcap" class="text-[11px] text-[var(--blue-700)] font-semibold">Let’s get you approved</div>
          </div>
          <div class="track mt-2"><div id="progress-fill" class="fill"></div></div>
        </div>

        <!-- STEP VIEWPORT -->
        <div class="px-4 py-2" style="height:var(--contentH);">
          <form id="the-form" name="lead-form" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" action="/thank-you.html" class="h-full flex flex-col justify-center" novalidate>
            <input type="hidden" name="form-name" value="lead-form"/>
            <input type="hidden" name="app_type" id="app_type" value="Full Application" />
            <input type="hidden" name="vehicleCondition" id="vehicleCondition" />
            <input type="hidden" name="vehicleType" id="vehicleType" />
            <p class="hidden" aria-hidden="true"><label>Don’t fill this out: <input name="bot-field"/></label></p>

            <!-- 1: Vehicle Type -->
            <section class="form-step step-pane" data-step="1">
              <div class="step-inner">
                <h3 class="h2 mb-2">What type of vehicle?</h3>
                <div class="grid-sq">
                  <button type="button" class="tile" data-type="Car">Car</button>
                  <button type="button" class="tile" data-type="SUV">SUV</button>
                  <button type="button" class="tile" data-type="Van">Van</button>
                  <button type="button" class="tile" data-type="Truck">Truck</button>
                </div>
              </div>
            </section>

            <!-- 2: Condition -->
            <section class="form-step step-pane hidden" data-step="2">
              <div class="step-inner">
                <h3 class="h2 mb-2">Used or new?</h3>
                <div class="grid-2">
                  <button type="button" class="choice" data-cond="Used">Used</button>
                  <button type="button" class="choice" data-cond="New">New</button>
                </div>
              </div>
            </section>

            <!-- 3: Budget -->
            <section class="form-step step-pane hidden" data-step="3">
              <div class="step-inner">
                <h3 class="h2 mb-2">What’s your monthly budget?</h3>
              <div class="grid-sq">
                  <label class="tile cursor-pointer"><input type="radio" class="sr-only" name="budgetRange" value="$250 – $375" required><span>$250–$375</span></label>
                  <label class="tile cursor-pointer"><input type="radio" class="sr-only" name="budgetRange" value="$376 – $499" required><span>$376–$499</span></label>
                  <label class="tile cursor-pointer"><input type="radio" class="sr-only" name="budgetRange" value="$500 – $750" required><span>$500–$750</span></label>
                  <label class="tile cursor-pointer"><input type="radio" class="sr-only" name="budgetRange" value="$750+" required><span>$750+</span></label>
                </div>
              </div>
            </section>

            <!-- 4: Purchase -->
            <section class="form-step step-pane hidden" data-step="4" id="step-purchase">
              <div class="step-inner">
                <h3 class="h2 mb-2">Purchase details</h3>
                <div class="grid grid-cols-2 gap-2">
                  <div>
                    <label for="downPayment" class="label mb-1 block">Down payment?</label>
                    <select id="downPayment" name="downPayment" class="form-select">
                      <option value="">Select…</option>
                      <option>$3,000+</option>
                      <option>$1,000–$3,000</option>
                      <option>$0–$1,000</option>
                    </select>
                  </div>
                  <div>
                    <label for="hasTradeIn" class="label mb-1 block">Trade-in?</label>
                    <select id="hasTradeIn" name="hasTradeIn" class="form-select">
                      <option>No</option>
                      <option>Yes</option>
                    </select>
                  </div>
                </div>

                <!-- Trade-in details: one line -->
                <div id="tradeInDetails" class="hidden mt-2">
                  <div class="grid grid-cols-12 gap-2">
                    <input type="number" name="tradeInYear" placeholder="Year" class="form-input col-span-2" inputmode="numeric"/>
                    <input type="text"   name="tradeInMake" placeholder="Make" class="form-input col-span-3"/>
                    <input type="text"   name="tradeInModel" placeholder="Model" class="form-input col-span-3"/>
                    <input type="number" name="tradeInKms"  placeholder="KM" class="form-input col-span-2" inputmode="numeric"/>
                    <input type="text"   name="tradeInOwed" placeholder="Money Owed" class="form-input col-span-2"/>
                  </div>
                </div>
              </div>
            </section>

            <!-- 5: YOUR INFORMATION -->
            <section class="form-step step-pane hidden" data-step="5" id="step-yourinfo">
              <div class="step-inner">
                <h3 class="h2 mb-2">Your information</h3>

                <!-- Name row: Middle Name(s) wider -->
                <div class="grid grid-cols-12 gap-2">
                  <div class="col-span-3">
                    <label for="firstName" class="label mb-1 block">First name <span class="text-red-500">*</span></label>
                    <input type="text" id="firstName" name="firstName" class="form-input" autocomplete="given-name" required/>
                  </div>
                  <div class="col-span-6">
                    <label for="middleName" class="label mb-1 block">Middle Name(s) <span class="text-red-500">*</span></label>
                    <input type="text" id="middleName" name="middleName" class="form-input" autocomplete="additional-name" required/>
                  </div>
                  <div class="col-span-3">
                    <label for="lastName" class="label mb-1 block">Last name <span class="text-red-500">*</span></label>
                    <input type="text" id="lastName" name="lastName" class="form-input" autocomplete="family-name" required/>
                  </div>
                </div>

                <div class="grid grid-cols-2 gap-2 mt-2">
                  <div>
                    <label for="phone" class="label mb-1 block">Phone <span class="text-red-500">*</span></label>
                    <input type="tel" id="phone" name="phone" class="form-input" autocomplete="tel" inputmode="tel" required/>
                  </div>
                  <div>
                    <label for="email" class="label mb-1 block">Email <span class="text-red-500">*</span></label>
                    <input type="email" id="email" name="email" class="form-input" autocomplete="email" required/>
                  </div>
                </div>

                <div class="grid grid-cols-4 gap-2 mt-2">
                  <div>
                    <label class="label mb-1 block">Month <span class="text-red-500">*</span></label>
                    <select id="dobMonth" name="dobMonth" class="form-select" required><option value="">MM</option></select>
                  </div>
                  <div>
                    <label class="label mb-1 block">Day <span class="text-red-500">*</span></label>
                    <select id="dobDay" name="dobDay" class="form-select" required><option value="">DD</option></select>
                  </div>
                  <div>
                    <label class="label mb-1 block">Year <span class="text-red-500">*</span></label>
                    <input type="number" id="dobYear" name="dobYear" placeholder="YYYY" class="form-input" inputmode="numeric" required/>
                  </div>
                  <div id="marital-wrap">
                    <label for="maritalStatus" class="label mb-1 block">Marital <span class="text-red-500">*</span></label>
                    <select id="maritalStatus" name="maritalStatus" class="form-select" required>
                      <option value="">Select</option>
                      <option>Single</option><option>Married</option><option>Common-Law</option>
                      <option>Divorced</option><option>Separated</option><option>Widowed</option>
                    </select>
                  </div>
                </div>
              </div>
            </section>

            <!-- 6: Income (Full only, one-row layout for employed) -->
            <section class="form-step step-pane hidden" data-step="6" id="step-income">
              <div class="step-inner">
                <h3 class="h2 mb-2">Income</h3>

                <div id="income-full" class="space-y-2">
                  <!-- One row: primary income, employer, position, monthly (pre-tax), time with employer -->
                  <div class="grid grid-cols-12 gap-2">
                    <div class="col-span-2">
                      <label for="incomeSourceFull" class="label mb-1 block">Primary income <span class="text-red-500">*</span></label>
                      <select id="incomeSourceFull" name="incomeSourceFull" class="form-select" required>
                        <option value="">Select…</option>
                        <option value="Full-Time">Full-Time</option>
                        <option value="Part-Time">Part-Time</option>
                        <option value="Self-Employed">Self-Employed</option>
                        <option value="Disability">Disability</option>
                        <option value="Other">Other</option>
                      </select>
                    </div>

                    <!-- Employed group -->
                    <div id="emp-employer" class="col-span-3 hidden">
                      <label for="currentEmployer" class="label mb-1 block">Employer <span class="text-red-500">*</span></label>
                      <input type="text" id="currentEmployer" name="currentEmployer" class="form-input" placeholder="Company"/>
                    </div>
                    <div id="emp-title" class="col-span-2 hidden">
                      <label for="jobTitle" class="label mb-1 block">Position <span class="text-red-500">*</span></label>
                      <input type="text" id="jobTitle" name="jobTitle" class="form-input" placeholder="Role"/>
                    </div>
                    <div id="emp-monthly" class="col-span-2 hidden">
                      <label for="monthlyIncomeFull" class="label mb-1 block">Monthly (pre-tax) <span class="text-red-500">*</span></label>
                      <input type="text" id="monthlyIncomeFull" name="monthlyIncomeFull" class="form-input" placeholder="$4,000" inputmode="numeric"/>
                    </div>
                    <div id="emp-years" class="col-span-1 hidden">
                      <label class="label mb-1 block">Years <span class="text-red-500">*</span></label>
                      <select id="timeWithEmployerYears" name="timeWithEmployerYears" class="form-select"><option value="">Years</option></select>
                    </div>
                    <div id="emp-months" class="col-span-1 hidden">
                      <label class="label mb-1 block">Months <span class="text-red-500">*</span></label>
                      <select id="timeWithEmployerMonths" name="timeWithEmployerMonths" class="form-select"><option value="">Months</option></select>
                    </div>

                    <!-- Self-employed group (same row positioning) -->
                    <div id="self-biz" class="col-span-5 hidden">
                      <label for="businessName" class="label mb-1 block">Business <span class="text-red-500">*</span></label>
                      <input type="text" id="businessName" name="businessName" class="form-input" placeholder="Name"/>
                    </div>
                    <div id="self-monthly" class="col-span-2 hidden">
                      <label for="avgMonthlyIncome" class="label mb-1 block">Avg monthly (pre-tax) <span class="text-red-500">*</span></label>
                      <input type="text" id="avgMonthlyIncome" name="avgMonthlyIncome" class="form-input" placeholder="$4,000" inputmode="numeric"/>
                    </div>

                    <!-- Other income group (same row positioning) -->
                    <div id="other-monthly" class="col-span-2 hidden">
                      <label for="otherIncomeAmount" class="label mb-1 block">Monthly (pre-tax) <span class="text-red-500">*</span></label>
                      <input type="text" id="otherIncomeAmount" name="otherIncomeAmount" class="form-input" placeholder="$2,000" inputmode="numeric"/>
                    </div>
                    <div id="other-source" class="col-span-3 hidden">
                      <label for="otherIncomeSource" class="label mb-1 block">Source <span class="text-red-500">*</span></label>
                      <input id="otherIncomeSource" name="otherIncomeSource" class="form-input" placeholder="Describe"/>
                    </div>
                  </div>
                </div>
              </div>
            </section>

            <!-- 7: Address -->
            <section class="form-step step-pane hidden" data-step="7" id="step-address">
              <div class="step-inner">
                <h3 class="h2 mb-2">Where do you live?</h3>

                <!-- One line: Street, Unit, City, Province, Postal -->
                <div id="addr-full-current" class="space-y-2">
                  <div class="grid grid-cols-12 gap-2">
                    <input type="text" id="currentStreetAddress" name="currentStreetAddress" class="form-input col-span-6" placeholder="Street Address" autocomplete="street-address" required/>
                    <input type="text" id="currentUnit" name="currentUnit" class="form-input col-span-2" placeholder="Unit #"/>
                    <input type="text" id="currentCity" name="currentCity" class="form-input col-span-2" placeholder="City" autocomplete="address-level2" required/>
                    <select id="currentProvince" name="currentProvince" class="form-select col-span-1" required><option value="">Prov</option></select>
                    <input type="text" id="currentPostalCode" name="currentPostalCode" class="form-input col-span-1" placeholder="Postal" autocomplete="postal-code" required/>
                  </div>
                </div>

                <!-- One line: Monthly payment, Rent/Own, Time lived there (Years, Months) -->
                <div class="grid grid-cols-12 gap-2 mt-2" id="housing-row">
                  <div class="col-span-3">
                    <label id="housingLabel" for="housingPayment" class="label mb-1 block">Monthly Payment <span class="text-red-500">*</span></label>
                    <input type="text" id="housingPayment" name="housingPayment" class="form-input" placeholder="$1,500" inputmode="numeric" required/>
                  </div>
                  <div class="col-span-3">
                    <label class="label mb-1 block">Rent or Own? <span class="text-red-500">*</span></label>
                    <div class="seg">
                      <button type="button" class="seg-btn" id="btnRent" aria-pressed="true">Rent</button>
                      <button type="button" class="seg-btn" id="btnOwn" aria-pressed="false">Own</button>
                    </div>
                    <input type="hidden" id="housingType" name="housingType" value="Rent" />
                  </div>
                  <div class="col-span-3">
                    <label class="label mb-1 block">Years <span class="text-red-500">*</span></label>
                    <select id="timeAtAddressYears" name="timeAtAddressYears" class="form-select"><option value="">Years</option></select>
                  </div>
                  <div class="col-span-3">
                    <label class="label mb-1 block">Months <span class="text-red-500">*</span></label>
                    <select id="timeAtAddressMonths" name="timeAtAddressMonths" class="form-select"><option value="">Months</option></select>
                  </div>
                </div>
              </div>
            </section>

            <!-- OPTIONAL dynamic inserts appear AFTER income/address and only count in progress when visible -->

            <!-- CONSENT & SUBMIT -->
            <section class="form-step step-pane hidden" data-step="99" id="step-consent">
              <div class="step-inner">
                <div id="consent-checkbox">
                  <div class="flex items-start gap-2 bg-gray-100 p-3 rounded-lg">
                    <input id="creditConsent" name="creditConsent" type="checkbox" class="h-4 w-4 rounded border-gray-300 mt-0.5"/>
                    <label for="creditConsent" id="consentLabel" class="text-[11px] text-zinc-700">
                      I consent to a credit inquiry by Blake Stolth / Vancouver Island Credit to assess financing options and confirm the information provided is accurate. <span class="text-red-500 font-bold">*</span>
                    </label>
                  </div>
                </div>
                <div class="pt-2">
                  <button type="submit" id="submitBtn" class="w-full cta-button">Submit and See Options</button>
                  <p id="form-status" class="mt-2 text-[11px] text-center text-red-600" aria-live="polite"></p>
                </div>
              </div>
            </section>

            <!-- NAV -->
            <div class="flex items-center justify-between px-1" style="height:var(--navH);">
              <button type="button" id="btnBack" class="text-[12px] font-semibold text-zinc-600 hover:text-zinc-900 px-2 py-1 disabled:opacity-30">Back</button>
              <button type="button" id="btnNext" class="cta-button">Next</button>
            </div>
          </form>
        </div>
      </div>
    </section>

    <!-- INVENTORY -->
    <section id="inventory" class="card p-5">
      <div class="flex items-center justify-between mb-2">
        <h3 class="h2">Browse by Vehicle Type</h3>
        <a href="#lead-form" class="text-[12px] font-semibold text-[var(--blue-600)] hover:underline js-view-inventory">View all</a>
      </div>
      <p class="text-[12px] text-zinc-600 mb-3">Pick a category to see matching options after a quick approval.</p>

      <div class="grid grid-cols-2 sm:grid-cols-4 gap-3">
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('Coupe.jpg');"></div>
          <div class="p-2"><p class="font-semibold text-[13px]">Coupe</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('Hatchback.jpg');"></div>
          <div class="p-2"><p class="font-semibold text-[13px]">Hatchback / Wagen</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('Electric.jpg');"></div>
          <div class="p-2"><p class="font-semibold text-[13px]">Electric / Hybrid</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('Sedan.jpg');"></div>
          <div class="p-2"><p class="font-semibold text-[13px]">Sedan</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('Crossover.jpg');"></div>
          <div class="p-2"><p class="font-semibold text-[13px]">Crossover</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('Suv.jpg');"></div>
          <div class="p-2"><p class="font-semibold text-[13px]">SUV</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('Van.jpg');"></div>
          <div class="p-2"><p class="font-semibold text-[13px]">Van</p></div>
        </a>
        <a href="#lead-form" class="bodytype-card js-view-inventory">
          <div class="bodytype-img" style="background-image:url('Truck.jpg');"></div>
          <div class="p-2"><p class="font-semibold text-[13px]">Truck</p></div>
        </a>
      </div>
    </section>

    <footer id="contact" class="text-center text-[11px] text-zinc-500 pt-1 space-y-1">
      <p class="font-semibold text-zinc-600">Vancouver Island Credit</p>
      <p>525 Gorge Rd E, Victoria, BC V8T 4T2</p>
      <p><a href="tel:2369692424" class="hover:text-[var(--blue-600)] transition-colors">(236) 969-2424</a></p>
      <p class="pt-1">Serving Vancouver Island & British Columbia • Delivery available province-wide</p>
      <p class="mt-1">© <span id="year"></span> Vancouver Island Credit • All rights reserved</p>
    </footer>
  </main>

  <script>
    // Helpers
    const $ = (id) => document.getElementById(id);
    const bySel = (s, root=document) => root.querySelector(s);
    const bySelAll = (s, root=document) => Array.from(root.querySelectorAll(s));

    // Mobile menu
    $('menuBtn')?.addEventListener('click', ()=> $('mobileMenu')?.classList.toggle('hidden'));

    // Steps (only count optional steps when visible)
    const steps = () => bySelAll('.form-step').filter(el => !(el.classList.contains('optional-step') && el.classList.contains('hidden')));

    function renumberSteps(){
      const ordered = steps();
      ordered.forEach((s,i)=>{ s.dataset.step = i+1; });
      const total = ordered.length;
      const cur = window.__currentStep || 1;
      $('progress-label').textContent = 'Step ' + cur + ' of ' + total;
      const pct = Math.round((cur-1)/(total-1)*100);
      $('progress-fill').style.width = pct + '%';
    }

    function showStep(n){
      const s = steps();
      s.forEach(x=> x.classList.add('hidden'));
      const t = s[n-1];
      if (t){ t.classList.remove('hidden'); window.__currentStep = n; }

      const total = s.length;
      $('btnBack').disabled = (n === 1);
      $('btnNext').textContent = (n === total) ? 'See My Options' : 'Next';
      $('progress-label').textContent = 'Step ' + n + ' of ' + total;
      const pct = Math.round((n-1)/(total-1)*100);
      $('progress-fill').style.width = pct + '%';
      $('progress-endcap').textContent = (n === total) ? 'See options you’re actually qualified for' : 'Let’s get you approved';
    }

    function next(delta){
      const cur = window.__currentStep || 1;
      if (delta>0 && !validateStep(cur)) return;
      let t = cur + delta;
      const total = steps().length;
      if (t < 1) t = 1;
      if (t > total) { submitForm(); return; }
      showStep(t);
    }

    $('btnNext').addEventListener('click', ()=> next(1));
    $('btnBack').addEventListener('click', ()=> next(-1));

    // Selections
    bySelAll('[data-type]').forEach(b=> b.addEventListener('click', ()=>{
      $('vehicleType').value = b.dataset.type;
      bySelAll('[data-type]').forEach(x=>x.classList.remove('selected'));
      b.classList.add('selected');
      next(1);
    }));
    bySelAll('[data-cond]').forEach(b=> b.addEventListener('click', ()=>{
      $('vehicleCondition').value = b.dataset.cond;
      bySelAll('[data-cond]').forEach(x=>x.classList.remove('selected'));
      b.classList.add('selected');
      next(1);
    }));
    bySelAll('[name="budgetRange"]').forEach(r=>{
      r.addEventListener('change', ()=> next(1));
      r.parentElement.addEventListener('click', ()=>{ r.checked=true; next(1); });
    });

    // Phone format
    $('phone')?.addEventListener('input', (e)=>{
      const d=e.target.value.replace(/\D/g,'').slice(0,10);
      if(d.length>6)e.target.value=`(${d.slice(0,3)}) ${d.slice(3,6)}-${d.slice(6)}`;
      else if(d.length>3)e.target.value=`(${d.slice(0,3)}) ${d.slice(3)}`;
      else if(d.length>0)e.target.value=`(${d}`;
    });

    // Rent/Own
    function setHousing(type){
      $('housingType').value = type;
      $('btnRent').setAttribute('aria-pressed', type==='Rent');
      $('btnOwn').setAttribute('aria-pressed', type==='Own');
    }
    $('btnRent')?.addEventListener('click', ()=> setHousing('Rent'));
    $('btnOwn')?.addEventListener('click', ()=> setHousing('Own'));

    // Trade-in reveal
    $('hasTradeIn')?.addEventListener('change', (e)=>{
      bySel('#tradeInDetails').classList.toggle('hidden', e.target.value.toLowerCase()!=='yes');
    });

    // Income mode: Full only
    function setIncomeLayout(){
      const v = $('incomeSourceFull').value;
      const employed = (v === 'Full-Time' || v === 'Part-Time');
      const selfEmp  = (v === 'Self-Employed');
      const other    = (v === 'Disability' || v === 'Other');

      // Hide all groups first
      ['emp-employer','emp-title','emp-monthly','emp-years','emp-months','self-biz','self-monthly','other-monthly','other-source']
        .forEach(id => bySel('#'+id).classList.add('hidden'));

      // Clear requireds
      ['currentEmployer','jobTitle','timeWithEmployerYears','timeWithEmployerMonths','businessName','avgMonthlyIncome','otherIncomeAmount','otherIncomeSource','monthlyIncomeFull']
        .forEach(id => { const n=$(id); if(n) n.required=false; });

      if (employed){
        ['emp-employer','emp-title','emp-monthly','emp-years','emp-months'].forEach(id => bySel('#'+id).classList.remove('hidden'));
        ['currentEmployer','jobTitle','timeWithEmployerYears','timeWithEmployerMonths','monthlyIncomeFull'].forEach(id => $(id).required = true);
      } else if (selfEmp){
        ['self-biz','self-monthly'].forEach(id => bySel('#'+id).classList.remove('hidden'));
        ['businessName','avgMonthlyIncome'].forEach(id => $(id).required = true);
      } else if (other){
        ['other-monthly','other-source'].forEach(id => bySel('#'+id).classList.remove('hidden'));
        ['otherIncomeAmount','otherIncomeSource'].forEach(id => $(id).required = true);
      }

      // re-evaluate Previous Employment need
      checkPrevEmploymentNeed();
    }
    $('incomeSourceFull')?.addEventListener('change', setIncomeLayout);

    // Dynamic PREVIOUS EMPLOYMENT step (optional; only counted when visible)
    function ensurePrevEmploymentStep(need){
      const after = $('step-income');
      let existing = after.nextElementSibling && after.nextElementSibling.querySelector?.('#previousEmployer')
        ? after.nextElementSibling : null;

      if (need && !existing){
        const sec = document.createElement('section');
        sec.className = 'form-step step-pane optional-step'; // visible -> included in progress
        sec.innerHTML = `
          <div class="step-inner">
            <h3 class="h2 mb-2">Previous employment</h3>
            <div class="grid grid-cols-12 gap-2">
              <div class="col-span-5">
                <label for="previousEmployer" class="label mb-1 block">Previous employer <span class="text-red-500">*</span></label>
                <input type="text" id="previousEmployer" name="previousEmployer" class="form-input" placeholder="Company"/>
              </div>
              <div class="col-span-3">
                <label class="label mb-1 block">Years <span class="text-red-500">*</span></label>
                <select id="prevTimeWithEmployerYears" name="prevTimeWithEmployerYears" class="form-select"><option value="">Years</option></select>
              </div>
              <div class="col-span-3">
                <label class="label mb-1 block">Months <span class="text-red-500">*</span></label>
                <select id="prevTimeWithEmployerMonths" name="prevTimeWithEmployerMonths" class="form-select"><option value="">Months</option></select>
              </div>
            </div>
          </div>`;
        after.insertAdjacentElement('afterend', sec);
        populateDropdown(bySel('#prevTimeWithEmployerYears'), 0, 30, 'Years', 'Year');
        populateDropdown(bySel('#prevTimeWithEmployerMonths'), 0, 11, 'Months', 'Month');
        ['previousEmployer','prevTimeWithEmployerYears','prevTimeWithEmployerMonths'].forEach(id => $(id).required = true);
        const prevIdx = window.__currentStep || 1; renumberSteps(); showStep(prevIdx); return;
      }

      if (!need && existing){
        const prevIdx = window.__currentStep || 1;
        existing.remove();
        ['previousEmployer','prevTimeWithEmployerYears','prevTimeWithEmployerMonths'].forEach(id => { const n=$(id); if(n) n.required=false; });
        renumberSteps(); const total = steps().length; showStep(Math.min(prevIdx, total)); return;
      }

      // If it already exists, keep required flags in sync
      ['previousEmployer','prevTimeWithEmployerYears','prevTimeWithEmployerMonths'].forEach(id=>{
        const n = $(id); if(n) n.required = !!need;
      });
    }

    function checkPrevEmploymentNeed(){
      const v = $('incomeSourceFull').value;
      const employed = (v === 'Full-Time' || v === 'Part-Time');
      if (!employed) { ensurePrevEmploymentStep(false); return; }
      const y = parseInt(($('timeWithEmployerYears').value || '0'),10);
      const m = parseInt(($('timeWithEmployerMonths').value || '0'),10);
      const months = (y*12)+m;
      const need = (y!==null || m!==null) && months < 24;
      ensurePrevEmploymentStep(need);
    }
    $('timeWithEmployerYears')?.addEventListener('change', checkPrevEmploymentNeed);
    $('timeWithEmployerMonths')?.addEventListener('change', checkPrevEmploymentNeed);

    // Dynamic PREVIOUS ADDRESS step (optional; only counted when visible)
    function ensurePrevAddressStep(need){
      const after = $('step-address');
      let existing = after.nextElementSibling && after.nextElementSibling.querySelector?.('#prevStreetAddress')
        ? after.nextElementSibling : null;

      if (need && !existing){
        const sec = document.createElement('section');
        sec.className = 'form-step step-pane optional-step';
        sec.innerHTML = `
          <div class="step-inner">
            <h3 class="h2 mb-2">Previous address</h3>
            <div class="grid grid-cols-12 gap-2">
              <input type="text" id="prevStreetAddress" name="prevStreetAddress" class="form-input col-span-4" placeholder="Street Address"/>
              <input type="text" id="prevUnit" name="prevUnit" class="form-input col-span-2" placeholder="Unit #"/>
              <input type="text" id="prevCity" name="prevCity" class="form-input col-span-2" placeholder="City"/>
              <select id="prevProvince" name="prevProvince" class="form-select col-span-1"><option value="">Prov</option></select>
              <input type="text" id="prevPostalCode" name="prevPostalCode" class="form-input col-span-1" placeholder="Postal"/>
              <select id="prevTimeAtAddressYears" name="prevTimeAtAddressYears" class="form-select col-span-1"><option value="">Years</option></select>
              <select id="prevTimeAtAddressMonths" name="prevTimeAtAddressMonths" class="form-select col-span-1"><option value="">Months</option></select>
            </div>
          </div>`;
        after.insertAdjacentElement('afterend', sec);
        populateProvinces(bySel('#prevProvince'));
        populateDropdown(bySel('#prevTimeAtAddressYears'), 0, 30, 'Years', 'Year');
        populateDropdown(bySel('#prevTimeAtAddressMonths'), 0, 11, 'Months', 'Month');
        ['prevStreetAddress','prevCity','prevProvince','prevPostalCode','prevTimeAtAddressYears','prevTimeAtAddressMonths'].forEach(id => $(id).required = true);

        const prevIdx = window.__currentStep || 1; renumberSteps(); showStep(prevIdx); return;
      }

      if (!need && existing){
        const prevIdx = window.__currentStep || 1;
        existing.remove();
        ['prevStreetAddress','prevCity','prevProvince','prevPostalCode','prevTimeAtAddressYears','prevTimeAtAddressMonths'].forEach(id=>{ const n=$(id); if(n) n.required=false; });
        renumberSteps(); const total = steps().length; showStep(Math.min(prevIdx, total)); return;
      }

      ['prevStreetAddress','prevCity','prevProvince','prevPostalCode','prevTimeAtAddressYears','prevTimeAtAddressMonths'].forEach(id=>{
        const n = $(id); if(n) n.required = !!need;
      });
    }

    function onAddressDurationChange(){
      const y = parseInt(($('timeAtAddressYears').value || '0'),10);
      const m = parseInt(($('timeAtAddressMonths').value || '0'),10);
      const months = (y*12)+m;
      const need = (y!==null || m!==null) && months < 24;
      ensurePrevAddressStep(need);
    }
    $('timeAtAddressYears')?.addEventListener('change', onAddressDurationChange);
    $('timeAtAddressMonths')?.addEventListener('change', onAddressDurationChange);

    // Validation
    function visibleRequired() {
      const req = bySelAll('#the-form [required]');
      return req.filter(el => !el.closest('.hidden') && window.getComputedStyle(el).display !== 'none');
    }
    function validateStep(n){
      const stepEl = steps()[n-1];
      if(!stepEl) return true;
      let ok = true;
      const fields = visibleRequired().filter(el => stepEl.contains(el));
      fields.forEach(el => {
        let pass = (el.type==='checkbox') ? el.checked : (el.value && el.value.trim()!=='');
        if (el.id==='phone') pass = el.value.replace(/\D/g,'').length>=10;
        if (el.type==='email' || el.id==='email'){ const v=el.value.trim(); pass = pass && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v); }
        if (!pass){ ok=false; el.classList.add('err'); const lab = bySel('label[for="'+el.id+'"]'); lab?.classList.add('err-label'); }
        else { el.classList.remove('err'); const lab = bySel('label[for="'+el.id+'"]'); lab?.classList.remove('err-label'); }
      });
      return ok;
    }

    // Submit + application code (as before)
    function makeCode(len=6){
      const chars='ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
      let out=''; for(let i=0;i<len;i++){ out += chars[Math.floor(Math.random()*chars.length)]; }
      return out;
    }

    async function submitForm(){
      if (!validateAll()) { $('form-status').textContent = 'Please complete all required fields.'; return; }
      if (!$('creditConsent').checked){ $('form-status').textContent = 'Please consent to continue.'; return; }
      $('submitBtn').disabled = true; $('submitBtn').textContent = 'Submitting…';

      const code = makeCode(6);
      try { sessionStorage.setItem('vic_app_code', code); } catch(_) {}
      const thankUrl = '/thank-you.html?code=' + encodeURIComponent(code);

      const fd = new FormData(document.getElementById('the-form'));
      try {
        await fetch('/', { method:'POST', headers:{'Content-Type':'application/x-www-form-urlencoded'}, body:new URLSearchParams(fd).toString() });
        window.location.href = thankUrl;
      } catch (e) {
        document.getElementById('the-form').action = thankUrl;
        document.getElementById('the-form').submit();
      }
    }
    function validateAll(){
      let ok = true;
      for (let i=1;i<=steps().length;i++){ if(!validateStep(i)) ok=false; }
      return ok;
    }

    // Inventory “View all” -> focus form
    bySelAll('.js-view-inventory').forEach(el=>{
      el.addEventListener('click', (e)=>{
        e.preventDefault();
        document.getElementById('lead-form')?.scrollIntoView({behavior:'smooth', block:'start'});
      });
    });

    // Resume box
    const codeForm = $('code-form');
    codeForm?.addEventListener('submit', (e)=>{
      e.preventDefault();
      const raw = $('appCodeInput').value || '';
      const code = raw.toUpperCase().replace(/[^A-Z0-9]/g,'').trim();
      const err = $('code-error');
      if (!code){ err.classList.remove('hidden'); return; }
      err.classList.add('hidden');
      try { sessionStorage.setItem('vic_app_code', code); } catch(_) {}
      const url = new URL(window.location.href);
      url.searchParams.set('code', code);
      history.replaceState(null, '', url.toString());
      document.getElementById('lead-form')?.scrollIntoView({behavior:'smooth', block:'start'});
    });

    // Dropdown population helpers
    function populateMonths(sel){ if(!sel) return;
      const m=["01","02","03","04","05","06","07","08","09","10","11","12"];
      m.forEach((mm,i)=>{ const o=document.createElement('option'); o.value=i+1; o.textContent=mm; sel.appendChild(o);});
    }
    function updateDays(){
      const y=parseInt($('dobYear').value||'',10);
      const m=parseInt($('dobMonth').value||'',10);
      const sel=parseInt($('dobDay').value||'',10);
      const days=(y&&m)?new Date(y,m,0).getDate():31;
      $('dobDay').innerHTML='<option value="">DD</option>';
      for(let i=1;i<=days;i++){ const o=document.createElement('option'); o.value=i; o.textContent=String(i).padStart(2,'0'); $('dobDay').appendChild(o);}
      if(sel&&sel<=days)$('dobDay').value=sel;
    }
    function populateDropdown(sel,start,end,label,singular){ if(!sel) return; sel.innerHTML='<option value="">'+(singular||label)+'</option>'; for(let i=start;i<=end;i++){ const o=document.createElement('option'); o.value=i; o.textContent=i; sel.appendChild(o);} }
    function populateProvinces(sel){ if(!sel) return; const prov=["AB","BC","MB","NB","NL","NS","NT","NU","ON","PE","QC","SK","YT"]; sel.innerHTML='<option value="">Prov</option>'; prov.forEach(p=>{ const o=document.createElement('option'); o.value=p; o.textContent=p; sel.appendChild(o); }); }

    // Init
    (function init(){
      const y = new Date().getFullYear(); bySel('#year').textContent = y;

      // DOB
      populateMonths($('dobMonth')); updateDays();
      $('dobMonth').addEventListener('change', updateDays);
      $('dobYear').addEventListener('input', updateDays);

      // Employment & address durations
      populateDropdown($('timeWithEmployerYears'), 0, 30, 'Years', 'Year');
      populateDropdown($('timeWithEmployerMonths'), 0, 11, 'Months', 'Month');
      populateDropdown($('timeAtAddressYears'), 0, 30, 'Years', 'Year');
      populateDropdown($('timeAtAddressMonths'), 0, 11, 'Months', 'Month');

      // Province
      populateProvinces($('currentProvince'));

      // Defaults
      setHousing('Rent');
      window.__currentStep = 1;
      showStep(1);
      renumberSteps();

      // Force Full Application layout
      setIncomeLayout();
    })();
  </script>
</body>
</html>
